"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9962],{6615:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>d});var r=l(5893),i=l(1151);const t={},a="UART",s={id:"developer-guide/part2/chapter13",title:"UART",description:"Universal Asynchronous Receiver/Transmitter\uff0c\u901a\u7528\u5f02\u6b65\u6536\u53d1\u4f20\u8f93\u5668",source:"@site/docs/developer-guide/part2/chapter13.md",sourceDirName:"developer-guide/part2",slug:"/developer-guide/part2/chapter13",permalink:"/developer-guide/part2/chapter13",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/developer-guide/part2/chapter13.md",tags:[],version:"current",frontMatter:{},sidebar:"classpartoneSidebar",previous:{title:"LEDC",permalink:"/developer-guide/part2/chapter12"},next:{title:"LPUART",permalink:"/developer-guide/part2/chapter14"}},c={},d=[{value:"\u6a21\u5757\u914d\u7f6e",id:"\u6a21\u5757\u914d\u7f6e",level:2},{value:"\u6e90\u7801\u7ed3\u6784",id:"\u6e90\u7801\u7ed3\u6784",level:2},{value:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",level:2},{value:"\u8fd4\u56de\u503c\u679a\u4e3e",id:"\u8fd4\u56de\u503c\u679a\u4e3e",level:3},{value:"\u6ce2\u7279\u7387\u679a\u4e3e",id:"\u6ce2\u7279\u7387\u679a\u4e3e",level:3},{value:"UART \u5b57\u957f\u679a\u4e3e",id:"uart-\u5b57\u957f\u679a\u4e3e",level:3},{value:"UART \u505c\u6b62\u4f4d\u679a\u4e3e",id:"uart-\u505c\u6b62\u4f4d\u679a\u4e3e",level:3},{value:"UART \u5947\u5076\u679a\u4e3e",id:"uart-\u5947\u5076\u679a\u4e3e",level:3},{value:"UART \u914d\u7f6e\u7ed3\u6784\u4f53",id:"uart-\u914d\u7f6e\u7ed3\u6784\u4f53",level:3},{value:"\u83b7\u53d6UART\u9a71\u52a8\u7684\u7248\u672c\u53f7",id:"\u83b7\u53d6uart\u9a71\u52a8\u7684\u7248\u672c\u53f7",level:3},{value:"\u521d\u59cb\u5316UART\u9a71\u52a8",id:"\u521d\u59cb\u5316uart\u9a71\u52a8",level:3},{value:"\u521d\u59cb\u5316\u5f02\u6784AMP UART\u63a7\u5236\u53f0",id:"\u521d\u59cb\u5316\u5f02\u6784amp-uart\u63a7\u5236\u53f0",level:3},{value:"\u5378\u8f7dUART\u9a71\u52a8",id:"\u5378\u8f7duart\u9a71\u52a8",level:3},{value:"\u53d1\u9001\u6570\u636e",id:"\u53d1\u9001\u6570\u636e",level:3},{value:"\u53d1\u9001\u4e00\u4e2a\u5b57\u7b26",id:"\u53d1\u9001\u4e00\u4e2a\u5b57\u7b26",level:3},{value:"\u63a5\u6536\u6570\u636e",id:"\u63a5\u6536\u6570\u636e",level:3},{value:"\u975e\u963b\u585e\u63a5\u6536\u6570\u636e",id:"\u975e\u963b\u585e\u63a5\u6536\u6570\u636e",level:3},{value:"\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26",id:"\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26",level:3},{value:"\u8bbe\u7f6e UART \u5de5\u4f5c\u53c2\u6570",id:"\u8bbe\u7f6e-uart-\u5de5\u4f5c\u53c2\u6570",level:3},{value:"\u8f6e\u8be2\u63a5\u6536",id:"\u8f6e\u8be2\u63a5\u6536",level:3},{value:"\u67e5\u770b\u8f6e\u8be2\u63a5\u6536\u72b6\u6001",id:"\u67e5\u770b\u8f6e\u8be2\u63a5\u6536\u72b6\u6001",level:3},{value:"\u6267\u884c\u5524\u9192\u5904\u7406\u51fd\u6570",id:"\u6267\u884c\u5524\u9192\u5904\u7406\u51fd\u6570",level:3},{value:"\u6ce8\u518c\u5524\u9192\u5904\u7406\u51fd\u6570",id:"\u6ce8\u518c\u5524\u9192\u5904\u7406\u51fd\u6570",level:3},{value:"\u8bbe\u7f6e\u786c\u4ef6\u6d41\u63a7",id:"\u8bbe\u7f6e\u786c\u4ef6\u6d41\u63a7",level:3},{value:"\u7981\u7528\u786c\u4ef6\u6d41\u63a7",id:"\u7981\u7528\u786c\u4ef6\u6d41\u63a7",level:3},{value:"\u8bbe\u7f6e UART \u56de\u73af",id:"\u8bbe\u7f6e-uart-\u56de\u73af",level:3},{value:"\u4f7f\u80fd RX \u4e2d\u65ad",id:"\u4f7f\u80fd-rx-\u4e2d\u65ad",level:3},{value:"\u5931\u80fd RX \u4e2d\u65ad",id:"\u5931\u80fd-rx-\u4e2d\u65ad",level:3},{value:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",id:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",level:2}];function _(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"uart",children:"UART"}),"\n",(0,r.jsx)(e.p,{children:"Universal Asynchronous Receiver/Transmitter\uff0c\u901a\u7528\u5f02\u6b65\u6536\u53d1\u4f20\u8f93\u5668"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Compatible with industry-standard 16450/16550 UARTs"}),"\n",(0,r.jsx)(e.li,{children:"64-Byte Transmit and receive data FIFOs"}),"\n",(0,r.jsx)(e.li,{children:"Supports DMA controller interface"}),"\n",(0,r.jsx)(e.li,{children:"Supports Software/ Hardware Flow Control"}),"\n",(0,r.jsx)(e.li,{children:"Supports IrDA 1.0 SIR"}),"\n",(0,r.jsx)(e.li,{children:"Supports RS-485 mode"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u6a21\u5757\u914d\u7f6e",children:"\u6a21\u5757\u914d\u7f6e"}),"\n",(0,r.jsx)(e.p,{children:"\u5176menuconfig \u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-shell",children:"Kernel Setup ---\x3e\n    Drivers Setup ---\x3e\n        SoC HAL Drivers ---\x3e\n            UART devices ---\x3e\n                [*] enable uart driver\n                [*] enbale uart hal APIs Test command\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6e90\u7801\u7ed3\u6784",children:"\u6e90\u7801\u7ed3\u6784"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:".\n\u2502  hal_uart.c         # \u9a71\u52a8\u6e90\u7801\n\u2502  platform-uart.h    # \u5e73\u53f0\u9009\u62e9\u5934\u6587\u4ef6\n\u2502  uart.h             # \u9a71\u52a8\u79c1\u6709\u5934\u6587\u4ef6\n\u2514\u2500platform\n        uart-sun20iw2p1.h # \u5e73\u53f0\u7279\u5316\u5b9a\u4e49\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",children:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e"}),"\n",(0,r.jsx)(e.p,{children:"\u5934\u6587\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <hal_uart.h>\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u8fd4\u56de\u503c\u679a\u4e3e",children:"\u8fd4\u56de\u503c\u679a\u4e3e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef enum\n{\n    HAL_UART_STATUS_ERROR_PARAMETER = -4,      /**< Invalid user input parameter. */\n    HAL_UART_STATUS_ERROR_BUSY = -3,           /**< UART port is currently in use. */\n    HAL_UART_STATUS_ERROR_UNINITIALIZED = -2,  /**< UART port has not been initialized. */\n    HAL_UART_STATUS_ERROR = -1,                /**< UART driver detected a common error. */\n    HAL_UART_STATUS_OK = 0                     /**< UART function executed successfully. */\n} hal_uart_status_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6ce2\u7279\u7387\u679a\u4e3e",children:"\u6ce2\u7279\u7387\u679a\u4e3e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef enum\n{\n    UART_BAUDRATE_300 = 0,\n    UART_BAUDRATE_600,\n    UART_BAUDRATE_1200,\n    UART_BAUDRATE_2400,\n    UART_BAUDRATE_4800,\n    UART_BAUDRATE_9600,\n    UART_BAUDRATE_19200,\n    UART_BAUDRATE_38400,\n    UART_BAUDRATE_57600,\n    UART_BAUDRATE_115200,\n    UART_BAUDRATE_230400,\n    UART_BAUDRATE_576000,\n    UART_BAUDRATE_921600,\n    UART_BAUDRATE_1000000,\n    UART_BAUDRATE_1500000,\n    UART_BAUDRATE_3000000,\n    UART_BAUDRATE_4000000,\n    UART_BAUDRATE_MAX,\n} uart_baudrate_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"uart-\u5b57\u957f\u679a\u4e3e",children:"UART \u5b57\u957f\u679a\u4e3e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef enum\n{\n    UART_WORD_LENGTH_5 = 0,\n    UART_WORD_LENGTH_6,\n    UART_WORD_LENGTH_7,\n    UART_WORD_LENGTH_8,\n} uart_word_length_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"uart-\u505c\u6b62\u4f4d\u679a\u4e3e",children:"UART \u505c\u6b62\u4f4d\u679a\u4e3e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef enum\n{\n    UART_STOP_BIT_1 = 0,\n    UART_STOP_BIT_2,\n} uart_stop_bit_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"uart-\u5947\u5076\u679a\u4e3e",children:"UART \u5947\u5076\u679a\u4e3e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef enum\n{\n    UART_PARITY_NONE = 0,\n    UART_PARITY_ODD,\n    UART_PARITY_EVEN\n} uart_parity_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"uart-\u914d\u7f6e\u7ed3\u6784\u4f53",children:"UART \u914d\u7f6e\u7ed3\u6784\u4f53"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef struct\n{\n    uart_baudrate_t baudrate;\n    uart_word_length_t word_length;\n    uart_stop_bit_t stop_bit;\n    uart_parity_t parity;\n} _uart_config_t;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u83b7\u53d6uart\u9a71\u52a8\u7684\u7248\u672c\u53f7",children:"\u83b7\u53d6UART\u9a71\u52a8\u7684\u7248\u672c\u53f7"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"sunxi_hal_version_t hal_uart_get_version(int32_t dev)\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART\u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"UART \u9a71\u52a8\u7248\u672c\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u521d\u59cb\u5316uart\u9a71\u52a8",children:"\u521d\u59cb\u5316UART\u9a71\u52a8"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_init(int32_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,r.jsx)(e.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u521d\u59cb\u5316\u5f02\u6784amp-uart\u63a7\u5236\u53f0",children:"\u521d\u59cb\u5316\u5f02\u6784AMP UART\u63a7\u5236\u53f0"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_init_for_amp_cli(int32_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,r.jsx)(e.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u5378\u8f7duart\u9a71\u52a8",children:"\u5378\u8f7dUART\u9a71\u52a8"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_deinit(int32_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,r.jsx)(e.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u53d1\u9001\u6570\u636e",children:"\u53d1\u9001\u6570\u636e"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_send(int32_t dev, const uint8_t *data, uint32_t num);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"data\uff1a\u51c6\u5907\u53d1\u9001\u7684\u6570\u636ebuffer"}),"\n",(0,r.jsx)(e.li,{children:"num\uff1abuffer \u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u6210\u529f\u53d1\u9001\u7684\u5b57\u8282\u6570"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u53d1\u9001\u4e00\u4e2a\u5b57\u7b26",children:"\u53d1\u9001\u4e00\u4e2a\u5b57\u7b26"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_put_char(int32_t dev, char c);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"c\uff1a\u5f85\u53d1\u9001\u7684\u5b57\u7b26"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"1\uff1a\u6210\u529f"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u63a5\u6536\u6570\u636e",children:"\u63a5\u6536\u6570\u636e"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_receive(int32_t dev, uint8_t *data, uint32_t num);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"data\uff1a\u63a5\u6536\u6570\u636e\u7f13\u51b2\u533a"}),"\n",(0,r.jsx)(e.li,{children:"num\uff1a\u63a5\u6536\u6570\u636e\u7684\u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"size\uff1a\u63a5\u6536\u5230\u7684\u6570\u636e\u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u975e\u963b\u585e\u63a5\u6536\u6570\u636e",children:"\u975e\u963b\u585e\u63a5\u6536\u6570\u636e"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_receive_no_block(int32_t dev, uint8_t *data, uint32_t num, int32_t timeout);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"data\uff1a\u63a5\u6536\u6570\u636e\u7f13\u51b2\u533a"}),"\n",(0,r.jsx)(e.li,{children:"num\uff1a\u63a5\u6536\u6570\u636e\u7684\u5927\u5c0f"}),"\n",(0,r.jsx)(e.li,{children:"timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"size\uff1a\u63a5\u6536\u5230\u7684\u6570\u636e\u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26",children:"\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"uint8_t hal_uart_get_char(int32_t dev);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u6536\u5230\u7684\u5b57\u7b26\u503c"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u8bbe\u7f6e-uart-\u5de5\u4f5c\u53c2\u6570",children:"\u8bbe\u7f6e UART \u5de5\u4f5c\u53c2\u6570"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_control(int32_t uart_port, int cmd, void *args);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"cmd\uff1a\u4fdd\u7559"}),"\n",(0,r.jsx)(e.li,{children:"args: \u6307\u5411 _uart_config_t \u7c7b\u578b\u7684\u7ed3\u6784\u4f53"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,r.jsx)(e.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u8f6e\u8be2\u63a5\u6536",children:"\u8f6e\u8be2\u63a5\u6536"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_receive_polling(int32_t dev, uint8_t *data, uint32_t num);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"data\uff1a\u63a5\u6536\u6570\u636e\u7f13\u51b2\u533a"}),"\n",(0,r.jsx)(e.li,{children:"num\uff1a\u63a5\u6536\u6570\u636e\u7684\u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"size\uff1a\u63a5\u6536\u5230\u7684\u6570\u636e\u5927\u5c0f"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u67e5\u770b\u8f6e\u8be2\u63a5\u6536\u72b6\u6001",children:"\u67e5\u770b\u8f6e\u8be2\u63a5\u6536\u72b6\u6001"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_check_poll_state(int32_t dev_id, short key);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev_id\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"key\uff1a\u6807\u5fd7\u4f4d\uff0c\u53d6\u503c POLLIN\uff0cPOLLOUT\uff0cPOLLERR"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"UART \u5f53\u524d\u7684\u63a5\u6536\u72b6\u6001"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u6267\u884c\u5524\u9192\u5904\u7406\u51fd\u6570",children:"\u6267\u884c\u5524\u9192\u5904\u7406\u51fd\u6570"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_poll_wakeup(int32_t dev_id, short key);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"dev_id\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"key\uff1a\u6807\u5fd7\u4f4d\uff0c\u53d6\u503c POLLIN\uff0cPOLLOUT\uff0cPOLLERR"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u56de\u8c03\u51fd\u6570\u6267\u884c\u8fd4\u56de\u503c"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u6ce8\u518c\u5524\u9192\u5904\u7406\u51fd\u6570",children:"\u6ce8\u518c\u5524\u9192\u5904\u7406\u51fd\u6570"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_register_poll_wakeup(poll_wakeup_func poll_wakeup);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"poll_wakeup\uff1a\u56de\u8c03\u51fd\u6570"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u8bbe\u7f6e\u786c\u4ef6\u6d41\u63a7",children:"\u8bbe\u7f6e\u786c\u4ef6\u6d41\u63a7"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"void hal_uart_set_hardware_flowcontrol(uart_port_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u65e0"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u7981\u7528\u786c\u4ef6\u6d41\u63a7",children:"\u7981\u7528\u786c\u4ef6\u6d41\u63a7"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"void hal_uart_disable_flowcontrol(uart_port_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u65e0"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u8bbe\u7f6e-uart-\u56de\u73af",children:"\u8bbe\u7f6e UART \u56de\u73af"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"void hal_uart_set_loopback(uart_port_t uart_port, bool enable);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n",(0,r.jsx)(e.li,{children:"enable\uff1a\u662f\u5426\u5f00\u542f"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u65e0"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u4f7f\u80fd-rx-\u4e2d\u65ad",children:"\u4f7f\u80fd RX \u4e2d\u65ad"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_enable_rx(int32_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u5931\u80fd-rx-\u4e2d\u65ad",children:"\u5931\u80fd RX \u4e2d\u65ad"}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u539f\u578b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"int32_t hal_uart_disable_rx(int32_t uart_port);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"uart_port\uff1aUART \u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd4\u56de\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",children:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <string.h>\n\n#include <hal_log.h>\n#include <hal_cmd.h>\n#include <hal_timer.h>\n#include <hal_uart.h>\n\nstatic void cmd_usage(void)\n{\n    printf("Usage:\\n"\n        "\\t hal_uart <port> <baudrate>\\n");\n}\n\nint cmd_test_uart(int argc, char **argv)\n{\n    uint8_t tbuf[6] = {"hello"};\n    uint8_t rbuf[10] = {0};\n    uart_port_t port;\n    uint32_t baudrate;\n    _uart_config_t uart_config;\n    int i;\n\n    hal_log_info("Testing UART in loopback mode");\n\n    if (argc != 3) {\n        cmd_usage();\n        return -1;\n    }\n\n    port = strtol(argv[1], NULL, 0);\n    baudrate = strtol(argv[2], NULL, 0);\n\n    if(CONFIG_CLI_UART_PORT == port){\n        hal_log_info("uart0 can\'t test, please use other port!");\n        return -1;\n    }\n    memset(rbuf, 0, 10 * sizeof(uint8_t));\n\n    switch (baudrate) {\n    case 4800:\n        uart_config.baudrate = UART_BAUDRATE_4800;\n        break;\n\n    case 9600:\n        uart_config.baudrate = UART_BAUDRATE_9600;\n        break;\n\n    case 115200:\n        uart_config.baudrate = UART_BAUDRATE_115200;\n        break;\n\n    case 1500000:\n        uart_config.baudrate = UART_BAUDRATE_1500000;\n        break;\n\n    case 4000000:\n        uart_config.baudrate = UART_BAUDRATE_4000000;\n        break;\n    default:\n        hal_log_info("Using default baudrate: 115200");\n        uart_config.baudrate = UART_BAUDRATE_115200;\n        break;\n    }\n\n    uart_config.word_length = UART_WORD_LENGTH_8;\n    uart_config.stop_bit = UART_STOP_BIT_1;\n    uart_config.parity = UART_PARITY_NONE;\n\n    hal_uart_init(port);\n    hal_uart_control(port, 0, &uart_config);\n    hal_uart_disable_flowcontrol(port);\n    hal_uart_set_loopback(port, 1);\n\n    /* send */\n    hal_uart_send(port, tbuf, 5);\n\n    /* loopback receive */\n    hal_uart_receive_no_block(port, rbuf, 5, MS_TO_OSTICK(1000));\n\n    printf("Sending:");\n    for (i = 0; i < 5; i++)\n        printf("%c", tbuf[i]);\n    printf("\\n");\n\n    printf("Receiving:");\n    for (i = 0; i < 5; i++)\n        printf("%c", rbuf[i]);\n    printf("\\n");\n\n    /* verify data */\n    for (i = 0; i < 5; i++) {\n        if (tbuf[i] != rbuf[i])\n            break;\n    }\n    if (i == 5) {\n        hal_log_info("Test hal_uart_init API success!");\n        hal_log_info("Test hal_uart_control API success!");\n        hal_log_info("Test hal_uart_disable_flowcontrol API success!");\n        hal_log_info("Test hal_uart_set_loopback API success!");\n        hal_log_info("Test hal_uart_send API success!");\n        hal_log_info("Test hal_uart_receive API success!");\n        hal_log_info("Test hal_uart_deinit API success!");\n        hal_log_info("Test uart hal APIs success!");\n    } else {\n        hal_log_info("Test uart hal APIs failed!");\n    }\n\n    hal_msleep(1000);\n    hal_uart_deinit(port);\n\n    return 0;\n}\n\nFINSH_FUNCTION_EXPORT_CMD(cmd_test_uart, hal_uart, uart hal APIs tests)\n\n#define BUFFSIZE 4096\n\nstatic void cmd_stress_usage(void)\n{\n    printf("Usage:\\n"\n        "\\t hal_uart <port> <baudrate> <flowctrl> <loopback> <len>\\n");\n}\n\nint cmd_test_uart_stress(int argc, char **argv)\n{\n    uint8_t *tbuf = malloc(BUFFSIZE);\n    uint8_t *rbuf = malloc(BUFFSIZE);\n    uart_port_t port;\n    uint32_t baudrate;\n    _uart_config_t uart_config;\n    int i;\n    int flowctrl, loopback, testlen;\n\n    hal_log_info("Testing UART in loopback mode with stress");\n\n    if (argc != 6) {\n        cmd_stress_usage();\n        free(tbuf);\n        free(rbuf);\n        return -1;\n    }\n\n    port = strtol(argv[1], NULL, 0);\n    baudrate = strtol(argv[2], NULL, 0);\n    flowctrl = strtol(argv[3], NULL, 0);\n    loopback = strtol(argv[4], NULL, 0);\n    testlen = strtol(argv[5], NULL, 0);\n\n    for (i = 0; i < BUFFSIZE; i++) {\n        tbuf[i] = (\'a\' + i) & 0xff;\n    }\n    memset(rbuf, 0, BUFFSIZE * sizeof(uint8_t));\n\n    switch (baudrate) {\n    case 4800:\n        uart_config.baudrate = UART_BAUDRATE_4800;\n        break;\n\n    case 9600:\n        uart_config.baudrate = UART_BAUDRATE_9600;\n        break;\n\n    case 115200:\n        uart_config.baudrate = UART_BAUDRATE_115200;\n        break;\n\n    case 1500000:\n        uart_config.baudrate = UART_BAUDRATE_1500000;\n        break;\n\n    default:\n        hal_log_info("Using default baudrate: 115200");\n        uart_config.baudrate = UART_BAUDRATE_115200;\n        break;\n    }\n\n    uart_config.word_length = UART_WORD_LENGTH_8;\n    uart_config.stop_bit = UART_STOP_BIT_1;\n    uart_config.parity = UART_PARITY_NONE;\n\n    hal_uart_init(port);\n    hal_uart_control(port, 0, &uart_config);\n    printf("flow:%d, loopback:%d len:%d\\n", flowctrl, loopback, testlen);\n    if (flowctrl)\n        hal_uart_set_hardware_flowcontrol(port);\n    else\n        hal_uart_disable_flowcontrol(port);\n\n    if (loopback)\n        hal_uart_set_loopback(port, 1);\n    else\n        hal_uart_set_loopback(port, 0);\n\n    /* send */\n    printf("send\\n");\n    hal_uart_send(port, tbuf, testlen);\n    printf("send done\\n");\n\n    printf("recv\\n");\n    /* loopback receive */\n    hal_uart_receive(port, rbuf, testlen);\n    printf("recv done\\n");\n\n#if 0\n    printf("Sending:");\n    for (i = 0; i < testlen; i++) {\n        if (i % 16 == 0)\n            printf("\\n");\n        printf("0x%x ", tbuf[i]);\n    }\n    printf("\\n");\n\n    printf("Receiving:");\n    for (i = 0; i < testlen; i++) {\n        if (i % 16 == 0)\n            printf("\\n");\n        printf("0x%x ", rbuf[i]);\n    }\n    printf("\\n");\n#endif\n\n    /* verify data */\n    for (i = 0; i < testlen; i++) {\n        if (tbuf[i] != rbuf[i]) {\n            printf("check %d fail, 0x%x != 0x%x\\n", i, tbuf[i], rbuf[i]);\n            break;\n        }\n    }\n    if (i == testlen) {\n        hal_log_info("Test hal_uart_init API success!");\n        hal_log_info("Test hal_uart_control API success!");\n        hal_log_info("Test hal_uart_disable_flowcontrol API success!");\n        hal_log_info("Test hal_uart_set_loopback API success!");\n        hal_log_info("Test hal_uart_send API success!");\n        hal_log_info("Test hal_uart_receive API success!");\n        hal_log_info("Test hal_uart_deinit API success!");\n        hal_log_info("Test uart hal APIs success!");\n    } else {\n        hal_log_info("Test uart hal APIs failed!");\n    }\n\n    hal_msleep(1000);\n    hal_uart_deinit(port);\n    free(tbuf);\n    free(rbuf);\n\n    return 0;\n}\n\nFINSH_FUNCTION_EXPORT_CMD(cmd_test_uart_stress, hal_uart_stress, uart hal APIs tests)\n'})})]})}function u(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(_,{...n})}):_(n)}},1151:(n,e,l)=>{l.d(e,{Z:()=>s,a:()=>a});var r=l(7294);const i={},t=r.createContext(i);function a(n){const e=r.useContext(t);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);