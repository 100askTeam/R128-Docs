"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6963],{4034:(_,n,e)=>{e.r(n),e.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});var i=e(5893),t=e(1151);const l={},d="G2D",s={id:"developer-guide/part2/chapter8",title:"G2D",description:"G2D \u9a71\u52a8\u4e3b\u8981\u5b9e\u73b0\u56fe\u50cf\u65cb\u8f6c/\u6570\u636e\u683c\u5f0f/\u989c\u8272\u7a7a\u95f4\u8f6c\u6362, \u4ee5\u53ca\u56fe\u5c42\u5408\u6210\u529f\u80fd(\u5305\u62ec\u5305\u62ecalpha\u3001colorkey\u3001rotate\u3001mirror\u3001rop\u3001maskblt) \u7b49\u56fe\u5f62\u52a0\u901f\u529f\u80fd\u3002",source:"@site/docs/developer-guide/part2/chapter8.md",sourceDirName:"developer-guide/part2",slug:"/developer-guide/part2/chapter8",permalink:"/developer-guide/part2/chapter8",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/developer-guide/part2/chapter8.md",tags:[],version:"current",frontMatter:{},sidebar:"classpartoneSidebar",previous:{title:"GPIO",permalink:"/developer-guide/part2/chapter7"},next:{title:"HW Spinlock",permalink:"/developer-guide/part2/chapter9"}},r={},a=[{value:"\u6a21\u5757\u529f\u80fd",id:"\u6a21\u5757\u529f\u80fd",level:2},{value:"\u77e9\u5f62\u586b\u5145\uff08fill color rectgngle\uff09",id:"\u77e9\u5f62\u586b\u5145fill-color-rectgngle",level:3},{value:"\u65cb\u8f6c\u548c\u955c\u50cf (rotate and mirror)",id:"\u65cb\u8f6c\u548c\u955c\u50cf-rotate-and-mirror",level:3},{value:"alpha blending",id:"alpha-blending",level:3},{value:"colorkey",id:"colorkey",level:3},{value:"\u7f29\u653e (Stretchblt)",id:"\u7f29\u653e-stretchblt",level:3},{value:"\u4e8c\u5143\u5149\u6805\u64cd\u4f5c (rop2)",id:"\u4e8c\u5143\u5149\u6805\u64cd\u4f5c-rop2",level:3},{value:"\u4e09\u5143\u5149\u6805\u64cd\u4f5c (maskblt rop3)",id:"\u4e09\u5143\u5149\u6805\u64cd\u4f5c-maskblt-rop3",level:3},{value:"\u652f\u6301\u7684format",id:"\u652f\u6301\u7684format",level:2},{value:"\u6a21\u5757\u914d\u7f6e",id:"\u6a21\u5757\u914d\u7f6e",level:2},{value:"\u6e90\u7801\u7ed3\u6784",id:"\u6e90\u7801\u7ed3\u6784",level:2},{value:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",level:2},{value:"\u6570\u636e\u7ed3\u6784",id:"\u6570\u636e\u7ed3\u6784",level:3},{value:"g2d_blt_flags",id:"g2d_blt_flags",level:4},{value:"g2d_fillrect_flags",id:"g2d_fillrect_flags",level:4},{value:"g2d_blt_flags_h",id:"g2d_blt_flags_h",level:4},{value:"g2d_image_enh",id:"g2d_image_enh",level:4},{value:"g2d_fmt_enh",id:"g2d_fmt_enh",level:4},{value:"g2d_rop3_cmd_flag",id:"g2d_rop3_cmd_flag",level:4},{value:"g2d_bld_cmd_flag",id:"g2d_bld_cmd_flag",level:4},{value:"g2d_ck",id:"g2d_ck",level:4},{value:"g2d_alpha_mode_enh",id:"g2d_alpha_mode_enh",level:4},{value:"g2d_color_gmt",id:"g2d_color_gmt",level:4},{value:"g2d_blt_h",id:"g2d_blt_h",level:4},{value:"\u51fd\u6570\u63a5\u53e3",id:"\u51fd\u6570\u63a5\u53e3",level:3},{value:"\u5f00\u542f G2D",id:"\u5f00\u542f-g2d",level:4},{value:"\u5173\u95ed G2D",id:"\u5173\u95ed-g2d",level:4},{value:"G2D \u9a71\u52a8 ioctl \u63a5\u53e3",id:"g2d-\u9a71\u52a8-ioctl-\u63a5\u53e3",level:4},{value:"G2D ioctl \u64cd\u4f5c\u793a\u4f8b",id:"g2d-ioctl-\u64cd\u4f5c\u793a\u4f8b",level:2},{value:"\u5355\u5e45\u56fe\u7684\u7f29\u653e\u3001\u683c\u5f0f\u8f6c\u6362",id:"\u5355\u5e45\u56fe\u7684\u7f29\u653e\u683c\u5f0f\u8f6c\u6362",level:3},{value:"\u65cb\u8f6c\u529f\u80fd",id:"\u65cb\u8f6c\u529f\u80fd",level:4},{value:"\u7f29\u653e\u529f\u80fd",id:"\u7f29\u653e\u529f\u80fd",level:4},{value:"\u683c\u5f0f\u8f6c\u6362",id:"\u683c\u5f0f\u8f6c\u6362",level:4},{value:"\u4e24\u5e45\u56fe\u7684BLD\u64cd\u4f5c",id:"\u4e24\u5e45\u56fe\u7684bld\u64cd\u4f5c",level:3},{value:"\u63a9\u819c\u56fe\u5149\u6805\u64cd\u4f5c",id:"\u63a9\u819c\u56fe\u5149\u6805\u64cd\u4f5c",level:3},{value:"\u6279\u5904\u7406\u63a5\u53e3",id:"\u6279\u5904\u7406\u63a5\u53e3",level:3},{value:"\u521b\u5efa\u65b0\u7684\u6279\u5904\u7406\u5b9e\u4f8b",id:"\u521b\u5efa\u65b0\u7684\u6279\u5904\u7406\u5b9e\u4f8b",level:3},{value:"\u6267\u884c\u6279\u5904\u7406\u7684\u786c\u4ef6\u64cd\u4f5c",id:"\u6267\u884c\u6279\u5904\u7406\u7684\u786c\u4ef6\u64cd\u4f5c",level:3},{value:"\u9500\u6bc1\u6307\u5b9a task id \u7684\u6279\u5904\u7406\u5b9e\u4f8b",id:"\u9500\u6bc1\u6307\u5b9a-task-id-\u7684\u6279\u5904\u7406\u5b9e\u4f8b",level:3},{value:"\u83b7\u53d6\u6307\u5b9a <code>task id</code> \u7684 <code>mixer para</code>",id:"\u83b7\u53d6\u6307\u5b9a-task-id-\u7684-mixer-para",level:3}];function c(_){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),..._.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"g2d",children:"G2D"}),"\n",(0,i.jsx)(n.p,{children:"G2D \u9a71\u52a8\u4e3b\u8981\u5b9e\u73b0\u56fe\u50cf\u65cb\u8f6c/\u6570\u636e\u683c\u5f0f/\u989c\u8272\u7a7a\u95f4\u8f6c\u6362, \u4ee5\u53ca\u56fe\u5c42\u5408\u6210\u529f\u80fd(\u5305\u62ec\u5305\u62ecalpha\u3001colorkey\u3001rotate\u3001mirror\u3001rop\u3001maskblt) \u7b49\u56fe\u5f62\u52a0\u901f\u529f\u80fd\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u5757\u529f\u80fd",children:"\u6a21\u5757\u529f\u80fd"}),"\n",(0,i.jsx)(n.h3,{id:"\u77e9\u5f62\u586b\u5145fill-color-rectgngle",children:"\u77e9\u5f62\u586b\u5145\uff08fill color rectgngle\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u586b\u5145\u77e9\u5f62\u533a\u57df\u529f\u80fd\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u67d0\u5757\u533a\u57df\u8fdb\u884c\u9884\u8ba2\u7684\u989c\u8272\u503c\u586b\u5145\uff0c\u5982\u4e0b\u56fe\u5c31\u586b\u5145\u4e86 0xFF0080FF\u7684 ARGB \u503c\uff0c\u8be5\u529f\u80fd\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u5b9a\u6570\u636e\u533a\u57df\u5927\u5c0f\u5b9e\u73b0\u753b\u70b9\u548c\u76f4\u7ebf\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u5b9a flag \u5b9e\u73b0\u4e00\u79cd\u586b\u5145\u989c\u8272\u548c\u76ee\u6807\u505a alpha \u8fd0\u7b97\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image1.jpg",alt:"image1"})}),"\n",(0,i.jsx)(n.h3,{id:"\u65cb\u8f6c\u548c\u955c\u50cf-rotate-and-mirror",children:"\u65cb\u8f6c\u548c\u955c\u50cf (rotate and mirror)"}),"\n",(0,i.jsx)(n.p,{children:"\u65cb\u8f6c\u955c\u50cf\u4e3b\u8981\u662f\u5b9e\u73b0\u5982\u4e0b Horizontal\u3001Vertical\u3001Rotate180\xb0\u3001Mirror45\xb0\u3001Rotate90\xb0\u3001Mirror135\xb0\u3001Rotate270\xb0 \u5171 7 \u79cd\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image2.jpg",alt:"image8"})}),"\n",(0,i.jsx)(n.h3,{id:"alpha-blending",children:"alpha blending"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0d\u540c\u7684\u56fe\u5c42\u4e4b\u95f4\u53ef\u4ee5\u505a alpha blending\u3002Alpha \u5206\u4e3a pixel alpha\u3001plane alpha\u3001multi alpha \u4e09\u79cd\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"pixel alpha \u610f\u4e3a\u6bcf\u4e2a\u50cf\u7d20\u81ea\u5e26\u6709\u4e00\u4e2a\u4e13\u5c5e alpha \u503c\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"plane alpha \u5219\u662f\u4e00\u4e2a\u56fe\u5c42\u4e2d\u6240\u6709\u50cf\u7d20\u5171\u7528\u4e00\u4e2a globe alpha \u503c\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"multi alpha \u5219\u6bcf\u4e2a\u50cf\u7d20\u5728\u4ee3\u5165 alpha \u8fd0\u7b97\u65f6\u7684\u503c\u4e3a globe alpha*pixel alpha\uff0c\u53ef\u4ee5\u901a\u8fc7 G2D \u9a71\u52a8\u63a5\u53e3\u7684 flag \u53bb\u63a7\u5236"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image3.jpg",alt:"image3"})}),"\n",(0,i.jsx)(n.h3,{id:"colorkey",children:"colorkey"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0d\u540c image \u4e4b\u95f4\u53ef\u4ee5\u505a colorkey \u6548\u679c\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5de6\u56fe\u4e2d destination \u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e source\uff0cdestination \u4e2d match \u90e8\u5206\uff08\u6a59\u8272\u4e94\u89d2\u661f\u90e8\u5206\uff09\uff0c\u5219\u88ab\u9009\u62e9\u900f\u8fc7\uff0c\u663e\u793a\u4e3a source \u4e0e destination \u505a alpha blending \u540e\u7684\u6548\u679c\u56fe\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u53f3\u56fe\u4e2d source \u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e destination\uff0c\u5219 source \u4e2d match \u90e8\u5206\uff08\u6df1\u7ea2\u8272\u4e94\u89d2\u661f\u90e8\u5206\uff09\uff0c\u5219\u88ab\u9009\u62e9\u900f\u8fc7\uff0c\u76f4\u63a5\u663e\u793a destination \u4e0e source \u505a alpha blending \u540e\u7684\u6548\u679c\u56fe\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image4.jpg",alt:"image4"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7f29\u653e-stretchblt",children:"\u7f29\u653e (Stretchblt)"}),"\n",(0,i.jsx)(n.p,{children:"Stretchblt \u4e3b\u8981\u662f\u628a source \u6309\u7167 destination \u7684 size \u8fdb\u884c\u7f29\u653e\uff0c\u5e76\u6700\u7ec8\u4e0e destination \u505aalpha blending\u3001colorkey \u7b49\u8fd0\u7b97\u6216\u76f4\u63a5\u65cb\u8f6c\u955c\u50cf\u540e\u62f7\u8d1d\u5230\u76ee\u6807"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image5.jpg",alt:"image5"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4e8c\u5143\u5149\u6805\u64cd\u4f5c-rop2",children:"\u4e8c\u5143\u5149\u6805\u64cd\u4f5c (rop2)"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4eec\u5728\u753b\u7ebf\u548c\u586b\u5145\u533a\u57df\u7684\u65f6\u5019\u5c06\u753b\u7b14\u548c\u76ee\u6807\u50cf\u7d20\u7ec4\u5408\u5f97\u5230\u65b0\u7684\u76ee\u6807\u50cf\u7d20\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u4e09\u5143\u5149\u6805\u64cd\u4f5c-maskblt-rop3",children:"\u4e09\u5143\u5149\u6805\u64cd\u4f5c (maskblt rop3)"}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u4e8e\u56fe\u50cf\u6709\u540c\u6837\u5149\u6805\u64cd\u4f5c\u7528\u4e8e\u751f\u6210\u5404\u79cd\u7279\u6b8a\u6548\u679c, \u6211\u4eec\u8981\u5904\u7406\u7684\u6709\u4e09\u79cd\u50cf\u7d20: \u6e90\u56fe\u50cf\u50cf\u7d20, \u76ee\u6807\u56fe\u50cf\u50cf\u7d20, \u753b\u5237\u50cf\u7d20 (\u6a21\u677f\u56fe\u50cf\u50cf\u7d20)\u3002\u5982\u4e0b\u56fe\u6240\u793a, \u4ece\u5de6\u4e0a\u5230\u53f3\u4e0b\u5206\u522b\u662f src ptn mask dst\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image6.jpg",alt:"image6"})}),"\n",(0,i.jsx)(n.h2,{id:"\u652f\u6301\u7684format",children:"\u652f\u6301\u7684format"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"G2D_FORMAT_ARGB8888/G2D_FORMAT_ARGB8888/G2D_FORMAT_ABGR8888/\nG2D_FORMAT_RGBA8888/G2D_FORMAT_BGRA8888/G2D_FORMAT_XRGB8888,\nG2D_FORMAT_XBGR8888/G2D_FORMAT_RGBX8888/G2D_FORMAT_BGRX8888/\nG2D_FORMAT_RGB888/G2D_FORMAT_BGR888/G2D_FORMAT_RGB565,\nG2D_FORMAT_BGR565/G2D_FORMAT_ARGB4444/G2D_FORMAT_ABGR4444/\nG2D_FORMAT_RGBA4444/G2D_FORMAT_BGRA4444/G2D_FORMAT_ARGB1555,\nG2D_FORMAT_ABGR1555/G2D_FORMAT_RGBA5551/G2D_FORMAT_BGRA5551/\nG2D_FORMAT_ARGB2101010/G2D_FORMAT_ABGR2101010,\nG2D_FORMAT_RGBA1010102/G2D_FORMAT_BGRA1010102\nG2D_FORMAT_IYUV422_V0Y1U0Y0, G2D_FORMAT_IYUV422_Y1V0Y0U0, G2D_FORMAT_IYUV422_U0Y1V0Y0, G2D_FORMAT_IYUV422_Y1U0Y0V0, G2D_FORMAT_YUV422UVC_V1U1V0U0, G2D_FORMAT_YUV422UVC_U1V1U0V0, G2D_FORMAT_YUV422_PLANAR, G2D_FORMAT_YUV420UVC_V1U1V0U0, G2D_FORMAT_YUV420UVC_U1V1U0V0, G2D_FORMAT_YUV420_PLANAR, G2D_FORMAT_YUV411UVC_V1U1V0U0, G2D_FORMAT_YUV411UVC_U1V1U0V0, G2D_FORMAT_YUV411_PLANAR, G2D_FORMAT_Y8,\nG2D_FORMAT_YVU10_P010,\nG2D_FORMAT_YVU10_P210,\nG2D_FORMAT_YVU10_444,\nG2D_FORMAT_YUV10_444,\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u5757\u914d\u7f6e",children:"\u6a21\u5757\u914d\u7f6e"}),"\n",(0,i.jsx)(n.p,{children:"\u5176menuconfig \u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Kernel Setup ---\x3e\n    Drivers Setup ---\x3e\n        SoC HAL Drivers ---\x3e\n            G2D devices ---\x3e\n                [*] enable g2d driver\n                [*] enbale g2d hal APIs Test command\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6e90\u7801\u7ed3\u6784",children:"\u6e90\u7801\u7ed3\u6784"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:".\n\u251c\u2500\u2500 g2d_bld.c\n\u251c\u2500\u2500 g2d_bld.h\n\u251c\u2500\u2500 g2d_bsp.h\n\u251c\u2500\u2500 g2d.c\n\u251c\u2500\u2500 g2d_driver.h\n\u251c\u2500\u2500 g2d_driver_i.h\n\u251c\u2500\u2500 g2d_mixer.c\n\u251c\u2500\u2500 g2d_mixer.h\n\u251c\u2500\u2500 g2d_mixer_type.h\n\u251c\u2500\u2500 g2d_ovl_u.c\n\u251c\u2500\u2500 g2d_ovl_u.h\n\u251c\u2500\u2500 g2d_ovl_v.c\n\u251c\u2500\u2500 g2d_ovl_v.h\n\u251c\u2500\u2500 g2d_rcq.c\n\u251c\u2500\u2500 g2d_rcq.h\n\u251c\u2500\u2500 g2d_rotate.c\n\u251c\u2500\u2500 g2d_rotate.h\n\u251c\u2500\u2500 g2d_rotate_type.h\n\u251c\u2500\u2500 g2d_scal.c\n\u251c\u2500\u2500 g2d_scal.h\n\u251c\u2500\u2500 g2d_top.c\n\u251c\u2500\u2500 g2d_top.h\n\u251c\u2500\u2500 g2d_top_type.h\n\u251c\u2500\u2500 g2d_wb.c\n\u251c\u2500\u2500 g2d_wb.h\n\u251c\u2500\u2500 Kconfig\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 simple_idr.c\n\u2514\u2500\u2500 simple_idr.h\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",children:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u5934\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"#include <g2d_driver_enh.h>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u6570\u636e\u7ed3\u6784",children:"\u6570\u636e\u7ed3\u6784"}),"\n",(0,i.jsx)(n.h4,{id:"g2d_blt_flags",children:"g2d_blt_flags"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_blt_flags"})," \u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2abitblt \u548cstretchblt \u7684flag \u5c5e\u6027\u4fe1\u606f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    G2D_BLT_NONE = 0x00000000,\n    G2D_BLT_PIXEL_ALPHA = 0x00000001,\n    G2D_BLT_PLANE_ALPHA = 0x00000002,\n    G2D_BLT_MULTI_ALPHA = 0x00000004,\n    G2D_BLT_SRC_COLORKEY = 0x00000008,\n    G2D_BLT_DST_COLORKEY = 0x00000010,\n    G2D_BLT_FLIP_HORIZONTAL = 0x00000020,\n    G2D_BLT_FLIP_VERTICAL = 0x00000040,\n    G2D_BLT_ROTATE90 = 0x00000080,\n    G2D_BLT_ROTATE180 = 0x00000100,\n    G2D_BLT_ROTATE270 = 0x00000200,\n    G2D_BLT_MIRROR45 = 0x00000400,\n    G2D_BLT_MIRROR135 = 0x00000800,\n}g2d_blt_flags;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"FLAG"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_NONE"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u7eaf\u62f7\u8d1d"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_PIXEL_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u70b9alpha\u6807\u5fd7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_PLANE_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u9762alpha\u6807\u5fd7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_MULTI_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u6df7\u5408alpha\u6807\u5fd7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_SRC_COLORKEY"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u6e90colorkey\u6807\u5fd7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_DST_COLORKEY"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u76ee\u6807colorkey\u6807\u5fd7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_FLIP_HORIZONTAL"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u6c34\u5e73\u7ffb\u8f6c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_FLIP_VERTICAL"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u5782\u76f4\u7ffb\u8f6c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_ROTATE90"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u9006\u65f6\u9488\u65cb\u8f6c90\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_ROTATE180"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u9006\u65f6\u9488\u65cb\u8f6c180\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_ROTATE270"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u9006\u65f6\u9488\u65cb\u8f6c270\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_MIRROR45"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u955c\u50cf45\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_BLT_MIRROR135"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u955c\u50cf135\u5ea6"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"g2d_fillrect_flags",children:"g2d_fillrect_flags"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_fillrect_flags"})," \u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2afillrect \u5c5e\u6027\u4fe1\u606f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    G2D_FIL_NONE = 0x00000000,\n    G2D_FIL_PIXEL_ALPHA = 0x00000001,\n    G2D_FIL_PLANE_ALPHA = 0x00000002,\n    G2D_FIL_MULTI_ALPHA = 0x00000004,\n}g2d_fillrect_flags;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"FLAG"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_FIL_NONE"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u7eaf\u586b\u5145"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_FIL_PIXEL_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u586b\u5145\u533a\u57df\u548c\u76ee\u6807\u505a\u70b9alpha"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_FIL_PLANE_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u586b\u5145\u533a\u57df\u548c\u76ee\u6807\u505a\u9762alpha"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"G2D_FIL_MULTI_ALPHA"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"\u586b\u5145\u533a\u57df\u7684alpha\u503c x \u9762alpha\u503c\u540e\u518d\u548c\u76ee\u6807\u505aalpha"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"g2d_blt_flags_h",children:"g2d_blt_flags_h"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_blt_flags_h"})," \u5b9a\u4e49\u4e8c\u5143\u5149\u6805\u64cd\u4f5c\u7801"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    G2D_BLT_NONE_H = 0x0,\n    G2D_BLT_BLACKNESS,\n    G2D_BLT_NOTMERGEPEN,\n    G2D_BLT_MASKNOTPEN,\n    G2D_BLT_NOTCOPYPEN,\n    G2D_BLT_MASKPENNOT,\n    G2D_BLT_NOT,\n    G2D_BLT_XORPEN,\n    G2D_BLT_NOTMASKPEN,\n    G2D_BLT_MASKPEN,\n    G2D_BLT_NOTXORPEN,\n    G2D_BLT_NOP,\n    G2D_BLT_MERGENOTPEN,\n    G2D_BLT_COPYPEN,\n    G2D_BLT_MERGEPENNOT,\n    G2D_BLT_MERGEPEN,\n    G2D_BLT_WHITENESS = 0x000000ff,\n\n    G2D_ROT_90  = 0x00000100,\n    G2D_ROT_180 = 0x00000200,\n    G2D_ROT_270 = 0x00000300,\n    G2D_ROT_0   = 0x00000400,\n    G2D_ROT_H = 0x00001000,\n    G2D_ROT_V = 0x00002000,\n\n/*  G2D_SM_TDLR_1  =    0x10000000, */\n    G2D_SM_DTLR_1 = 0x10000000,\n/*  G2D_SM_TDRL_1  =    0x20000000, */\n/*  G2D_SM_DTRL_1  =    0x30000000, */\n} g2d_blt_flags_h;\nG2D_BLT_NONE \u5355\u4e2a\u6e90\u64cd\u4f5c\nG2D_BLT_BLACK BLACKNESS :\u4f7f\u7528\u4e0e\u7269\u7406\u8c03\u8272\u677f\u7684\u7d22\u5f150\u76f8\u5173\u7684\u8272\u5f69\u6765\u586b\u5145\u76ee\u6807\u77e9\u5f62\u533a\u57df,(\u5bf9\u7f3a\u7701\u7684\u7269\u7406\u8c03\u8272\u677f,\u8be5\u989c\n\u8272\u4e3a\u9ed1\u8272)\nG2D_BLT_NOTMERGEPEN dst = ~(dst+src) :\nG2D_BLT_MASKNOTPEN dst =~src&dst\nG2D_BLT_NOTCOPYPEN dst =~src\nG2D_BLT_MASKPENNOT dst =src&~dst\nG2D_BLT_NOT dst =~dst :\u4f7f\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u53d6\u53cd\nG2D_BLT_XORPEN dst =src^dst\nG2D_BLT_NOTMASKPEN dst =~(src&dst)\nG2D_BLT_MASKPEN dst =src&dst\nG2D_BLT_NOTXORPEN dst =~(src^dst)\nG2D_BLT_NOP dst =dst\nG2D_BLT_MERGENOTPEN dst =~src+dst\nG2D_BLT_COPEPEN dst =src\nG2D_BLT_MERGEPENNOT dst =src+~dst\nG2D_BLT_MERGEPEN dst =src+dst\nG2D_BLT_WHITE WHITENESS :\u4f7f\u7528\u4e0e\u7269\u7406\u8c03\u8272\u677f\u4e2d\u7d22\u5f151\u6709\u5173\u7684\u989c\u8272\u586b\u5145\u76ee\u6807\u77e9\u5f62\u533a\u57df(\u5bf9\u4e8e\u7f3a\u7701\u7269\u7406\u8c03\u8272\u677f\u6765\u8bf4,\u8fd9\n\u4e2a\u989c\u8272\u4e3a\u767d\u8272)\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_image_enh",children:"g2d_image_enh"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_image_enh"})," \u4e3b\u8981\u63cf\u8ff0\u56fe\u7247\u7684\u5bbd\u9ad8\u3001\u5b58\u653e\u5730\u5740\u3001\u662f\u5426\u505aClip \u5904\u7406\uff0c\u662f\u5426\u4e3a\u9884\u4e58\u7b49\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef struct {\n    int      bbuff;\n    __u32        color;\n    g2d_fmt_enh  format;\n    __u32        laddr[3];\n    __u32        haddr[3];\n    __u32        width;\n    __u32        height;\n    __u32        align[3];\n\n    g2d_rect     clip_rect;\n    g2d_size     resize;\n    g2d_coor     coor;\n\n    __u32        gamut;\n    int      bpremul;\n    __u8         alpha;\n    g2d_alpha_mode_enh mode;\n    int      fd;\n    __u32 use_phy_addr;\n} g2d_image_enh;\nformat: \u56fe\u683c\u5f0f\nladdr Buffer: \u8d77\u59cb\u4f4e\u4f4d\u5730\u5740\nhaddr Buffer: \u8d77\u59cb\u9ad8\u4f4d\u5730\u5740\nwidth : \u56fe\u5bbd\u5ea6\uff08in pixel\uff09\nheight : \u56fe\u9ad8\u5ea6\uff08in pixel\uff09\npitch : Buffer\u7684pitch\nclip_rect : ROI\u77e9\u5f62\ngamut : \u56fe\u7684\u8272\u57df\nbpremul : \u662f\u5426\u4e3a\u9884\u4e58\nalpha : \u9762alpha\u503c\nmode : alpha\u6a21\u5f0f\u8bbe\u7f6e\nuse_phy_addr: \u662f\u5426\u4f7f\u7528\u7269\u7406\u5730\u5740\u7684\u6807\u5fd7\u30021\u8868\u793a\u4f7f\u7528\uff0c0\u8868\u793a\u4f7f\u7528fd\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6ce8\u610f: \u5f53 ",(0,i.jsx)(n.code,{children:"use_phy_addr"})," \u4e3a ",(0,i.jsx)(n.code,{children:"1"})," \u7684\u65f6\u5019\uff0c\u4f60\u5fc5\u987b\u81ea\u5df1\u8bbe\u7f6e\u597d ",(0,i.jsx)(n.code,{children:"laddr"})," \u548c ",(0,i.jsx)(n.code,{children:"haddr"}),"\uff0c\u5e76\u81ea\u884c\u505a\u597d\u504f\u79fb\u3002\u4f7f\u7528",(0,i.jsx)(n.code,{children:"fd"})," \u5219\u4e0d\u9700\u8981\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u6570\u7ec4\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"g2d_fmt_enh",children:"g2d_fmt_enh"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_fmt_enh"})," \u7528\u4e8e\u63cf\u8ff0G2D \u6a21\u5757\u652f\u6301\u7684\u683c\u5f0f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum {\n    G2D_FORMAT_ARGB8888,\n    G2D_FORMAT_ABGR8888,\n    G2D_FORMAT_RGBA8888,\n    G2D_FORMAT_BGRA8888,\n    G2D_FORMAT_XRGB8888,\n    G2D_FORMAT_XBGR8888,\n    G2D_FORMAT_RGBX8888,\n    G2D_FORMAT_BGRX8888,\n    G2D_FORMAT_RGB888,\n    G2D_FORMAT_BGR888,\n    G2D_FORMAT_RGB565,\n    G2D_FORMAT_BGR565,\n    G2D_FORMAT_ARGB4444,\n    G2D_FORMAT_ABGR4444,\n    G2D_FORMAT_RGBA4444,\n    G2D_FORMAT_BGRA4444,\n    G2D_FORMAT_ARGB1555,\n    G2D_FORMAT_ABGR1555,\n    G2D_FORMAT_RGBA5551,\n    G2D_FORMAT_BGRA5551,\n    G2D_FORMAT_ARGB2101010,\n    G2D_FORMAT_ABGR2101010,\n    G2D_FORMAT_RGBA1010102,\n    G2D_FORMAT_BGRA1010102,\n\n    /* invailed for UI channel */\n    G2D_FORMAT_IYUV422_V0Y1U0Y0 = 0x20,\n    G2D_FORMAT_IYUV422_Y1V0Y0U0,\n    G2D_FORMAT_IYUV422_U0Y1V0Y0,\n    G2D_FORMAT_IYUV422_Y1U0Y0V0,\n\n    G2D_FORMAT_YUV422UVC_V1U1V0U0,\n    G2D_FORMAT_YUV422UVC_U1V1U0V0,\n    G2D_FORMAT_YUV422_PLANAR,\n\n    G2D_FORMAT_YUV420UVC_V1U1V0U0 = 0x28,\n    G2D_FORMAT_YUV420UVC_U1V1U0V0,\n    G2D_FORMAT_YUV420_PLANAR,\n\n    G2D_FORMAT_YUV411UVC_V1U1V0U0 = 0x2c,\n    G2D_FORMAT_YUV411UVC_U1V1U0V0,\n    G2D_FORMAT_YUV411_PLANAR,\n\n    G2D_FORMAT_Y8 = 0x30,\n\n    /* YUV 10bit format */\n    G2D_FORMAT_YVU10_P010 = 0x34,\n\n    G2D_FORMAT_YVU10_P210 = 0x36,\n\n    G2D_FORMAT_YVU10_444 = 0x38,\n    G2D_FORMAT_YUV10_444 = 0x39,\n    G2D_FORMAT_MAX,\n} g2d_fmt_enh;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_rop3_cmd_flag",children:"g2d_rop3_cmd_flag"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_rop3_cmd_flag"})," \u7528\u4e8e\u5b9a\u4e49\u4e09\u5143\u5149\u6805\u64cd\u4f5c\u7801"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    G2D_ROP3_BLACKNESS = 0x00,\n    G2D_ROP3_NOTSRCERASE = 0x11,\n    G2D_ROP3_NOTSRCCOPY = 0x33,\n    G2D_ROP3_SRCERASE = 0x44,\n    G2D_ROP3_DSTINVERT = 0x55,\n    G2D_ROP3_PATINVERT = 0x5A,\n    G2D_ROP3_SRCINVERT = 0x66,\n    G2D_ROP3_SRCAND = 0x88,\n    G2D_ROP3_MERGEPAINT = 0xBB,\n    G2D_ROP3_MERGECOPY = 0xC0,\n    G2D_ROP3_SRCCOPY = 0xCC,\n    G2D_ROP3_SRCPAINT = 0xEE,\n    G2D_ROP3_PATCOPY = 0xF0,\n    G2D_ROP3_PATPAINT = 0xFB,\n    G2D_ROP3_WHITENESS = 0xFF,\n} g2d_rop3_cmd_flag;\nG2D_ROP3_BLACKNESS dst = BLACK\nG2D_ROP3_NOTSRCERASE dst = (NOT src) AND (NOT dst)\nG2D_ROP3_NOTSRCCOPY dst = (NOT src) :\u5c06\u6e90\u77e9\u5f62\u533a\u57df\u989c\u8272\u53d6\u53cd,\u62f7\u8d1d\u5230\u76ee\u6807\u77e9\u5f62\u533a\u57df\nG2D_ROP3_SRCERASE dst = src AND (NOT dst )\nG2D_ROP3_DSTINVERT dst = (NOT dst)\nG2D_ROP3_PATINVERT dst = pattern XOR dst :\u901a\u8fc7\u4f7f\u7528\u5e03\u5c14\u578b\u7684\u5f02\u6216(XOR)\u64cd\u4f5c\u7b26\u5c06\u7279\u5b9a\u6a21\u5f0f\u548c\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u5408\u5e76\nG2D_ROP3_SRCINVERT dst = src XOR dst :\u901a\u8fc7\u4f7f\u7528\u5e03\u5c14\u578b\u7684\u5f02\u6216(XOR)\u64cd\u4f5c\u7b26\u5c06\u6e90\u548c\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u5408\u5e76\nG2D_ROP3_SRCAND dst = srcAND dst :\u901a\u8fc7\u4f7f\u7528\u4e0e\u64cd\u4f5c\u7b26\u5c06\u6e90\u548c\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u503c\u5408\u5e76\nG2D_ROP3_MERGEPAINT dst = (NOT src) OR dst :\u901a\u8fc7\u4f7f\u7528\u5e03\u5c14\u578b\u7684\u6216(OR)\u64cd\u4f5c\u7b26\u5c06\u53cd\u5411\u7684\u6e90\u77e9\u5f62\u533a\u57df\u7684\u989c\u8272\u4e0e\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u5408\u5e76\nG2D_ROP3_MERGECOPY dst = (src AND pattern)\nG2D_ROP3_SRCCOPY dst = src :\u5c06\u6e90\u77e9\u5f62\u533a\u57df\u76f4\u63a5\u62f7\u8d1d\u5230\u76ee\u6807\u77e9\u5f62\u533a\u57df\nG2D_ROP3_SRCPAINT dst = src OR dst :\u901a\u8fc7\u4f7f\u7528\u5e03\u5c14\u578b\u7684\u6216(OR)\u64cd\u4f5c\u7b26\u5c06\u6e90\u548c\u76ee\u6807\u77e9\u5f62\u533a\u57df\u989c\u8272\u5408\u5e76\nG2D_ROP3_PATCOPY dst = pattern\nG2D_ROP3_PATPAINT dst = DPSnoo :\u901a\u8fc7\u4f7f\u7528\u5e03\u5c14\u578b\u7684\u6216(OR)\u64cd\u4f5c\u7b26\u5c06\u6e90\u77e9\u5f62\u533a\u57df\u53d6\u53cd\u540e\u7684\u989c\u8272\u503c\u4e0e\u7279\u5b9a\u6a21\u5f0f\u7684\u989c\u8272\u5408\u5e76,\u7136\u540e\u4f7f\u7528OR\u64cd\u4f5c\u7b26\u4e0e\u8be5\u64cd\u4f5c\u7684\u7ed3\u679c\u4e0e\u76ee\u6807\u77e9\u5f62\u533a\u57df\u5185\u7684\u989c\u8272\u5408\u5e76.\nG2D_ROP3_WHITENESS dst = WHITE\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_bld_cmd_flag",children:"g2d_bld_cmd_flag"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_bld_cmd_flag"})," \u5b9a\u4e49BLD \u64cd\u4f5c\u547d\u4ee4"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    G2D_BLD_CLEAR = 0x00000001,\n    G2D_BLD_COPY = 0x00000002,\n    G2D_BLD_DST = 0x00000003,\n    G2D_BLD_SRCOVER = 0x00000004,\n    G2D_BLD_DSTOVER = 0x00000005,\n    G2D_BLD_SRCIN = 0x00000006,\n    G2D_BLD_DSTIN = 0x00000007,\n    G2D_BLD_SRCOUT = 0x00000008,\n    G2D_BLD_DSTOUT = 0x00000009,\n    G2D_BLD_SRCATOP = 0x0000000a,\n    G2D_BLD_DSTATOP = 0x0000000b,\n    G2D_BLD_XOR = 0x0000000c,\n    G2D_CK_SRC = 0x00010000,\n    G2D_CK_DST = 0x00020000,\n} g2d_bld_cmd_flag;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_ck",children:"g2d_ck"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_ck"})," \u5b9a\u4e49\u4e86colorkey \u64cd\u4f5c\u7684\u53c2\u6570"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef struct {\n    int match_rule;\n    __u32 max_color;\n    __u32 min_color;\n} g2d_ck;\nmatch_rule \u5f53match_rule\u4e3a\u5047\u65f6\uff0cColor Min=<Color<=Color Max\u8868\u793a\u6ee1\u8db3\u5339\u914d\u6761\u4ef6\n\u5f53match_rule\u4e3a\u771f\u65f6\uff0cColor>Color Max or Color <Color Min\u8868\u793a\u6ee1\u8db3\u5339\u914d\u6761\u4ef6\nck_max_color Color Max\nck_min_color Color Min\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_alpha_mode_enh",children:"g2d_alpha_mode_enh"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_alpha_mode_enh"})," \u5b9a\u4e49\u8fdb\u884calpha blend \u64cd\u4f5c\u65f6\uff0c\u9009\u62e9\u7684alpha mode"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum{\n    G2D_PIXEL_ALPHA,\n    G2D_GLOBAL_ALPHA,\n    G2D_MIXER_ALPHA,\n}g2d_alpha_mode_enh;\nG2D_PIXEL_ALPHA \u70b9 alpha\nG2D_GLOBAL_ALPHA \u9762 alpha\nG2D_MIXER_ALPHA \u6df7\u5408 alpha\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_color_gmt",children:"g2d_color_gmt"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_color_gmt"})," \u5b9a\u4e49\u8fdb\u884c\u4f4d\u64cd\u4f5c\u65f6\uff0c\u9009\u62e9\u7684\u989c\u8272\u7a7a\u95f4"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum{\n    G2D_BT601,\n    G2D_BT709,\n    G2D_BT2020,\n}g2d_color_gmt;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"g2d_blt_h",children:"g2d_blt_h"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"g2d_blt_h"})," \u5b9e\u73b0\u5bf9 ",(0,i.jsx)(n.code,{children:"foreground"})," \u5e26\u7f29\u653e\u7684ROP2 \u5904\u7406\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef struct {\n    g2d_blt_flags_h flag_h;\n    g2d_image_enh src_image_h;\n    g2d_image_enh dst_image_h;\n} g2d_blt_h;\nflag_h : blt\u64cd\u4f5cflag\u6807\u5fd7\uff0c\u589e\u5f3a\u7248\u6807\u5fd7\nsrc_image_h : \u6e90\u56fe\u50cf\u4fe1\u606f,\u589e\u5f3a\u7248\u7684\u56fe\u50cf\u53c2\u6570,\u8be6\u89c1g2d_image_enh\ndst_image_h : \u76ee\u6807\u56fe\u50cf\u4fe1\u606f\uff0c\u589e\u5f3a\u7248\u7684\u56fe\u50cf\u53c2\u6570\ncolor : colorkey\u989c\u8272\nalpha : \u9762alpha\u503c\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u51fd\u6570\u63a5\u53e3",children:"\u51fd\u6570\u63a5\u53e3"}),"\n",(0,i.jsxs)(n.p,{children:["G2D \u9a71\u52a8\u5411OS \u6216\u5176\u4ed6 ",(0,i.jsx)(n.code,{children:"driver hal"})," \u66b4\u9732\u7684\u63a5\u53e3\u5982\u4e0b\u8868\uff0c\u6a21\u5757\u4f7f\u7528\u4e3b\u8981\u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"ioctl"})," \u5b9e\u73b0\uff0c\u5373 ",(0,i.jsx)(n.code,{children:"sunxi_g2d_control"}),"\uff0c\u540e\u7eed\u5c06\u4e3b\u8981\u4ecb\u7ecd\u8be5\u63a5\u53e3\u7684\u7528\u6cd5\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u5f00\u542f-g2d",children:"\u5f00\u542f G2D"}),"\n",(0,i.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int sunxi_g2d_open(void);\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"\u5176\u4ed6\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"\u5173\u95ed-g2d",children:"\u5173\u95ed G2D"}),"\n",(0,i.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int sunxi_g2d_close(void);\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"\u5176\u4ed6\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"g2d-\u9a71\u52a8-ioctl-\u63a5\u53e3",children:"G2D \u9a71\u52a8 ioctl \u63a5\u53e3"}),"\n",(0,i.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int sunxi_g2d_control(int cmd, void *arg);\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"cmd: \u64cd\u4f5c\u7c7b\u578b"}),"\n",(0,i.jsx)(n.li,{children:"arg\uff1a\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"\u5176\u4ed6\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"g2d-ioctl-\u64cd\u4f5c\u793a\u4f8b",children:"G2D ioctl \u64cd\u4f5c\u793a\u4f8b"}),"\n",(0,i.jsx)(n.h3,{id:"\u5355\u5e45\u56fe\u7684\u7f29\u653e\u683c\u5f0f\u8f6c\u6362",children:"\u5355\u5e45\u56fe\u7684\u7f29\u653e\u3001\u683c\u5f0f\u8f6c\u6362"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_BITBLT_H\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u73b0\u5355\u5e45\u56fe\u7684\u7f29\u653e\u3001\u683c\u5f0f\u8f6c\u6362\u7b49\u3002\u5b9e\u73b0\u5bf9foreground \u5e26\u7f29\u653e\u7684 ROP2 \u5904\u7406\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u65cb\u8f6c\u529f\u80fd",children:"\u65cb\u8f6c\u529f\u80fd"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'blit.flag_h = G2D_ROT_90;\nblit.src_image_h.addr[0] = saddr[0];\nblit.src_image_h.format = G2D_FORMAT_ARGB8888;\nblit.src_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.src_image_h.clip_rect.x = 0;\nblit.src_image_h.clip_rect.y = 0;\nblit.src_image_h.clip_rect.w = 1920;\nblit.src_image_h.clip_rect.h = 1080;\nblit.src_image_h.width = 1920;\nblit.src_image_h.height = 1080;\nblit.src_image_h.alpha = 0xff;\nblit.dst_image_h.addr[0] = daddr[0];\nblit.dst_image_h.format = G2D_FORMAT_ARGB8888;\nblit.dst_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.dst_image_h.clip_rect.x = 0;\nblit.dst_image_h.clip_rect.y = 0;\nblit.dst_image_h.clip_rect.w = 1920;\nblit.dst_image_h.clip_rect.h = 1080;\nblit.dst_image_h.alpha = 0xff;\nblit.dst_image_h.width = 1920;\nblit.dst_image_h.height = 1080;\n\nif (sunxi_g2d_control(G2D_CMD_BITBLT_H, (unsigned long)(&blit)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_BITBLT_H failure!\\n", __LINE__, __FILE__,__FUNCTION__);\n  return \ufffd6\ufffd21;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u7f29\u653e\u529f\u80fd",children:"\u7f29\u653e\u529f\u80fd"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'blit.flag_h = G2D_BLT_NONE_0;\nblit.src_image_h.addr[0] = saddr[0];\nblit.src_image_h.format = G2D_FORMAT_ARGB8888;\nblit.src_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.src_image_h.clip_rect.x = 0;\nblit.src_image_h.clip_rect.y = 0;\nblit.src_image_h.clip_rect.w = 1280;\nblit.src_image_h.clip_rect.h = 800;\nblit.src_image_h.width = 1280;\nblit.src_image_h.height = 800;\nblit.src_image_h.alpha = 0xff;\nblit.dst_image_h.addr[0] = daddr[0];\nblit.dst_image_h.format = G2D_FORMAT_ARGB8888;\nblit.dst_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.dst_image_h.clip_rect.x = 0;\nblit.dst_image_h.clip_rect.y = 0;\nblit.dst_image_h.clip_rect.w = 1920;\nblit.dst_image_h.clip_rect.h = 1080;\nblit.dst_image_h.alpha = 0xff;\nblit.dst_image_h.width = 1920;\nblit.dst_image_h.height = 1080;\n\nif (sunxi_g2d_control(G2D_CMD_BITBLT_H, (unsigned long)(&blit)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_BITBLT_H failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  return \ufffd6\ufffd21;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u683c\u5f0f\u8f6c\u6362",children:"\u683c\u5f0f\u8f6c\u6362"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'blit.flag_h = G2D_BLT_NONE_0;\nblit.src_image_h.addr[0] = saddr[0];\nblit.src_image_h.format = G2D_FORMAT_ARGB8888;\nblit.src_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.src_image_h.clip_rect.x = 0;\nblit.src_image_h.clip_rect.y = 0;\nblit.src_image_h.clip_rect.w = 1280;\nblit.src_image_h.clip_rect.h = 800;\nblit.src_image_h.width = 1280;\nblit.src_image_h.height = 800;\nblit.src_image_h.alpha = 0xff;\nblit.dst_image_h.addr[0] = daddr[0];\nblit.dst_image_h.format = G2D_FORMAT_YUV420UVC_V1U1V0U0;\nblit.dst_image_h.mode = G2D_GLOBAL_ALPHA;\nblit.dst_image_h.clip_rect.x = 0;\nblit.dst_image_h.clip_rect.y = 0;\nblit.dst_image_h.clip_rect.w = 1280;\nblit.dst_image_h.clip_rect.h = 800;\nblit.dst_image_h.alpha = 0xff;\nblit.dst_image_h.width = 1280;\nblit.dst_image_h.height = 800;\n\nif (sunxi_g2d_control(G2D_CMD_BITBLT_H, (unsigned long)(&blit)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_BITBLT_H failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  return \ufffd6\ufffd21;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u4e24\u5e45\u56fe\u7684bld\u64cd\u4f5c",children:"\u4e24\u5e45\u56fe\u7684BLD\u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_BLD_H\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u73b0\u4e24\u5e45\u56fe\u7684BLD(porter\ufffd6\ufffd2duff) \u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'blend.bld_cmd = G2D_BLD_COPY;\nblend.src_image_h.mode = G2D_GLOBAL_ALPHA;\nblend.src_image_h.format = G2D_FORMAT_ARGB8888;\nblend.src_image_h.alpha = 128;\nblend.src_image_h.clip_rect.x = 0;\nblend.src_image_h.clip_rect.y = 0;\nblend.src_image_h.clip_rect.w = 1280;\nblend.src_image_h.clip_rect.h = 800;\nblend.src_image_h.width = 1280;\nblend.src_image_h.height = 800;\nblend.dst_image_h.mode = G2D_GLOBAL_ALPHA;\nblend.dst_image_h.format = G2D_FORMAT_ARGB8888;\nblend.dst_image_h.alpha = 128;\nblend.dst_image_h.clip_rect.x = 0;\nblend.dst_image_h.clip_rect.y = 0;\nblend.dst_image_h.clip_rect.w = 1280;\nblend.dst_image_h.clip_rect.h = 800;\nblend.dst_image_h.width = 1280;\nblend.dst_image_h.height = 800;\nif (sunxi_g2d_control(G2D_CMD_BLD_H, (unsigned long)(&blend)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_BLD_H failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  return \ufffd6\ufffd21;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u63a9\u819c\u56fe\u5149\u6805\u64cd\u4f5c",children:"\u63a9\u819c\u56fe\u5149\u6805\u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_MASK_H\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u63a9\u819c\u56fe\u548c\u5149\u6805\u64cd\u4f5c\u7801\u5bf9src\u3001pattern \u548cdst \u8fdb\u884c\u64cd\u4f5c\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u5230dst \u4e2d."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'mask.back_flag = G2D_ROP3_NOTSRCCOPY;\nmask.fore_flag = G2D_ROP3_SRCINVERT;\nmask.src_image_h.clip_rect.x = 0;\nmask.src_image_h.clip_rect.y = 0;\nmask.src_image_h.clip_rect.w = 1280;\nmask.src_image_h.clip_rect.h = 800;\nmask.src_image_h.width = 1280;\nmask.src_image_h.height = 800;\nmask.src_image_h.mode = G2D_GLOBAL_ALPHA;\nmask.dst_image_h.clip_rect.x = 0;\nmask.dst_image_h.clip_rect.y = 0;\nmask.dst_image_h.clip_rect.w = 1280;\nmask.dst_image_h.clip_rect.h = 800;\nmask.dst_image_h.width = 1280;\nmask.dst_image_h.height = 800;\nmask.dst_image_h.mode = G2D_GLOBAL_ALPHA;\nmask.mask_image_h.clip_rect.x = 0;\nmask.mask_image_h.clip_rect.y = 0;\nmask.mask_image_h.clip_rect.w = 1280;\nmask.mask_image_h.clip_rect.h = 800;\nmask.mask_image_h.width = 1280;\nmask.mask_image_h.height = 800;\nmask.mask_image_h.mode = G2D_GLOBAL_ALPHA;\nmask.ptn_image_h.clip_rect.x = 0;\nmask.ptn_image_h.clip_rect.y = 0;\nmask.ptn_image_h.clip_rect.w = 1280;\nmask.ptn_image_h.clip_rect.h = 800;\nmask.ptn_image_h.width = 1280;\nmask.ptn_image_h.height = 800;\nmask.ptn_image_h.mode = G2D_GLOBAL_ALPHA;\nmask.src_image_h.alpha = 0xff;\nmask.mask_image_h.alpha = 0xff;\nmask.ptn_image_h.alpha = 0xff;\nmask.dst_image_h.alpha = 0xff;\nmask.src_image_h.format = G2D_FORMAT_ARGB8888;\nmask.mask_image_h.format = G2D_FORMAT_ARGB8888;\nmask.ptn_image_h.format = G2D_FORMAT_ARGB8888;\nmask.dst_image_h.format = G2D_FORMAT_ARGB8888;\n\nif (sunxi_g2d_control(G2D_CMD_MASK_H, (unsigned long)(&mask)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_MASK_H failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n      return \ufffd6\ufffd21;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6279\u5904\u7406\u63a5\u53e3",children:"\u6279\u5904\u7406\u63a5\u53e3"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_MIXER_TASK\nstruct mixer_para {\n    g2d_operation_flag op_flag;\n    g2d_blt_flags_h flag_h;\n    g2d_rop3_cmd_flag back_flag;\n    g2d_rop3_cmd_flag fore_flag;\n    g2d_bld_cmd_flag bld_cmd;\n    g2d_image_enh src_image_h;\n    g2d_image_enh dst_image_h;\n    g2d_image_enh ptn_image_h;\n    g2d_image_enh mask_image_h;\n    g2d_ck ck_para;\n};\n\ntypedef enum {\n    OP_FILLRECT = 0x1,\n    OP_BITBLT = 0x2,\n    OP_BLEND = 0x4,\n    OP_MASK = 0x8,\n    OP_SPLIT_MEM = 0x10,\n} g2d_operation_flag;\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"struct mixer_para"})," \u662f RCQ \u6279\u5904\u7406\u7684\u6838\u5fc3\u7ed3\u6784\u4f53\uff0c\u53ef\u4ee5\u770b\u5230\u9664\u4e86\u7b2c\u4e00\u4e2a\u6210\u5458\uff0c\u5176\u5b83\u6210\u5458\u7684\u7c7b\u578b\u90fd\u662f\u65e7\u9a71\u52a8\u91cc\u9762\u6709\u7684\uff0c",(0,i.jsx)(n.code,{children:"struct mixer_para"})," \u662f\u4e4b\u524d\u9a71\u52a8\u63a5\u53e3\u7ed3\u6784\u4f53\u7684\u4e00\u4e2a\u5408\u96c6\uff0c\u5982\u56fe\u6240\u793a\uff1a"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part2/chapter8/image7.jpg",alt:"image7"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6240\u4ee5\u4f60\u53ef\u4ee5\u7528\u6279\u5904\u7406\u63a5\u53e3\u5b8c\u6210\u4e0a\u9762\u5176\u5b83\u63a5\u53e3\u7684\u529f\u80fd\uff0c\u53ea\u8981\u4f60\u8bbe\u7f6e\u597d\u5bf9\u5e94\u7684\u6210\u5458\u548c",(0,i.jsx)(n.code,{children:"g2d_operation_flag"}),"\u5373\u53ef."]}),"\n",(0,i.jsx)(n.p,{children:"\u5176\u4e2d arg \u7684\u53c2\u6570\u5982\u4e0b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"arg[0]: \u8bbe\u5907\u6587\u4ef6\u6807\u8bc6\u7b26arg\u6307\u5411mixer_para\u6307\u9488\uff0c\u6279\u5904\u7406\u7684\u8bdd\u5c31\u662f\u6570\u7ec4\u6307\u9488\u3002\narg[1]: \u6307\u9488\u9700\u8981\u5904\u7406\u7684\u5e27\u7684\u6570\u91cf\uff0c\u5927\u4e8e\u7b49\u4e8e1\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u6237\u8981\u505a\u7684\u4e8b\u60c5\uff0c\u5c31\u662f\u586b\u5145\u597dmixer_para \u6570\u7ec4\uff0c\u7533\u8bf7\u597d\u8f93\u5165\u8f93\u51fa\u5185\u5b58\uff0c\u5c06\u8981\u5904\u7406\u7684\u56fe\u50cf\u5199\u5165\u5230\u8f93\u5165\u5185\u5b58\u91cc\u9762\uff0c\u5c06\u5904\u7406\u597d\u7684\u56fe\u50cf\u5728\u8f93\u51fa\u5185\u5b58\u91cc\u9762\u53d6\u51fa\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0b\u9762\u662f\u6279\u5904\u7406\u7f29\u653e16 \u5e27\u793a\u4f8b\uff0c\u5176\u4e2d4 \u5e27\u662frgb \u683c\u5f0f\u7684\u7f29\u653e\uff0c6 \u5e27\u662fY8 \u7684\u662f\u7f29\u653e\uff0c6 \u5e27\u662fnv12 \u7684\u7f29\u653e\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'#define RGB_IMAGE_NAME "../../pic/c1080_good.rgb"\n#define Y8_IMAGE_NAME "../../pic/en_dmabuf_bike_1280x720_220_Y8.bin"\n#define NV12_IMAGE_NAME "../../pic/bike_1280x720_220.bin"\n#define FRAME_TO_BE_PROCESS 16\n\n/*4 rgb convert 6 Y8 convert 6 yuv420 convert*/\nunsigned int out_width[FRAME_TO_BE_PROCESS] = {\n    192,  154,  108,  321,  447,  960, 241, 320,\n    1920, 1439, 1280, 1920, 2048, 720, 800, 480};\n\nunsigned int out_height[FRAME_TO_BE_PROCESS] = {\n    108,  87,  70,   217, 213, 640,\n    840,  240, 1080, 777, 800, 1080,\n    2048, 480, 480,  240};\n\nstruct test_info_t {\n  struct mixer_para info[FRAME_TO_BE_PROCESS];\n  .....\n};\n\nint main() {\n  ....\n  test_info.info[0].flag_h = G2D_BLT_NONE_H;\n  test_info.info[0].op_flag = OP_BITBLT;\n  test_info.info[0].src_image_h.format = G2D_FORMAT_RGB888;\n  test_info.info[0].src_image_h.width = 1920;\n  test_info.info[0].src_image_h.height = 1080;\n  test_info.info[0].src_image_h.clip_rect.x = 0;\n  test_info.info[0].src_image_h.clip_rect.y = 0;\n  test_info.info[0].src_image_h.clip_rect.w = 1920;\n  test_info.info[0].src_image_h.clip_rect.h = 1080;\n  test_info.info[0].src_image_h.color = 0xee8899;\n  test_info.info[0].src_image_h.mode = G2D_PIXEL_ALPHA;\n  test_info.info[0].src_image_h.alpha = 0xaa;\n  test_info.info[0].src_image_h.align[0] = 0;\n  test_info.info[0].src_image_h.align[1] = 0;\n  test_info.info[0].src_image_h.align[2] = 0;\n  test_info.info[0].dst_image_h.format = G2D_FORMAT_RGB888;\n  test_info.info[0].dst_image_h.width = 800;\n  test_info.info[0].dst_image_h.height = 480;\n  test_info.info[0].dst_image_h.clip_rect.x = 0;\n  test_info.info[0].dst_image_h.clip_rect.y = 0;\n  test_info.info[0].dst_image_h.clip_rect.w = 1920;\n  test_info.info[0].dst_image_h.clip_rect.h = 1080;\n  test_info.info[0].dst_image_h.color = 0xee8899;\n  test_info.info[0].dst_image_h.mode = G2D_PIXEL_ALPHA;\n  test_info.info[0].dst_image_h.alpha = 255;\n  test_info.info[0].dst_image_h.align[0] = 0;\n  test_info.info[0].dst_image_h.align[1] = 0;\n  test_info.info[0].dst_image_h.align[2] = 0;\n  for (i = 0; i < FRAME_TO_BE_PROCESS; ++i) {\n    memcpy(&test_info.info[i], &test_info.info[0], sizeof(struct mixer_para));\n    test_info.info[i].dst_image_h.width = out_width[i];\n    test_info.info[i].dst_image_h.height = out_height[i];\n    test_info.info[i].dst_image_h.clip_rect.w = out_width[i];\n    test_info.info[i].dst_image_h.clip_rect.h = out_height[i];\n    if (i < 4) {\n      test_info.out_size[i] = test_info.info[i].dst_image_h.width *\n                              test_info.info[i].dst_image_h.height * 3;\n      test_info.info[i].src_image_h.format = G2D_FORMAT_BGR888;\n      test_info.info[i].src_image_h.width = 1920;\n      test_info.info[i].src_image_h.height = 1080;\n      test_info.info[i].src_image_h.clip_rect.w = 1920;\n      test_info.info[i].src_image_h.clip_rect.h = 1080;\n      test_info.in_size[i] = 1920 * 1080 * 3;\n      snprintf(test_info.src_image_name[i], 100, "%s", RGB_IMAGE_NAME);\n    } else if (i < 10) {\n      test_info.out_size[i] = test_info.info[i].dst_image_h.width *\n                              test_info.info[i].dst_image_h.height;\n      test_info.info[i].src_image_h.format = G2D_FORMAT_Y8;\n      test_info.info[i].src_image_h.width = 1280;\n      test_info.info[i].src_image_h.height = 720;\n      test_info.info[i].src_image_h.clip_rect.w = 1280;\n      test_info.info[i].src_image_h.clip_rect.h = 720;\n      test_info.in_size[i] = 1280 * 720;\n      snprintf(test_info.src_image_name[i], 100, "%s", Y8_IMAGE_NAME);\n    } else {\n      test_info.out_size[i] = test_info.info[i].dst_image_h.width *\n                              test_info.info[i].dst_image_h.height * 2;\n      test_info.info[i].src_image_h.format = G2D_FORMAT_YUV420UVC_U1V1U0V0;\n      test_info.info[i].src_image_h.width = 1280;\n      test_info.info[i].src_image_h.height = 720;\n      test_info.info[i].src_image_h.clip_rect.w = 1280;\n      test_info.info[i].src_image_h.clip_rect.h = 720;\n      test_info.in_size[i] = 1280 * 720 * 2;\n      snprintf(test_info.src_image_name[i], 100, "%s", NV12_IMAGE_NAME);\n    }\n    ret = ion_memory_request(&test_info.dst_ion[i], 1, NULL,\n                             test_info.out_size[i]);\n    test_info.info[i].dst_image_h.fd =\n        test_info.dst_ion[i].fd_data.fd;  // rtos\ufffd6\ufffd2hal\u4e2d\u7684\u9a71\u52a8\u4e0d\u652f\u6301\u4f7f\u7528fd\uff0c\u8fd9\u91cc\u8bf7\u4fee\u6539\u4e3a\u7269\u7406\u5730\u5740\uff0c\u5e76\u8bbe\u7f6e\u597d\u504f\u79fb\n    test_info.info[i].dst_image_h.format = test_info.info[i].src_image_h.format;\n    ret = ion_memory_request(&test_info.src_ion[i], 0,\n                             test_info.src_image_name[i], test_info.in_size[i]);\n    test_info.info[i].src_image_h.fd =\n        test_info.src_ion[i].fd_data.fd;  // rtos\ufffd6\ufffd2hal\u4e2d\u7684\u9a71\u52a8\u4e0d\u652f\u6301\u4f7f\u7528fd\uff0c\u8fd9\u91cc\u8bf7\u4fee\u6539\u4e3a\u7269\u7406\u5730\u5740\uff0c\u5e76\u8bbe\u7f6e\u597d\u504f\u79fb\n  }\n  arg[0] = (unsigned long)test_info.info;\n  arg[1] = FRAME_TO_BE_PROCESS;\n  if (sunxi_g2d_control(G2D_CMD_MIXER_TASK, (arg)) < 0) {\n    printf("[%d][%s][%s]G2D_CMD_MIXER_TASK failure!\\n", __LINE__, __FILE__,\n           __FUNCTION__);\n    goto FREE_SRC;\n  }\n  printf("[%d][%s][%s]G2D_CMD_MIXER_TASK SUCCESSFULL!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  printf("save result data to file \\n");\n  char sufix[40] = {0};\n  for (i = 0; i < FRAME_TO_BE_PROCESS; ++i) {\n    if (i < 4) {\n      snprintf(sufix, 40, "rgb888");\n    } else if (i < 10)\n      snprintf(sufix, 40, "y8");\n    else\n      snprintf(sufix, 40, "nv12");\n    snprintf(test_info.dst_image_name[i], 100,\n             "../../ result/frame%d_%dx%d_to_%dx%d.%s", i,\n             test_info.info[i].src_image_h.width,\n             test_info.info[i].src_image_h.height,\n             test_info.info[i].dst_image_h.width,\n             test_info.info[i].dst_image_h.height, sufix);\n    if ((test_info.dst_fp[i] = fopen(test_info.dst_image_name[i], "wb+")) ==\n        NULL) {\n      printf("open file %s fail .\\ n", test_info.dst_image_name[i]);\n      break;\n    } else {\n      ret = fwrite(test_info.dst_ion[i].virt_addr, test_info.out_size[i], 1,\n                   test_info.dst_fp[i]);\n      fflush(test_info.src_fp);\n      printf("Frame %d saved\\n", i);\n    }\n  }\n  ....\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u521b\u5efa\u65b0\u7684\u6279\u5904\u7406\u5b9e\u4f8b",children:"\u521b\u5efa\u65b0\u7684\u6279\u5904\u7406\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd` \uff1a`G2D_CMD_CREATE_TASK\narg[0] arg\u6307\u5411mixer_para\u6307\u9488\uff0c\u6279\u5904\u7406\u7684\u8bdd\u5c31\u662f\u6570\u7ec4\u6307\u9488\u3002\narg[1] \u9700\u8981\u5904\u7406\u7684\u5e27\u7684\u6570\u91cf\uff0c\u5927\u4e8e\u7b49\u4e8e1\n\n\u5904\u7406\u540e\uff1a\narg[0]\u5bf9\u5e94\u7684\u6307\u9488\u6240\u6307\u5411\u7684mixer_para\u5185\u5bb9\u4f1a\u88ab\u66f4\u65b0\u3002\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8be5 ",(0,i.jsx)(n.code,{children:"ioctl"})," \u547d\u4ee4\u7528\u4e8e\u521b\u5efa\u65b0\u7684\u6279\u5904\u7406\u5b9e\u4f8b\uff0c\u4f46\u4e0d\u505a\u786c\u4ef6\u5904\u7406, \u53ea\u662f\u51c6\u5907\u597d\u8f6f\u4ef6\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u6784\u9020\u5bf9\u5e94\u5e27\u6570\u7684 ",(0,i.jsx)(n.code,{children:"rcq"})," \u961f\u5217\u5185\u5b58\u4ee5\u53ca\u8fdb\u884c\u8f93\u5165\u8f93\u51fa\u56fe\u50cf\u7684 ",(0,i.jsx)(n.code,{children:"dma map"})," \u548c ",(0,i.jsx)(n.code,{children:"dma umap"})," \u64cd\u4f5c\uff0c\u6784\u9020\u5b8c\u6bd5\u4e4b\u540e\u4f1a\u66f4\u65b0 ",(0,i.jsx)(n.code,{children:"mixer_para"})," \u56de\u5e94\u7528\u5c42\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"task_id"})," \u662f\u552f\u4e00\u7684\uff0c\u53ea\u8981\u4e0d\u9500\u6bc1\u6279\u5904\u7406\u5b9e\u4f8b\uff0c\u4f1a\u4e00\u76f4\u5360\u636e\u8fd9\u4e2a",(0,i.jsx)(n.code,{children:"id"}),"\uff0c\u6839\u636e\u8fd9\u4e2a",(0,i.jsx)(n.code,{children:"id"})," \u7528\u6237\u53ef\u4ee5\u8fdb\u4e00\u6b65\u64cd\u4f5c\uff0c\u6bd4\u5982\u8bbe\u7f6e\uff0c\u9500\u6bc1\uff0c\u83b7\u53d6\u5f53\u524d ",(0,i.jsx)(n.code,{children:"mixer_para"}),"\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u4e0b\u4f8b\u5b50\uff0c\u4f1a\u521b\u5efa\u4e24\u4e2a\u4e0d\u540c\u5e27\u6570\u548c\u8f93\u5165\u8f93\u51fa\u683c\u5f0f\u7684\u6279\u5904\u7406\u5b9e\u4f8b\uff0c\u6700\u7ec8\u5f97\u5230\u4e24\u4e2a\u4e0d\u540c\u7684",(0,i.jsx)(n.code,{children:"task id"}),"\uff0c",(0,i.jsx)(n.code,{children:"task0"})," \u548ctask1\u3002",(0,i.jsx)(n.code,{children:"mixer_para"})," \u5982\u4f55\u6784\u9020\u53c2\u8003 ",(0,i.jsx)(n.code,{children:"G2D_CMD_MIXER_TASK"})," \u7684\u4f8b\u5b50\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'arg[0] = (unsigned long)test_info.info;\narg[1] = FRAME_TO_BE_PROCESS;\n\ntask0 = sunxi_g2d_control(G2D_CMD_CREATE_TASK, (arg));\n\nif (task0 < 1) {\n  printf("[%d][%s][%s]G2D_CMD_CREATE_TASK failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\n\nprintf("[%d][%s][%s]G2D_CMD_CREATE_TASK SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\n\narg[0] = (unsigned long)test_info2.info;\narg[1] = FRAME_TO_BE_PROCESS2;\ntask1 = sunxi_g2d_control(G2D_CMD_CREATE_TASK, (arg));\n\nif (task1 < 1) {\n  printf("[%d][%s][%s]G2D_CMD_CREATE_TASK failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\n\nprintf("[%d][%s][%s]G2D_CMD_CREATE_TASK SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6267\u884c\u6279\u5904\u7406\u7684\u786c\u4ef6\u64cd\u4f5c",children:"\u6267\u884c\u6279\u5904\u7406\u7684\u786c\u4ef6\u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_TASK_APPLY\narg[0] task id(\u7531G2D_CMD_CREATE_TASK\u547d\u4ee4\u83b7\u5f97\uff09\narg[1] arg\u6307\u5411mixer_para\u6307\u9488\uff0c\u6279\u5904\u7406\u7684\u8bdd\u5c31\u662f\u6570\u7ec4\u6307\u9488\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8be5 ",(0,i.jsx)(n.code,{children:"ioctl"})," \u547d\u4ee4\u7684\u4f5c\u7528\u662f\u6267\u884c\u6279\u5904\u7406\u7684\u786c\u4ef6\u64cd\u4f5c\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u503c\u5f97\u6ce8\u610f ",(0,i.jsx)(n.code,{children:"arg[1]"})," \u4e2d\u7684",(0,i.jsx)(n.code,{children:"mixer_para"}),"\uff0c\u5fc5\u987b\u662f",(0,i.jsx)(n.code,{children:"G2D_CMD_CREATE_TASK"})," \u4e4b\u540e\u8fd4\u56de\u7684 ",(0,i.jsx)(n.code,{children:"mixer_para"})," \u6216\u8005\u662f\u901a\u8fc7\u53e6\u5916\u4e00\u4e2a ",(0,i.jsx)(n.code,{children:"ioctl"})," \u547d\u4ee4",(0,i.jsx)(n.code,{children:"G2D_CMD_TASK_GET_PARA"})," \u624d\u884c\uff0c\u8fd9\u91cc\u4e0d\u9700\u8981\u5236\u5b9a\u5e27\u6570\u7684\u539f\u56e0\u662f\u524d\u9762\u7684",(0,i.jsx)(n.code,{children:"G2D_CMD_CREATE_TASK"})," \u5df2\u7ecf\u6307\u5b9a\u597d\u5e27\u6570\uff0c\u800c",(0,i.jsx)(n.code,{children:"G2D_CMD_TASK_APPLY"})," \u662f\u57fa\u4e8e",(0,i.jsx)(n.code,{children:"task id"})," \u6765\u6267\u884c\u7684\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'arg[0] = task0;\narg[1] = (unsigned long)test_info.info;\nif (sunxi_g2d_control(G2D_CMD_TASK_APPLY, (arg)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_TASK_APPLY failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\n\nprintf("[%d][%s][%s]G2D_CMD_TASK_APPLY SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\n\narg[0] = task1;\narg[1] = (unsigned long)test_info2.info;\nif (sunxi_g2d_control(G2D_CMD_TASK_APPLY, (arg)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_TASK_APPLY failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\n\nprintf("[%d][%s][%s]G2D_CMD_TASK_APPLY SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u9500\u6bc1\u6307\u5b9a-task-id-\u7684\u6279\u5904\u7406\u5b9e\u4f8b",children:"\u9500\u6bc1\u6307\u5b9a task id \u7684\u6279\u5904\u7406\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a `G2D_CMD_TASK_DESTROY\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8be5ioctl \u547d\u4ee4\u7684\u4f5c\u7528\u662f\u9500\u6bc1\u6307\u5b9atask id \u7684\u6279\u5904\u7406\u5b9e\u4f8b\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'arg[0] = task0;\n\nif (sunxi_g2d_control(G2D_CMD_TASK_DESTROY, (arg)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_TASK_DESTROY failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\nprintf("[%d][%s][%s]G2D_CMD_TASK_DESTROY SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\narg[0] = task1;\n;\nif (sunxi_g2d_control(G2D_CMD_TASK_DESTROY, (arg)) < 0) {\n  printf("[%d][%s][%s]G2D_CMD_TASK_DESTROY failure!\\n", __LINE__, __FILE__,\n         __FUNCTION__);\n  goto FREE_SRC;\n}\nprintf("[%d][%s][%s]G2D_CMD_TASK_DESTROY SUCCESSFULL!\\n",\n       __LINE__,\n       __FILE__,\n       __FUNCTION__);\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"\u83b7\u53d6\u6307\u5b9a-task-id-\u7684-mixer-para",children:["\u83b7\u53d6\u6307\u5b9a ",(0,i.jsx)(n.code,{children:"task id"})," \u7684 ",(0,i.jsx)(n.code,{children:"mixer para"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"g2d_cmd`\uff1a`G2D_CMD_TASK_GET_PARA\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u6237\u5fc5\u987b\u81ea\u884c\u4fdd\u8bc1\u4f20\u5165\u7684\u6307\u9488\u6240\u6307\u5411\u7684\u5185\u5b58\u8db3\u591f\u5b58\u653e\u8fd9\u4e48\u591a\u5e27\u7684\u53c2\u6570"})]})}function h(_={}){const{wrapper:n}={...(0,t.a)(),..._.components};return n?(0,i.jsx)(n,{..._,children:(0,i.jsx)(c,{..._})}):c(_)}},1151:(_,n,e)=>{e.d(n,{Z:()=>s,a:()=>d});var i=e(7294);const t={},l=i.createContext(t);function d(_){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof _?_(n):{...n,..._}}),[n,_])}function s(_){let n;return n=_.disableParentContext?"function"==typeof _.components?_.components(t):_.components||t:d(_.components),i.createElement(l.Provider,{value:n},_.children)}}}]);