"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2919],{6304:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>o});var t=s(5893),i=s(1151);const l={},r="SPI \u9a71\u52a8 TFT LCD \u5c4f",c={id:"demo/part1/chapter16",title:"SPI \u9a71\u52a8 TFT LCD \u5c4f",description:"R128 \u5e73\u53f0\u63d0\u4f9b\u4e86 SPI DBI \u7684 SPI TFT \u63a5\u53e3\uff0c\u5177\u6709\u5982\u4e0b\u7279\u70b9\uff1a",source:"@site/docs/demo/part1/chapter16.md",sourceDirName:"demo/part1",slug:"/demo/part1/chapter16",permalink:"/demo/part1/chapter16",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/demo/part1/chapter16.md",tags:[],version:"current",frontMatter:{},sidebar:"classparttwoSidebar",previous:{title:"R128\u4f7f\u7528RGB LCD",permalink:"/demo/part1/chapter15"},next:{title:"DBI \u9a71\u52a8 TFT LCD \u5c4f",permalink:"/demo/part1/chapter17"}},d={},o=[{value:"\u8f7d\u5165\u65b9\u6848",id:"\u8f7d\u5165\u65b9\u6848",level:2},{value:"\u8bbe\u7f6e SPI \u9a71\u52a8",id:"\u8bbe\u7f6e-spi-\u9a71\u52a8",level:2},{value:"\u914d\u7f6e SPI \u5f15\u811a",id:"\u914d\u7f6e-spi-\u5f15\u811a",level:3},{value:"\u8bbe\u7f6e PWM \u9a71\u52a8",id:"\u8bbe\u7f6e-pwm-\u9a71\u52a8",level:2},{value:"\u914d\u7f6e PWM \u5f15\u811a",id:"\u914d\u7f6e-pwm-\u5f15\u811a",level:3},{value:"\u8bbe\u7f6e SPI LCD \u9a71\u52a8",id:"\u8bbe\u7f6e-spi-lcd-\u9a71\u52a8",level:2},{value:"\u9009\u62e9\u9a71\u52a8\u7684\u663e\u793a\u5c4f",id:"\u9009\u62e9\u9a71\u52a8\u7684\u663e\u793a\u5c4f",level:3},{value:"\u914d\u7f6e SPI LCD \u5f15\u811a",id:"\u914d\u7f6e-spi-lcd-\u5f15\u811a",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c",level:2}];function p(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"spi-\u9a71\u52a8-tft-lcd-\u5c4f",children:"SPI \u9a71\u52a8 TFT LCD \u5c4f"}),"\n",(0,t.jsx)(n.p,{children:"R128 \u5e73\u53f0\u63d0\u4f9b\u4e86 SPI DBI \u7684 SPI TFT \u63a5\u53e3\uff0c\u5177\u6709\u5982\u4e0b\u7279\u70b9\uff1a"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Supports DBI Type C 3 Line/4 Line Interface Mode"}),"\n",(0,t.jsx)(n.li,{children:"Supports 2 Data Lane Interface Mode"}),"\n",(0,t.jsx)(n.li,{children:"Supports data source from CPU or DMA"}),"\n",(0,t.jsx)(n.li,{children:"Supports RGB111/444/565/666/888 video format"}),"\n",(0,t.jsx)(n.li,{children:"Maximum resolution of RGB666 240 x 320@30Hz with single data lane"}),"\n",(0,t.jsx)(n.li,{children:"Maximum resolution of RGB888 240 x 320@60Hz or 320 x 480@30Hz with dual data lane"}),"\n",(0,t.jsx)(n.li,{children:"Supports tearing effect"}),"\n",(0,t.jsx)(n.li,{children:"Supports software flexible control video frame rate"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u540c\u65f6\uff0c\u63d0\u4f9b\u4e86SPILCD\u9a71\u52a8\u6846\u67b6\u4ee5\u4f9b SPI \u5c4f\u5e55\u4f7f\u7528\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u672c\u6b21\u4f7f\u7528\u7684\u662f Dshan_Display Module\uff0c\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image1.png",alt:""})}),"\n",(0,t.jsx)(n.p,{children:"\u5f15\u811a\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"R128 Devkit"}),(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"TFT \u6a21\u5757"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA12"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"CS"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA13"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"SCK"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA18"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"MOSI"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA9"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PWM"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA20"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"RESET"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"PA19"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"RS"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"3V3"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"3.3V"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"GND"}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"GND"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image2.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"\u8f7d\u5165\u65b9\u6848",children:"\u8f7d\u5165\u65b9\u6848"}),"\n",(0,t.jsxs)(n.p,{children:["\u6211\u4eec\u4f7f\u7528\u7684\u5f00\u53d1\u677f\u662f R128-Devkit\uff0c\u9700\u8981\u5f00\u53d1 C906 \u6838\u5fc3\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u6240\u4ee5\u8f7d\u5165\u65b9\u6848\u9009\u62e9 ",(0,t.jsx)(n.code,{children:"r128s2_module_c906"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"$ source envsetup.sh \n$ lunch_rtos 1\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image3.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e-spi-\u9a71\u52a8",children:"\u8bbe\u7f6e SPI \u9a71\u52a8"}),"\n",(0,t.jsxs)(n.p,{children:["\u5c4f\u5e55\u4f7f\u7528\u7684\u662fSPI\u9a71\u52a8\uff0c\u6240\u4ee5\u9700\u8981\u52fe\u9009SPI\u9a71\u52a8\uff0c\u8fd0\u884c ",(0,t.jsx)(n.code,{children:"mrtos_menuconfig"})," \u8fdb\u5165\u914d\u7f6e\u9875\u9762\u3002\u524d\u5f80\u4e0b\u5217\u5730\u5740\u627e\u5230 ",(0,t.jsx)(n.code,{children:"SPI Devices"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"Drivers Options  ---\x3e\n    soc related device drivers  ---\x3e\n        SPI Devices ---\x3e\n        -*- enable spi driver\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image4.png",alt:""})}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6e-spi-\u5f15\u811a",children:"\u914d\u7f6e SPI \u5f15\u811a"}),"\n",(0,t.jsxs)(n.p,{children:["\u6253\u5f00\u4f60\u559c\u6b22\u7684\u7f16\u8f91\u5668\uff0c\u4fee\u6539\u6587\u4ef6\uff1a",(0,t.jsx)(n.code,{children:"board/r128s2/module/configs/sys_config.fex"}),"\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4e0d\u9700\u8981\u7528\u5230 SPI HOLD\u4e0eSPI WP\u5f15\u811a\uff0c\u6ce8\u91ca\u6389\u5373\u53ef\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:";----------------------------------------------------------------------------------\n;SPI controller configuration\n;----------------------------------------------------------------------------------\n;Please config spi in dts\n[spi1]\nspi1_used       = 1\nspi1_cs_number  = 1\nspi1_cs_bitmap  = 1\nspi1_cs0        = port:PA12<6><0><3><default>\nspi1_sclk       = port:PA13<6><0><3><default>\nspi1_mosi       = port:PA18<6><0><3><default>\nspi1_miso       = port:PA21<6><0><3><default>\n;spi1_hold       = port:PA19<6><0><2><default>\n;spi1_wp         = port:PA20<6><0><2><default>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image5.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e-pwm-\u9a71\u52a8",children:"\u8bbe\u7f6e PWM \u9a71\u52a8"}),"\n",(0,t.jsxs)(n.p,{children:["\u5c4f\u5e55\u80cc\u5149\u4f7f\u7528\u7684\u662fPWM\u9a71\u52a8\uff0c\u6240\u4ee5\u9700\u8981\u52fe\u9009PWM\u9a71\u52a8\uff0c\u8fd0\u884c ",(0,t.jsx)(n.code,{children:"mrtos_menuconfig"})," \u8fdb\u5165\u914d\u7f6e\u9875\u9762\u3002\u524d\u5f80\u4e0b\u5217\u5730\u5740\u627e\u5230 ",(0,t.jsx)(n.code,{children:"PWM Devices"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Drivers Options  ---\x3e\n    soc related device drivers  ---\x3e\n        PWM Devices ---\x3e\n        -*- enable pwm driver\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image6.png",alt:""})}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6e-pwm-\u5f15\u811a",children:"\u914d\u7f6e PWM \u5f15\u811a"}),"\n",(0,t.jsxs)(n.p,{children:["\u6253\u5f00\u4f60\u559c\u6b22\u7684\u7f16\u8f91\u5668\uff0c\u4fee\u6539\u6587\u4ef6\uff1a",(0,t.jsx)(n.code,{children:"board/r128s2/module/configs/sys_config.fex"}),"\uff0c\u589e\u52a0 PWM1 \u8282\u70b9"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[pwm1]\npwm_used        = 1\npwm_positive    = port:PA9<4><0><3><default>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image7.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e-spi-lcd-\u9a71\u52a8",children:"\u8bbe\u7f6e SPI LCD \u9a71\u52a8"}),"\n",(0,t.jsxs)(n.p,{children:["SPI LCD \u7531\u4e13\u95e8\u7684\u9a71\u52a8\u7ba1\u7406\u3002\u8fd0\u884c ",(0,t.jsx)(n.code,{children:"mrtos_menuconfig"})," \u8fdb\u5165\u914d\u7f6e\u9875\u9762\u3002\u524d\u5f80\u4e0b\u5217\u5730\u5740\u627e\u5230 ",(0,t.jsx)(n.code,{children:"SPILCD Devices"})," \uff0c\u6ce8\u610f\u540c\u65f6\u52fe\u9009 ",(0,t.jsx)(n.code,{children:"spilcd hal APIs test"})," \u65b9\u4fbf\u6d4b\u8bd5\u4f7f\u7528\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Drivers Options  ---\x3e\n    soc related device drivers  ---\x3e\n        [*] DISP Driver Support(spi_lcd)\n        [*]   spilcd hal APIs test\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image8.png",alt:""})}),"\n",(0,t.jsx)(n.h3,{id:"\u9009\u62e9\u9a71\u52a8\u7684\u663e\u793a\u5c4f",children:"\u9009\u62e9\u9a71\u52a8\u7684\u663e\u793a\u5c4f"}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 SPILCD \u9a71\u52a8\u9009\u62e9\u754c\u9762\u53ef\u4ee5\u770b\u5230 ",(0,t.jsx)(n.code,{children:"LCD_FB panels select"})," \u9009\u62e9 SPI \u5c4f\u5e55\u7684\u9a71\u52a8\uff0c",(0,t.jsxs)(n.strong,{children:["\u672c\u6587\u53ea\u6ce8\u91cd\u4e8e SPI LCD \u7684\u4f7f\u7528\uff0c\u9a71\u52a8\u7f16\u5199\u8bf7\u67e5\u770b\u300a",(0,t.jsx)(n.a,{href:"https://r128.docs.aw-ol.com/sdk_base/spilcd/",children:"SPI LCD \u663e\u793a\u9a71\u52a8"}),"\u300b"]})]}),"\n",(0,t.jsxs)(n.p,{children:["\u8fdb\u5165 ",(0,t.jsx)(n.code,{children:"LCD_FB panels select"})," \u9009\u9879"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image9.png",alt:""})}),"\n",(0,t.jsxs)(n.p,{children:["\u9009\u62e9\u5e76\u52fe\u9009 ",(0,t.jsx)(n.code,{children:"[*] LCD support JLT35031C panel"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image10.png",alt:""})}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6e-spi-lcd-\u5f15\u811a",children:"\u914d\u7f6e SPI LCD \u5f15\u811a"}),"\n",(0,t.jsxs)(n.p,{children:["\u6253\u5f00\u4f60\u559c\u6b22\u7684\u7f16\u8f91\u5668\uff0c\u4fee\u6539\u6587\u4ef6\uff1a",(0,t.jsx)(n.code,{children:"board/r128s2/module/configs/sys_config.fex"})]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"FEX \u89e3\u6790\u5668\u4e0d\u652f\u6301\u884c\u5c3e\u6ce8\u91ca\uff0c\u76f4\u63a5\u590d\u5236\u9700\u8981\u5220\u9664\u884c\u5c3e\u7684\u6ce8\u91ca"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:';----------------------------------------------------------------------------------\n;lcd_fb0 configuration\n;----------------------------------------------------------------------------------\n[lcd_fb0]\n;\u4f7f\u7528\u663e\u793a\u5c4f\nlcd_used            = 1              \n;\u6a21\u578b\uff1aspilcd\nlcd_model_name      = "spilcd"       \n;\u5c4f\u5e55\u9a71\u52a8\uff1ajlt35031c\nlcd_driver_name     = "jlt35031c"    \n;\u5c4f\u5e55\u5bbd\u5206\u8fa8\u7387\nlcd_x               = 320            \n;\u5c4f\u5e55\u9ad8\u5206\u8fa8\u7387\nlcd_y               = 480            \n;\u5c4f\u5e55\u7269\u7406\u5bbd\u5ea6\nlcd_width           = 49             \n;\u5c4f\u5e55\u7269\u7406\u9ad8\u5ea6\nlcd_height          = 74             \n;SPI \u9a71\u52a8\u9891\u7387 60MHz\nlcd_data_speed      = 60             \n;lcd\u4f7f\u7528pwm\u80cc\u5149\nlcd_pwm_used        = 1              \n;lcd\u4f7f\u7528pwm\u80cc\u5149\u901a\u90531\nlcd_pwm_ch          = 1              \n;lcd\u4f7f\u7528pwm\u80cc\u5149\u9891\u73875000Hz\nlcd_pwm_freq        = 5000           \n;lcd\u4f7f\u7528pwm\u80cc\u5149\u76f8\u4f4d0\nlcd_pwm_pol         = 0              \n;lcd\u4f7f\u7528spi\u63a5\u53e3\uff0c0-spi, 1-dbi\nlcd_if              = 0              \n;\u4ee5\u4e0b\u5185\u5bb9\u8be6\u89c1 SPILCD \u6587\u6863\nlcd_pixel_fmt       = 10             \nlcd_dbi_fmt         = 2              \nlcd_dbi_clk_mode    = 0              \nlcd_dbi_te          = 0              \nfb_buffer_num       = 2              \nlcd_dbi_if          = 2              \nlcd_rgb_order       = 0              \nlcd_fps             = 60             \nlcd_spi_bus_num     = 1              \nlcd_frm             = 2              \nlcd_gamma_en        = 1              \nlcd_backlight       = 100            \n\nlcd_power_num       = 0              \nlcd_gpio_regu_num   = 0              \nlcd_bl_percent_num  = 0              \n\n;DC\u811a\nlcd_spi_dc_pin      = port:PA19<1><0><3><0> \n;\u590d\u4f4d\u811a\nlcd_gpio_0          = port:PA20<1><0><2><0>\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image11.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"\u7ed3\u679c",children:"\u7ed3\u679c"}),"\n",(0,t.jsx)(n.p,{children:"\u4ee5\u4e0a\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u7f16\u8bd1\u6253\u5305\u70e7\u5f55\uff0c\u4e0a\u7535\u540e\u5c4f\u5e55\u80cc\u5149\u4eae\u8d77\uff0c\u5c4f\u5e55\u4e3a\u9ed1\u8272\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image12.png",alt:""})}),"\n",(0,t.jsxs)(n.p,{children:["\u5e76\u4e14\u53ef\u4ee5\u5728 LOG \u4e2d\u770b\u5230 ",(0,t.jsx)(n.code,{children:"[LCD_FB] lcd_fb_probe,line:103:"})," \u548c ",(0,t.jsx)(n.code,{children:"spi_clk_init()1609 [spi1] clk rate auto adjust to 48000000"})," SPI \u521d\u59cb\u5316\u7684 LOG\u3002"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image13.png",alt:""})}),"\n",(0,t.jsxs)(n.p,{children:["\u7136\u540e\u53ef\u4ee5\u7528 ",(0,t.jsx)(n.code,{children:"test_spilcd"})," \u6d4b\u8bd5\u5c4f\u5e55\uff0c\u65e5\u5fd7\u5982\u4e0b"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image14.png",alt:""})}),"\n",(0,t.jsx)(n.p,{children:"\u6267\u884c\u547d\u4ee4\u4e4b\u540e\u5c4f\u5e55\u4f1a\u53d8\u4e3a\u9ec4\u8272\u3002"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["SPI \u5c4f\u5e55\u989c\u8272\u8bf4\u660e\uff1aSPI LCD \u663e\u793a\u9a71\u52a8 - SPI LCD \u989c\u8272\u76f8\u5173\u95ee\u9898\uff1a ",(0,t.jsx)(n.a,{href:"https://r128.docs.aw-ol.com/sdk_base/spilcd/#_20",children:"https://r128.docs.aw-ol.com/sdk_base/spilcd/#_20"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter16/image15.png",alt:""})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"test_spilcd"})," \u4ee3\u7801\u5982\u4e0b\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:'#include <stdio.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <string.h>\n#include <unistd.h>\n\n#include <hal_cache.h>\n#include <hal_mem.h>\n#include <hal_log.h>\n#include <hal_cmd.h>\n#include <hal_lcd_fb.h>\n\nstatic uint32_t width;\nstatic uint32_t height;\nstatic long int screensize = 0;\nstatic char *fbsmem_start = 0;\n\nstatic void lcdfb_fb_init(uint32_t yoffset, struct fb_info *p_info)\n{\n    p_info->screen_base = fbsmem_start;\n    p_info->var.xres = width;\n    p_info->var.yres = height;\n    p_info->var.xoffset = 0;\n    p_info->var.yoffset = yoffset;\n}\n\nint show_rgb(unsigned int sel)\n{\n    int i = 0, ret = -1;\n    struct fb_info fb_info;\n    int bpp = 4;\n    unsigned char color[4] = {0xff,0x0,0xff,0x0};\n\n    width = bsp_disp_get_screen_width(sel);\n    height = bsp_disp_get_screen_height(sel);\n\n    screensize = width * bpp * height;\n    fbsmem_start = hal_malloc_coherent(screensize);\n\n    hal_log_info("width = %d, height = %d, screensize = %d, fbsmem_start = %x\\n",\n            width, height, screensize, fbsmem_start);\n\n    memset(fbsmem_start, 0, screensize);\n    for (i = 0; i < screensize / bpp; ++i) {\n        memcpy(fbsmem_start+i*bpp, color, bpp);\n    }\n\n    memset(&fb_info, 0, sizeof(struct fb_info));\n    lcdfb_fb_init(0, &fb_info);\n    hal_dcache_clean((unsigned long)fbsmem_start, screensize);\n    bsp_disp_lcd_set_layer(sel, &fb_info);\n\n    hal_free_coherent(fbsmem_start);\n    return ret;\n}\n\nstatic int cmd_test_spilcd(int argc, char **argv)\n{\n    uint8_t ret;\n\n    hal_log_info("Run spilcd hal layer test case\\n");\n\n    ret = show_rgb(0);\n\n    hal_log_info("spilcd test finish\\n");\n\n    return ret;\n}\n\nFINSH_FUNCTION_EXPORT_CMD(cmd_test_spilcd, test_spilcd, spilcd hal APIs tests)\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>c,a:()=>r});var t=s(7294);const i={},l=t.createContext(i);function r(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);