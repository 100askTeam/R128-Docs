"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3645],{5310:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>r,metadata:()=>d,toc:()=>h});var s=l(5893),i=l(1151);const r={},t="RTOS \u5b89\u5168",d={id:"developer-guide/part1/chapter8",title:"RTOS \u5b89\u5168",description:"\u4ecb\u7ecd R128 \u4e0b\u5b89\u5168\u65b9\u6848\u7684\u529f\u80fd\u3002\u5b89\u5168\u5b8c\u6574\u7684\u65b9\u6848\u57fa\u4e8e\u6807\u51c6\u65b9\u6848\u6269\u5c55\uff0c\u8986\u76d6\u786c\u4ef6\u5b89\u5168\u3001\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce\u3001\u5b89\u5168\u542f\u52a8\u3001\u5b89\u5168\u7cfb\u7edf\u3001\u5b89\u5168\u5b58\u50a8\u7b49\u65b9\u9762\u3002",source:"@site/docs/developer-guide/part1/chapter8.md",sourceDirName:"developer-guide/part1",slug:"/developer-guide/part1/chapter8",permalink:"/en/developer-guide/part1/chapter8",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/developer-guide/part1/chapter8.md",tags:[],version:"current",frontMatter:{},sidebar:"classpartoneSidebar",previous:{title:"\u56fe\u50cf\u91c7\u96c6",permalink:"/en/developer-guide/part1/chapter7"},next:{title:"RTOS \u84dd\u7259",permalink:"/en/developer-guide/part1/chapter9"}},c={},h=[{value:"\u914d\u7f6e\u6587\u4ef6\u76f8\u5173",id:"\u914d\u7f6e\u6587\u4ef6\u76f8\u5173",level:2},{value:"\u529f\u80fd\u4ecb\u7ecd",id:"\u529f\u80fd\u4ecb\u7ecd",level:2},{value:"\u5b89\u5168\u786c\u4ef6",id:"\u5b89\u5168\u786c\u4ef6",level:2},{value:"Arm M33 Star TrustZone \u7b80\u4ecb",id:"arm-m33-star-trustzone-\u7b80\u4ecb",level:3},{value:"\u5b89\u5168\u6269\u5c55\u529f\u80fd",id:"\u5b89\u5168\u6269\u5c55\u529f\u80fd",level:3},{value:"\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce",id:"\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce",level:2},{value:"\u5b89\u5168\u542f\u52a8",id:"\u5b89\u5168\u542f\u52a8",level:2},{value:"\u5b89\u5168\u56fa\u4ef6\u6784\u5efa",id:"\u5b89\u5168\u56fa\u4ef6\u6784\u5efa",level:3},{value:"\u5b89\u5168\u56fa\u4ef6\u914d\u7f6e",id:"\u5b89\u5168\u56fa\u4ef6\u914d\u7f6e",level:3},{value:"\u542f\u52a8\u6d41\u7a0b",id:"\u542f\u52a8\u6d41\u7a0b",level:3},{value:"\u6821\u9a8c\u6d41\u7a0b",id:"\u6821\u9a8c\u6d41\u7a0b",level:3},{value:"\u7b7e\u540d\u6821\u9a8c",id:"\u7b7e\u540d\u6821\u9a8c",level:3},{value:"\u4fe1\u4efb\u94fe",id:"\u4fe1\u4efb\u94fe",level:3},{value:"\u70e7\u5199 rotpk.bin \u4e0e secure enable bit",id:"\u70e7\u5199-rotpkbin-\u4e0e-secure-enable-bit",level:3},{value:"\u9632\u56de\u9000",id:"\u9632\u56de\u9000",level:3},{value:"\u5b89\u5168\u91cf\u4ea7\u65b9\u6cd5",id:"\u5b89\u5168\u91cf\u4ea7\u65b9\u6cd5",level:3},{value:"\u5b89\u5168\u7cfb\u7edf",id:"\u5b89\u5168\u7cfb\u7edf",level:2},{value:"\u8f6f\u4ef6\u7cfb\u7edf\u67b6\u6784",id:"\u8f6f\u4ef6\u7cfb\u7edf\u67b6\u6784",level:3},{value:"TFM",id:"tfm",level:3},{value:"\u6e90\u7801\u7ed3\u6784",id:"\u6e90\u7801\u7ed3\u6784",level:4},{value:"TFM \u63a5\u53e3",id:"tfm-\u63a5\u53e3",level:3},{value:"\u975e\u5b89\u5168\u7aef\u8c03\u7528\u4f20\u5165\u7684\u975e\u5b89\u5168\u7aef API \u63a5\u53e3\u6307\u9488 pxCallback",id:"\u975e\u5b89\u5168\u7aef\u8c03\u7528\u4f20\u5165\u7684\u975e\u5b89\u5168\u7aef-api-\u63a5\u53e3\u6307\u9488-pxcallback",level:4},{value:"\u6309\u7167\u7ed9\u5b9a\u7684 key_name \u5c06\u957f\u5ea6\u4e3a key_bit_len \u7684 key_data \u70e7\u5199\u5230\u5bf9\u5e94\u7684\u5b89\u5168 efuse \u533a\u57df",id:"\u6309\u7167\u7ed9\u5b9a\u7684-key_name-\u5c06\u957f\u5ea6\u4e3a-key_bit_len-\u7684-key_data-\u70e7\u5199\u5230\u5bf9\u5e94\u7684\u5b89\u5168-efuse-\u533a\u57df",level:4},{value:"\u5728\u5b89\u5168\u7aef\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c",id:"\u5728\u5b89\u5168\u7aef\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c",level:4},{value:"\u5728\u5b89\u5168\u7aef\u8bbe\u7f6e flashenc \u6240\u9700\u7684 nonce \u503c",id:"\u5728\u5b89\u5168\u7aef\u8bbe\u7f6e-flashenc-\u6240\u9700\u7684-nonce-\u503c",level:4},{value:"\u5f00\u542f/\u5173\u95ed\u7279\u5b9a\u901a\u9053\u7684 flashenc",id:"\u5f00\u542f\u5173\u95ed\u7279\u5b9a\u901a\u9053\u7684-flashenc",level:4},{value:"\u8bbe\u7f6e flashenc",id:"\u8bbe\u7f6e-flashenc",level:4},{value:"\u8bbe\u7f6e flashenc \u52a0\u5bc6\u5bc6\u94a5",id:"\u8bbe\u7f6e-flashenc-\u52a0\u5bc6\u5bc6\u94a5",level:4},{value:"\u8bbe\u7f6e flashenc \u52a0\u5bc6\u5730\u5740\u8303\u56f4",id:"\u8bbe\u7f6e-flashenc-\u52a0\u5bc6\u5730\u5740\u8303\u56f4",level:4},{value:"\u8bbe\u7f6e efuse \u4e2d\u7684 ssk \u4f5c\u4e3a flashenc \u7684\u52a0\u5bc6\u5bc6\u94a5",id:"\u8bbe\u7f6e-efuse-\u4e2d\u7684-ssk-\u4f5c\u4e3a-flashenc-\u7684\u52a0\u5bc6\u5bc6\u94a5",level:4},{value:"\u8df3\u8f6c\u5230 tfm \u5b89\u5168\u7a7a\u95f4\u5229\u7528 ssk \u4f5c\u4e3a\u5bc6\u94a5\u8fdb\u884c aes \u52a0\u5bc6",id:"\u8df3\u8f6c\u5230-tfm-\u5b89\u5168\u7a7a\u95f4\u5229\u7528-ssk-\u4f5c\u4e3a\u5bc6\u94a5\u8fdb\u884c-aes-\u52a0\u5bc6",level:4},{value:"dump \u51fa\u5bf9\u5e94\u5730\u5740\u7684\u503c",id:"dump-\u51fa\u5bf9\u5e94\u5730\u5740\u7684\u503c",level:4},{value:"\u6253\u5370\u51fa\u5f53\u524d sau \u914d\u7f6e\u4fe1\u606f",id:"\u6253\u5370\u51fa\u5f53\u524d-sau-\u914d\u7f6e\u4fe1\u606f",level:4},{value:"\u8bfb\u5bc4\u5b58\u5668\u503c",id:"\u8bfb\u5bc4\u5b58\u5668\u503c",level:4},{value:"\u5199\u5bc4\u5b58\u5668\u503c",id:"\u5199\u5bc4\u5b58\u5668\u503c",level:4},{value:"\u8bfb\u53d6 efuse \u5185\u5bb9",id:"\u8bfb\u53d6-efuse-\u5185\u5bb9",level:4},{value:"TFM \u5f00\u542f\u914d\u7f6e",id:"tfm-\u5f00\u542f\u914d\u7f6e",level:3}];function x(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"rtos-\u5b89\u5168",children:"RTOS \u5b89\u5168"}),"\n",(0,s.jsx)(n.p,{children:"\u4ecb\u7ecd R128 \u4e0b\u5b89\u5168\u65b9\u6848\u7684\u529f\u80fd\u3002\u5b89\u5168\u5b8c\u6574\u7684\u65b9\u6848\u57fa\u4e8e\u6807\u51c6\u65b9\u6848\u6269\u5c55\uff0c\u8986\u76d6\u786c\u4ef6\u5b89\u5168\u3001\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce\u3001\u5b89\u5168\u542f\u52a8\u3001\u5b89\u5168\u7cfb\u7edf\u3001\u5b89\u5168\u5b58\u50a8\u7b49\u65b9\u9762\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u914d\u7f6e\u6587\u4ef6\u76f8\u5173",children:"\u914d\u7f6e\u6587\u4ef6\u76f8\u5173"}),"\n",(0,s.jsx)(n.p,{children:"\u672c\u6587\u6d89\u53ca\u5230\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u6b64\u8fdb\u884c\u8bf4\u660e\u3002"}),"\n",(0,s.jsx)(n.p,{children:"env*.cfg\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"board/<chip>/<board>/configs/env*.cfg\n"})}),"\n",(0,s.jsx)(n.p,{children:"sys_config.fex\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"board/<chip>/<board>/configs/sys_config.fex\n"})}),"\n",(0,s.jsx)(n.p,{children:"image_header.cfg\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"board/<chip>/<board>/configs/image_header.template.cfg\n"})}),"\n",(0,s.jsx)(n.p,{children:"sys_partition*.fex\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"board/<chip>/<board>/configs/sys_partition.fex\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u529f\u80fd\u4ecb\u7ecd",children:"\u529f\u80fd\u4ecb\u7ecd"}),"\n",(0,s.jsx)(n.p,{children:"R128 FreeRTOS \u7cfb\u7edf\u4e0a\u652f\u6301\u5982\u4e0b\u5b89\u5168\u529f\u80fd"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image1.png",alt:""})}),"\n",(0,s.jsx)(n.h2,{id:"\u5b89\u5168\u786c\u4ef6",children:"\u5b89\u5168\u786c\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u56fe\u662f ARM \u4e3a M33 Star \u63d0\u4f9b\u7684\u4e00\u79cd\u57fa\u4e8e TrustZone \u7684 SoC \u67b6\u6784\u53c2\u8003\u5b9e\u73b0"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image2.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53 CPU \u53d6\u6307\u6216\u8005\u8bbf\u95ee\u6570\u636e\u65f6\uff0c\u7ecf\u8fc7 SAU \u4e0e IDAU \u5ba1\u67e5\u4e4b\u540e\uff0c\u643a\u5e26\u5b89\u5168\u5c5e\u6027\uff0c\u8fdb\u5165 AHB \u603b\u7ebf\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e SAU/IDAU \u673a\u5236\u53ea\u9002\u7528\u4e8e Arm M33 Star \u5904\u7406\u5668\uff0c\u90a3\u4e48 AHB \u8bbe\u5907\u4f7f\u7528\u4e0b\u5217\u4e24\u79cd\u65b9\u6cd5\u8bc6\u522b\u4e0e\u5e94\u7b54\u8fd9\u4e9b\u643a\u5e26\u5b89\u5168\u5c5e\u6027\u7684\u8bbf\u95ee"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e00\u79cd\u662f\u5916\u8bbe\u5728\u8bbe\u8ba1\u65f6\u5c31\u53ef\u4ee5\u8bc6\u522b\u5b89\u5168\u5c5e\u6027\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e8c\u79cd\u9700\u8981\u501f\u52a9\u5176\u4ed6\u63a7\u5236\u5668\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\u4e0a\u56fe\u4e2d\u7684 PPC\u3002\u5f00\u53d1\u4eba\u5458\u8bbe\u7f6e PPC \u4e3a\u4e0d\u540c\u7684\u5916\u8bbe\u8bbe\u7f6e\u4e0d\u540c\u7684\u8bbf\u95ee\u89c4\u5219\u3002\u540c\u7406 MPC \u5219\u662f\u7528\u4e8e\u8bbe\u7f6e\u5b58\u50a8\u5668\u533a\u57df\u7684\u5b89\u5168\u5c5e\u6027\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"R128 \u4e0a\u6709\u4e9b\u5916\u8bbe\u53ef\u4ee5\u8bc6\u522b\u5b89\u5168\u5c5e\u6027\uff0c\u6bd4\u5982 CE\u3001DMA \u7b49\u3002\u5927\u90e8\u5206\u5916\u8bbe\u9700\u8981\u501f\u52a9 SPC \u6765\u914d\u7f6e\u5176\u5b89\u5168\u5c5e\u6027\u3002\u5176\u4e2d\u7684 PPC \u5bf9\u5e94 R128 \u4e0a\u7684 SPC\uff0cMPC \u5bf9\u5e94 R128 \u4e0a\u7684 SMC\uff0cTZMA"}),"\n",(0,s.jsx)(n.h3,{id:"arm-m33-star-trustzone-\u7b80\u4ecb",children:"Arm M33 Star TrustZone \u7b80\u4ecb"}),"\n",(0,s.jsx)(n.p,{children:"Arm M33 Star TrustZone \u4e0e Arm A \u7cfb\u5217\u7684 TrustZone \u7c7b\u4f3c\uff0c\u5728\u8bbe\u8ba1\u4e0a\uff0c\u5904\u7406\u5668\u90fd\u5177\u6709\u5b89\u5168\u4e0e\u975e\u5b89\u5168\u72b6\u6001\uff0c\u975e\u5b89\u5168\u8f6f\u4ef6\u53ea\u80fd\u8bbf\u95ee\u975e\u5b89\u5168\u5185\u5b58\u3002\u4e0e Arm A \u5904\u7406\u5668\u4e2d\u7684 TrustZone \u6280\u672f\u4e0d\u540c\uff0c Arm M33 Star \u7684 Secure \u548c Normal \u4e16\u754c\u662f\u57fa\u4e8e\u5185\u5b58\u6620\u5c04\u7684\uff0c\u8f6c\u6362\u5728\u5f02\u5e38\u5904\u7406\u4e2d\u81ea\u52a8\u53d1\u751f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image3.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"\u5b89\u5168\u6269\u5c55\u529f\u80fd",children:"\u5b89\u5168\u6269\u5c55\u529f\u80fd"}),"\n",(0,s.jsx)(n.p,{children:"\u9664\u4e86 ARM TrustZone \u5b89\u5168\u6269\u5c55\u529f\u80fd\u5916\uff0cR128 \u5728 SoC \u8bbe\u8ba1\u4e0a\u8fd8\u5b9e\u73b0\u4e86\u4e00\u4e9b\u5b89\u5168\u786c\u4ef6\u6765\u4fdd\u969c\u5b8c\u6574\u7684\u5b89\u5168\u7279\u6027\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"SMC"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"SMC \u914d\u7f6e hspsram \u5b58\u50a8\u533a\u57df\u7684\u5b89\u5168\u5c5e\u6027\uff0c\u53ea\u6709\u5728\u5b89\u5168\u73af\u5883\u624d\u53ef\u4ee5\u4f7f\u7528\u8be5\u6a21\u5757\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TZMA"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"TZMA \u7528\u4e8e\u914d\u7f6e lspsram\u3001sram\u3001spi flash\u3001dsp sram\u3001csi&vad sram \u5730\u5740\u7a7a\u95f4\u7684\u5b89\u5168\u5c5e\u6027\u3002"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u6a21\u5757"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u5927\u5c0f"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TZMA0"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"128KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TZMA1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"128KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TZMA2"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"256KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TZMA3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"256KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"DSP_TZMA0"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"256KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"EXPSRAM_TZMA"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"64KB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"LPSRAM_TZMA"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"8MB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"FLASH_TZMA"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"192MB"})]})]})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"SPC"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"SPC \u914d\u7f6e\u5916\u8bbe\u7684\u5b89\u5168\u5c5e\u6027\uff0c\u53ea\u6709\u5728\u5b89\u5168\u73af\u5883\u624d\u53ef\u4ee5\u4f7f\u7528\u8be5\u6a21\u5757"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CE"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"CE \u662f AW SoC \u7684\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce\uff0c\u652f\u6301 AES/SHA/RSA \u7b49\u7b97\u6cd5\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TRNG"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"TRNG \u662f\u771f\u968f\u673a\u6570\u53d1\u751f\u5668\uff0c\u968f\u673a\u6e90\u662f 8 \u8def\u72ec\u7acb\u7684\u5524\u9192\u632f\u8361\u5668\uff0c\u7531\u6a21\u62df\u5668\u4ef6\u7535\u6e90\u566a\u58f0\u4ea7\u751f\u9891\u7387\u6296\u52a8\uff0c\u7528\u4f4e\u9891\u65f6\u949f\u91cd\u91c7\u6837\uff0c\u7136\u540e\u8fdb\u884c\u5f39\u6027\u62bd\u53d6\u548c\u71b5\u63d0\u53d6\u5904\u7406\uff0c\u6700\u7ec8\u8f93\u51fa 128bit \u771f\u968f\u673a\u6570\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"SID/efuse"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"efuse\uff1a\u4e00\u6b21\u6027\u53ef\u7f16\u7a0b\u7194\u4e1d\u6280\u672f\uff0c\u662f\u4e00\u79cd OTP\uff08One\u2011Time Programmable\uff0c\u4e00\u6b21\u6027\u53ef\u7f16\u7a0b\uff09\u5b58\u50a8\u5668\u3002efuse \u5185\u90e8\u6570\u636e\u53ea\u80fd\u4ece 0 \u53d8\u6210 1\uff0c\u4e0d\u80fd\u4ece 1 \u53d8\u6210 0\uff0c\u53ea\u80fd\u5199\u5165\u4e00\u6b21\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Secure ID\uff0c\u63a7\u5236 efuse \u7684\u8bbf\u95ee\u3002efuse \u7684\u8bbf\u95ee\u53ea\u80fd\u901a\u8fc7 sid \u6a21\u5757\u8fdb\u884c\u3002sid \u672c\u8eab\u975e\u5b89\u5168\uff0c\u5b89\u5168\u975e\u5b89\u5168\u5747\u53ef\u8bbf\u95ee\u3002\u4f46\u901a\u8fc7 sid \u8bbf\u95ee efuse \u65f6\uff0c\u5b89\u5168\u7684 efuse \u53ea\u6709\u5b89\u5168\u4e16\u754c\u624d\u53ef\u4ee5\u8bbf\u95ee\uff0c\u975e\u5b89\u5168\u4e16\u754c\u8bbf\u95ee\u7684\u7ed3\u679c\u4e3a 0\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Flash Encryption"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Flash Encryption \u6a21\u5757\u5411 Flash \u5199\u6570\u636e\u65f6\u8ba1\u7b97 AES \u8fdb\u884c\u52a0\u5bc6\uff0c\u4ece Flash \u8bfb\u51fa\u6570\u636e\u65f6\u8fdb\u884c\u89e3\u5bc6\u3002\u652f\u6301\u5728 SBUS \u8bfb\u5199\u6570\u636e\u548c CBUS \u8bfb\u64cd\u4f5c\u65f6\u8fdb\u884c AES \u5b9e\u65f6\u52a0\u89e3\u5bc6\u3002\u4ec5 Nor Flash \u652f\u6301\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Secure Timer and Watchdog"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u652f\u6301\u4e00\u5957\u5b89\u5168 Timer \u4e0e\u4e00\u5957\u5b89\u5168 Watchdog"}),"\n",(0,s.jsx)(n.h2,{id:"\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce",children:"\u786c\u4ef6\u52a0\u89e3\u5bc6\u5f15\u64ce"}),"\n",(0,s.jsx)(n.p,{children:"CE\uff1aCrypto Engine\uff0c\u662f AW SoC \u4e2d\u4e00\u4e2a\u786c\u4ef6\u52a0\u89e3\u5bc6\u6a21\u5757\uff0c\u652f\u6301\u591a\u79cd\u5bf9\u79f0\u3001\u975e\u5bf9\u79f0\u3001\u6458\u8981\u751f\u6210\u7b97\u6cd5\u3002\u5305\u542b\u5b89\u5168/\u975e\u5b89\u5168\u4e24\u5957\u63a5\u53e3\u3002"}),"\n",(0,s.jsx)(n.p,{children:"CE \u9a71\u52a8\u652f\u6301\u7b97\u6cd5\u5982\u4e0b\uff0c\u4f46 CE \u786c\u4ef6\u52a0\u5bc6\u6a21\u5757\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\u4e0d\u4ec5\u9650\u4e0b\u5217\u7b97\u6cd5\u3002"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u7b97\u6cd5"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u652f\u6301"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"AES\u2011ECB\u2011128/192/256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"AES\u2011CBC\u2011128/192/256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"AES\u2011CTR\u2011128/192/256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"AES\u2011OFB\u2011128/192/256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"AES\u2011CFB8\u2011128/192/256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011MD5"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011SHA1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011SHA224"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011SHA256"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011SHA384"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"HASH\u2011SHA512"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"RSA\u2011512"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"RSA\u20111024"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"RSA\u20112048"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u221a"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["CE\u5177\u4f53\u63a5\u53e3\u53ef\u4ee5\u5728 ",(0,s.jsx)(n.a,{href:"https://yuzukihd.top/R128Module/#/sdk_module/ce",children:"CE | R128 Documents"})," \u627e\u5230\uff0cTRNG\u53ef\u4ee5\u5728 ",(0,s.jsx)(n.a,{href:"https://yuzukihd.top/R128Module/#/sdk_module/trng",children:"TRNG | R128 Documents"})," \u627e\u5230\uff0c\u8fd9\u91cc\u4e0d\u8fc7\u591a\u8d58\u8ff0\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5b89\u5168\u542f\u52a8",children:"\u5b89\u5168\u542f\u52a8"}),"\n",(0,s.jsx)(n.h3,{id:"\u5b89\u5168\u56fa\u4ef6\u6784\u5efa",children:"\u5b89\u5168\u56fa\u4ef6\u6784\u5efa"}),"\n",(0,s.jsx)(n.p,{children:"\u5b89\u5168\u56fa\u4ef6\u4e0e\u975e\u5b89\u5168\u56fa\u4ef6\u6253\u5305\u8fc7\u7a0b\u3001\u5c01\u88c5\u683c\u5f0f\u7c7b\u4f3c\uff0c\u4ec5\u5728\u539f\u672c\u975e\u5b89\u5168\u6253\u5305\u65b9\u5f0f\u57fa\u7840\u4e0a\uff0c\u5bf9\u6bcf\u4e2a\u955c\u50cf\u52a0\u5165\u7b7e\u540d\u4fe1\u606f\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"source envsetup.sh\nlunch_rtos R128_xxx_m33\nmrtos clean\nmrtos_menuconfig # \u5f00\u542fCONFIG_COMPONENTS_TFM\u3002\u6ce8\uff1a\u975e\u5b89\u5168\u56fa\u4ef6\u9700\u5173\u95ed\nmrtos\ncreatekeys # \u521b\u5efa\u7b7e\u540d\u5bc6\u94a5\uff0c\u65e0\u9700\u6bcf\u6b21\u6267\u884c\npack \u2011s # \u6253\u5305\u5b89\u5168\u56fa\u4ef6\n"})}),"\n",(0,s.jsxs)(n.p,{children:["pack \u2011s \u6253\u5305\u5b8c\u6210\u540e\uff0c\u751f\u6210\u5b89\u5168\u56fa\u4ef6\uff0c\u56fa\u4ef6\u4f4d\u4e8e out \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a",(0,s.jsx)(n.code,{children:"rtos_freertos_{BOARD}_uart0_secure_[8|16]Mnor_v[NUM].img"}),"\u3002\u5176\u4e2d v[NUM] \u8868\u793a\u56fa\u4ef6\u7684\u7248\u672c\u4fe1\u606f\uff0cNUM \u4e3a\u7248\u672c\u53f7\uff0c\u7531\u5b89\u5168\u56fa\u4ef6\u7248\u672c\u53f7\uff08\u89c14.7 \u8282\uff09\u51b3\u5b9a\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u9996\u6b21\u8fdb\u884c\u5b89\u5168\u56fa\u4ef6\u6253\u5305\u4e4b\u524d\uff0c\u5fc5\u987b\u8fd0\u884c\u4e00\u6b21 createkeys \u521b\u5efa\u81ea\u5df1\u7684\u7b7e\u540d\u5bc6\u94a5\uff0c\u5e76\u5c06\u521b\u5efa\u7684\u79d8\u94a5\u59a5\u5584\u4fdd\u5b58\u3002\u6bcf\u6b21\u6267\u884c createkeys \u540e\u90fd\u4f1a\u751f\u6210\u65b0\u7684\u5bc6\u94a5\uff0c\u56e0\u6b64\u4e0d\u7528\u6bcf\u6b21\u90fd\u6267\u884c\uff0c\u9664\u975e\u9700\u8981\u66f4\u6362\u5bc6\u94a5\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u5b89\u5168\u56fa\u4ef6\u914d\u7f6e",children:"\u5b89\u5168\u56fa\u4ef6\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u6253\u5305\u751f\u6210\u5b89\u5168\u56fa\u4ef6\u524d\uff0c\u9700\u786e\u4fdd TFM \u6253\u5f00\uff0c\u5728 M33 \u6838\u6267\u884c mrtos menuconfig \u8fdb\u5165\u914d\u7f6e\u4e3b\u754c\u9762\uff0c\u8fdb\u884c\u5982\u4e0b\u914d\u7f6e\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        TFM Support \u2011\u2011\u2011>\n            [*] TFM support\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u53ea\u6709\u5b89\u5168\u56fa\u4ef6\u9700\u8981\u5f00\u59cb TFM\uff0c\u975e\u5b89\u5168\u56fa\u4ef6\u9700\u8981\u5173\u95ed\uff0c\u4e14\u4ec5\u6709 M33 \u652f\u6301 TFM\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u542f\u52a8\u6d41\u7a0b",children:"\u542f\u52a8\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u5305\u542b\u4e09\u4e2a\u5904\u7406\u5668\uff0c\u5206\u522b\u4e3a M33\uff08ARM\uff09\u3001C906\uff08RISC\u2011V\uff09\u3001HIFI5\uff08DSP\uff09\uff0c\u4ec5 M33 \u652f\u6301\u5b89\u5168\u9694\u79bb\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4ece\u5b89\u5168\u6027\u8003\u8651\uff0cBrom \u542f\u52a8\u65f6\uff0c\u7cfb\u7edf\u5fc5\u987b\u5904\u4e8e\u5b89\u5168\u72b6\u6001\uff0c\u56e0\u6b64\uff0c\u9009\u62e9 M33 \u4f5c\u4e3a\u542f\u52a8\u6838\u3002"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u5bf9\u4e8e nor \u548c nand \u65b9\u6848\u91c7\u7528\u4e0d\u540c\u7684\u542f\u52a8\u6d41\u7a0b\u3002\u5bf9\u4e8e nor \u65b9\u6848\uff0c\u5b89\u5168\u542f\u52a8\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\u3002\u542f\u52a8\u8fc7\u7a0b\u6ca1\u6709 uboot\uff0c\u7531 boot0 \u76f4\u63a5\u542f\u52a8\u5b89\u5168\u548c\u975e\u5b89\u5168 OS\uff0c\u5176\u4e2d brom\u3001boot0\u3001S\u2011OS \u4f4d\u4e8e\u5b89\u5168\u57df\uff0cM33 N\u2011OS\u3001DSP OS\u3001RISC\u2011V OS \u4f4d\u4e8e\u975e\u5b89\u5168\u57df\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image4.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u4e8e nand \u65b9\u6848\uff0c\u7531\u4e8e nand \u9700\u8981\u5b8c\u6574\u7684 nand \u9a71\u52a8\u624d\u80fd\u52a0\u8f7d\u4f4d\u4e8e\u903b\u8f91\u5206\u533a\u7684\u6570\u636e\uff0c\u800c boot0 \u76ee\u524d\u53ea\u6709\u7b80\u5355\u9a71\u52a8\uff0c\u53ea\u80fd\u8bfb\u53d6\u7269\u7406\u6570\u636e\uff0cuboot \u6709\u5b8c\u6574\u7684\u9a71\u52a8\uff0c\u624d\u80fd\u8bfb\u53d6\u903b\u8f91\u6570\u636e\u3002\u56e0\u6b64 nand \u65b9\u6848\u542f\u52a8\u8fc7\u7a0b\u662f\u7531 boot0 \u542f\u52a8 M33 S\u2011OS\uff0c\u518d\u7531 M33 S\u2011OS \u542f\u52a8 uboot\uff0c\u542f\u52a8\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image5.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"\u6821\u9a8c\u6d41\u7a0b",children:"\u6821\u9a8c\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u4e8e Nor \u65b9\u6848\u6765\u8bf4\uff0cBrom \u52a0\u8f7d\u5e76\u6821\u9a8c sboot\uff0c\u901a\u8fc7\u540e\uff0csboot \u52a0\u8f7d M33 S\u2011OS\u3001M33 N\u2011OS\u3001RISC\u2011V OS\u3001DSP OS\uff0c\u5e76\u5bf9\u4ed6\u4eec\u8fdb\u884c\u6821\u9a8c\u3002\u6240\u6709\u6821\u9a8c\u5904\u7406\u90fd\u5728\u5b89\u5168\u57df\u8fdb\u884c\uff0c\u4fdd\u969c\u4e86\u6821\u9a8c\u8fc7\u7a0b\u7684\u5b89\u5168\u6027\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image6.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u4e8e nand \u65b9\u6848\u6765\u8bf4\uff0cBrom \u52a0\u8f7d\u5e76\u6821\u9a8c Sboot\uff0c\u518d\u7531 Sboot \u52a0\u8f7d\u548c\u6821\u9a8c M33 S\u2011OS\uff0c\u6700\u540e Uboot \u5bf9 M33 N\u2011OS\u3001RISC\u2011V OS\u3001DSP OS \u8fdb\u884c\u52a0\u8f7d\u548c\u6821\u9a8c"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image7.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"\u7b7e\u540d\u6821\u9a8c",children:"\u7b7e\u540d\u6821\u9a8c"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u652f\u6301\u4e24\u79cd\u7b7e\u540d\u6821\u9a8c\uff0c\u4e00\u79cd\u662f\u8f6f\u4ef6 ECC\u2011256 \u7b97\u6cd5\uff0c\u4e00\u79cd\u662f\u786c\u4ef6 SHA256\u2011RSA2048 \u7b97\u6cd5\uff0c\u9ed8\u8ba4\u4f7f\u7528 SHA256\u2011RSA2048 \u7b97\u6cd5\u3002\u5177\u4f53\u7684\u7b7e\u540d\u6821\u9a8c\u65b9\u6cd5\u914d\u7f6e\u5728board/R128s2/pro/configs/image_header.template.cfg\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\u9009\u62e9\u5177\u4f53\u7684\u7b7e\u540d\u6821\u9a8c\u7b97\u6cd5\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'"magic" : "AWIH",\n"hversion" : "0.5",\n"pversion" : "0",\n"key_type" : "rsa", #rsa/ecc\n"image" : {"max_size": "16384K"},\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u914d\u7f6e\u5b8c\u7b7e\u540d\u7b97\u6cd5 key_type \u540e\uff0c\u5728\u521b\u5efa\u5bc6\u94a5\u6267\u884c createkeys \u65f6\u4f1a\u81ea\u52a8\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u751f\u6210\u5bf9\u5e94\u7684\u5bc6\u94a5\uff0c\u5e76\u5728\u6267\u884c\u6253\u5305\u547d\u4ee4\u7684\u65f6\u5019\u4f1a\u91c7\u7528\u5bf9\u5e94\u7684\u7b7e\u540d\u6821\u9a8c\u7b97\u6cd5\u8fdb\u884c\u56fa\u4ef6\u6253\u5305\u7b7e\u540d\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u4fe1\u4efb\u94fe",children:"\u4fe1\u4efb\u94fe"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u6574\u4e2a\u5b89\u5168\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u4ee5 efuse \u4e2d\u7684\u6839\u516c\u94a5 hash \u4e3a\u8d77\u70b9\uff0c\u901a\u8fc7\u5c42\u5c42\u6821\u9a8c\uff0c\u4fdd\u969c\u6bcf\u4e00\u5c42\u56fa\u4ef6\u5728\u6ca1\u6709\u7be1\u6539\u7684\u60c5\u51b5\u4e0b\u6b63\u5e38\u8fd0\u884c\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e00\u5c42\u53ef\u4f7f\u7528\u4e0d\u540c\u7684\u7b7e\u540d\u5bc6\u94a5\uff0c\u5145\u5206\u4fdd\u969c\u4e86\u5b89\u5168\u6027\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u70e7\u5199-rotpkbin-\u4e0e-secure-enable-bit",children:"\u70e7\u5199 rotpk.bin \u4e0e secure enable bit"}),"\n",(0,s.jsx)(n.p,{children:"\u70e7\u5199 rotpk.bin \u4e0e secure enable bit\uff0c\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f7f\u7528 PhoenixSuit \u70e7\u5199\u5b89\u5168\u56fa\u4ef6\uff0c\u5b89\u5168\u56fa\u4ef6\u70e7\u5199\u5b8c\u6bd5\u65f6\u81ea\u52a8\u70e7\u5199 efuse \u4e2d\u7684 secure enable bit \u4f4d\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u901a\u8fc7 efuse \u6216 TFM \u63a7\u5236\u53f0\u547d\u4ee4\u5c06 rotpk.bin \u70e7\u5199\u5230\u8bbe\u5907\u7684 efuse \u4e2d\uff0c\u5177\u4f53\u64cd\u4f5c\u65b9\u5f0f\u89c1 5.5 \u8282 TFM \u4f7f\u7528\u793a\u4f8b\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5728 \u70e7 \u5199 \u5b89 \u5168 \u56fa \u4ef6 \u5b8c \u6bd5 \u65f6\uff0c \u89e3 \u6790 \u5b89 \u5168 \u56fa \u4ef6 \u83b7 \u53d6 rotpk.bin \u5e76 \u5199 \u5165 efuse\uff0c \u7136 \u540e \u518d\u5c06 efuse \u4e2d \u7684 secure enable bit \u7f6e 1\u3002\uff08\u8be5 \u65b9 \u5f0f \u9700 \u8981 \u5728 uboot \u4e2d \u5f00 \u542f \u5b8f\uff1aCONFIG_SUNXI_BURN_ROTPK_ON_SPRITE=y\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u5bf9\u4e8e Nand \u65b9\u6848\u652f\u6301 Dragon SN \u5de5\u5177\u70e7\u5199 rotpk.bin \u5230\u8bbe\u5907\u7684 efuse \u4e2d\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"efuse \u7684\u786c\u4ef6\u7279\u6027\u51b3\u5b9a\u4e86 efuse \u4e2d\u6bcf\u4e2a bit \u4ec5\u80fd\u70e7\u5199\u4e00\u6b21\u3002\u6b64\u5916\uff0cefuse \u4e2d\u4f1a\u5212\u5206\u51fa\u5f88\u591a\u533a\u57df\uff0c\u5927\u90e8\u5206\u533a\u57df\u4e5f\u53ea\u80fd\u70e7\u5199\u4e00\u6b21\u3002\u8be6\u7ec6\u8bf7\u53c2\u8003\u82af\u7247 SID \u89c4\u8303\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u70e7\u5199 secure enable bit \u540e\uff0c\u4f1a\u8ba9\u8bbe\u5907\u53d8\u6210\u5b89\u5168\u8bbe\u5907\uff0c\u6b64\u64cd\u4f5c\u662f\u4e0d\u53ef\u9006\u7684\u3002\u540e\u7eed\u5c06\u53ea\u80fd\u542f\u52a8\u5b89\u5168\u56fa\u4ef6\uff0c\u542f\u52a8\u4e0d\u4e86\u975e\u5b89\u5168\u56fa\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u65e2\u70e7\u5199\u4e86 secure enable bit\uff0c\u53c8\u70e7\u5199\u4e86 rotpk.bin\uff0c\u8bbe\u5907\u5c31\u53ea\u80fd\u542f\u52a8\u4e0e rotpk.bin \u5bf9\u5e94\u5bc6\u94a5\u7b7e\u540d\u7684\u5b89\u5168\u56fa\u4ef6\uff1b\u5982\u679c\u53ea\u70e7\u5199 secure enable bit\uff0c\u6ca1\u6709\u70e7\u5199 rotpk.bin\uff0c\u6b64\u8bbe\u5907\u4e0a\u70e7\u5199\u7684\u4efb\u4f55\u5b89\u5168\u56fa\u4ef6\u90fd\u53ef\u4ee5\u542f\u52a8\u3002\u8c03\u8bd5\u65f6\u53ef\u53ea\u70e7\u5199 secure enable bit\uff0c\u4f46\u662f\u8bbe\u5907\u51fa\u5382\u524d\u5fc5\u987b\u8981\u70e7\u5199 rotpk.bin\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u9632\u56de\u9000",children:"\u9632\u56de\u9000"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u652f\u6301\u9632\u6b62\u56fa\u4ef6\u7248\u672c\u56de\u9000\uff0c\u6253\u5305\u8fc7\u7a0b\u4e2d\u4f1a\u6839\u636e\u914d\u7f6e\u6587\u4ef6image_header.template.cfg\u4e2d\u7684pversion \u5bf9\u5e94\u7684\u7248\u672c\u4fe1\u606f\u52a0\u5165\u5230\u955c\u50cf\u7684 Image Header \u4e2d\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0cbrom \u5728 sboot \u6821\u9a8c\u4e4b\u524d\uff0c\u4f1a\u8bfb\u53d6 sboot \u955c\u50cf Image Header \u4e2d\u7684\u7248\u672c\u4fe1\u606f\uff0c\u5c06\u8be5\u7248\u672c\u4fe1\u606f\u4e0e efuse \u4e2d NV \u533a\u57df\u4fdd\u5b58\u7684\u7248\u672c\u4fe1\u606f\u8fdb\u884c\u5bf9\u6bd4\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5982\u679c efuse \u4e2d\u7684\u7248\u672c\u4fe1\u606f\u9ad8\uff0c\u4e0d\u542f\u52a8 sboot0\uff0cbrom \u8f6c\u5165 fel \u70e7\u5199\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5982\u679c efuse \u7684\u7248\u672c\u5c0f\u4e8e\u7b49\u4e8e Image Header \u4e2d\u7684\u7248\u672c\uff0c\u7ee7\u7eed\u52a0\u8f7d sboot \u5e76\u6821\u9a8c\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"sboot \u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u53d1\u73b0 efuse \u7684\u7248\u672c\u5c0f\u4e8e Image Header \u4e2d\u7684\u7248\u672c\uff0c\u5219\u5c06\u6b64\u7248\u672c\u4fe1\u606f\u5199\u5165\u5230efuse \u4e2d\u7684 NV \u533a\u57df"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5b89\u5168\u56fa\u4ef6\u6700\u591a\u652f\u6301\u66f4\u65b0 32 \u4e2a\u7248\u672c\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5b89\u5168\u91cf\u4ea7\u65b9\u6cd5",children:"\u5b89\u5168\u91cf\u4ea7\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.p,{children:"\u652f\u6301\u4e09\u79cd\u91cf\u4ea7\u65b9\u5f0f\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f7f\u7528 LiveSuit/PhoenixSuit \u70e7\u5199\u5b89\u5168\u56fa\u4ef6\uff0c\u5728\u56fa\u4ef6\u70e7\u5199\u5b8c\u6210\u65f6\u81ea\u52a8\u70e7\u5199 secure bit\u3002\u542f\u52a8\u4e4b\u540e\uff0c\u63d0\u4f9b\u63a7\u5236\u53f0\u547d\u4ee4\u65b9\u5f0f\u70e7\u5199 rotpk\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u79bb\u7ebf\u5b89\u5168\u56fa\u4ef6\u91cf\u4ea7\u65b9\u5f0f\uff0cflash \u4e0a\u540c\u65f6\u4fdd\u5b58\u5b89\u5168\u4e0e\u975e\u5b89\u5168 boot0\uff0c\u7b2c\u4e00\u6b21\u542f\u52a8\u65f6\uff0c\u8d70\u975e\u5b89\u5168boot0\uff0c\u5728\u975e\u5b89\u5168 boot0 \u4e2d\u70e7\u5199 secure bit\uff0c\u91cd\u542f\uff1b\u7b2c\u4e8c\u6b21\u542f\u52a8\u65f6\uff0c\u8d70\u5b89\u5168 boot0\uff0c\u8fdb\u884c\u6b63\u5e38\u7684\u5b89\u5168\u542f\u52a8\u3002rotpk \u53ef\u4ee5\u5728\u975e\u5b89\u5168 boot0 \u4e2d\u70e7\u5199\uff0c\u4e5f\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u4e2d\u70e7\u5199\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5bf9\u4e8e Nand \u65b9\u6848\u652f\u6301 Dragon SN \u5de5\u5177\u70e7\u5199 efuse\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u4f7f\u7528 LiveSuit/PhoenixSuit \u70e7\u5199\u5b89\u5168\u56fa\u4ef6\u65f6\u81ea\u52a8\u70e7\u5199 secure bit\uff0c\u542f\u52a8\u540e\u518d\u901a\u8fc7 Dragon SN \u5de5\u5177\u70e7\u5199 rotpk"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5b89\u5168\u7cfb\u7edf",children:"\u5b89\u5168\u7cfb\u7edf"}),"\n",(0,s.jsx)(n.h3,{id:"\u8f6f\u4ef6\u7cfb\u7edf\u67b6\u6784",children:"\u8f6f\u4ef6\u7cfb\u7edf\u67b6\u6784"}),"\n",(0,s.jsx)(n.p,{children:"R128 \u7cfb\u7edf\u4e2d\u53ea\u6709\u4e00\u4efd\u5b89\u5168 OS\uff0c\u5373\u8fd0\u884c\u5728 M33 \u4e0a\u7684 S\u2011OS\uff0c\u5176\u4ed6 RISC\u2011V/DSP \u5982\u9700\u8bbf\u95ee\u5b89\u5168\u8d44\u6e90\uff0c\u8de8\u6838\u8c03\u7528\u5230 M33 N\u2011OS\uff0cM33 N\u2011OS \u518d\u8c03\u7528 S\u2011OS \u7684\u8d44\u6e90\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image8.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"tfm",children:"TFM"}),"\n",(0,s.jsx)(n.p,{children:"M33 Star \u5b89\u5168 OS \u6211\u4eec\u91c7\u7528\u7684 Arm \u5b98\u65b9\u63a8\u51fa\u7684 TF\u2011M\uff08Trusted Firmware\u2011M\uff09\uff0cTF\u2011M \u5b9e\u73b0\u4e86ARMv8\u2011M \u67b6\u6784\u7684 SPE\uff08Secure Porcessing Environment\uff09\uff0c\u5b83\u662f\u4e00\u79cd\u5bf9\u6807 PSA \u8ba4\u8bc1\u7684\u5e73\u53f0\u5b89\u5168\u67b6\u6784\u53c2\u8003\u5b9e\u73b0\uff0c\u65b9\u4fbf Chip\u3001RTOS \u4e0e Device \u901a\u8fc7 PSA \u8ba4\u8bc1\u3002\u5176\u8f6f\u4ef6\u6846\u67b6\u5982\u4e0b\u56fe\u6240\u793a\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part1/chapter8/image9.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"TF\u2011M \u5305\u542b\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5b89\u5168\u542f\u52a8\u3002\u7528\u6765\u6765\u8ba4\u8bc1 NSPE/SPE \u955c\u50cf\u7684\u5b8c\u6574\u6027\u3002"}),"\n",(0,s.jsx)(n.li,{children:"TF\u2011M Core\u3002\u8d1f\u8d23\u63a7\u5236 SPE \u4e0e NSPE \u9694\u79bb\u3001\u901a\u4fe1\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u5b89\u5168\u670d\u52a1\u3002\u5305\u62ec ITS\uff08Internal Trusted Storage\uff09\uff0cPS\uff08Protected Storage\uff09\u7b49\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u6e90\u7801\u7ed3\u6784",children:"\u6e90\u7801\u7ed3\u6784"}),"\n",(0,s.jsx)(n.p,{children:"\u4f9b\u975e\u5b89\u5168\u73af\u5883\u8c03\u7528\u7684 TFM API \u63a5\u53e3\u653e\u7f6e\u5728 M33 rtos \u4e0b\u7684components/aw/tfm\u76ee\u5f55\u4e0b\uff0c\u5b89\u5168 M33 RTOS \u7f16\u8bd1\u524d\u914d\u7f6e\u4e0a CONFIG_COMPONENTS_TFM\uff0c\u5373\u53ef\u5c06 NSC \u76f8\u5173 API\u7f16\u5165\u5230 M33 RTOS \u955c\u50cf\u4e2d\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"tfm-\u63a5\u53e3",children:"TFM \u63a5\u53e3"}),"\n",(0,s.jsx)(n.h4,{id:"\u975e\u5b89\u5168\u7aef\u8c03\u7528\u4f20\u5165\u7684\u975e\u5b89\u5168\u7aef-api-\u63a5\u53e3\u6307\u9488-pxcallback",children:"\u975e\u5b89\u5168\u7aef\u8c03\u7528\u4f20\u5165\u7684\u975e\u5b89\u5168\u7aef API \u63a5\u53e3\u6307\u9488 pxCallback"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"uint32_t tfm_sunxi_nsc_func(Callback_t pxCallback);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"pxCallback\uff1a\u975e\u5b89\u5168\u7aef API \u63a5\u53e3\u6307\u9488"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8be5\u51fd\u6570\u88ab\u8c03\u7528\u7684\u6b21\u6570"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u8c03\u7528\u8bf4\u660e: \u8be5\u51fd\u6570\u7528\u4e8e\u5b89\u5168\u975e\u5b89\u5168\u4ea4\u4e92\u6d4b\u8bd5\uff0c\u5728\u975e\u5b89\u5168\u7aef\u8c03\u7528\u8be5\u51fd\u6570\u4e4b\u540e\uff0c\u4f1a\u5207\u6362\u5230\u5b89\u5168\u7aef\uff0c\u8be5\u51fd\u6570\u5728\u5b89\u5168\u7aef\u4f1a\u8c03\u7528\u4f20\u5165\u7684\u975e\u5b89\u5168\u7aef API \u63a5\u53e3\u6307\u9488\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u6309\u7167\u7ed9\u5b9a\u7684-key_name-\u5c06\u957f\u5ea6\u4e3a-key_bit_len-\u7684-key_data-\u70e7\u5199\u5230\u5bf9\u5e94\u7684\u5b89\u5168-efuse-\u533a\u57df",children:"\u6309\u7167\u7ed9\u5b9a\u7684 key_name \u5c06\u957f\u5ea6\u4e3a key_bit_len \u7684 key_data \u70e7\u5199\u5230\u5bf9\u5e94\u7684\u5b89\u5168 efuse \u533a\u57df"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"int tfm_sunxi_efuse_write(char key_name, unsigned char key_data, unsigned int key_bit_len);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"key_name\uff1aefuse \u5bf9\u5e94\u7684\u533a\u57df\u540d"}),"\n",(0,s.jsx)(n.li,{children:"key_data\uff1a\u5f85\u70e7\u5199\u5230 efuse \u4e2d\u7684\u6570\u636e"}),"\n",(0,s.jsx)(n.li,{children:"key_bit_len\uff1a\u5f85\u70e7\u5199\u5230 efuse \u4e2d\u6570\u636e\u7684\u957f\u5ea6"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,s.jsx)(n.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5728\u5b89\u5168\u7aef\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c",children:"\u5728\u5b89\u5168\u7aef\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"int tfm_sunxi_aes_with_hardware(crypto_aes_req_ctx_t *aes_ctx);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"aes_ctx\uff1acrypto_aes_req_ctx_t \u7ed3\u6784\u4f53\u6307\u9488"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4ec5\u8fd4\u56de 0\uff1a\u65e0\u610f\u4e49"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u8c03\u7528\u8bf4\u660e: \u8c03\u7528\u4e4b\u524d\uff0c\u8bf7\u6ce8\u610f\u5bf9\u5f85\u52a0\u89e3\u5bc6\u6240\u9700\u7684\u6570\u636e\u5bc6\u94a5\u8fdb\u884c\u5bf9\u5e94\u7684 cache \u64cd\u4f5c"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5728\u5b89\u5168\u7aef\u8bbe\u7f6e-flashenc-\u6240\u9700\u7684-nonce-\u503c",children:"\u5728\u5b89\u5168\u7aef\u8bbe\u7f6e flashenc \u6240\u9700\u7684 nonce \u503c"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_set_nonce(uint8_t *nonce);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"nonce\uff1anonce \u503c\uff0c\u5171 6 Bytes\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5f00\u542f\u5173\u95ed\u7279\u5b9a\u901a\u9053\u7684-flashenc",children:"\u5f00\u542f/\u5173\u95ed\u7279\u5b9a\u901a\u9053\u7684 flashenc"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_enable(uint8_t id)/tfm_sunxi_flashenc_disable(uint8_t id);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"id\uff1a\u901a\u9053 index"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-flashenc",children:"\u8bbe\u7f6e flashenc"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_config(uint8_t id, uint32_t saddr, uint32_t eaddr, uint32_t *key);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"id\uff1a\u901a\u9053 index"}),"\n",(0,s.jsx)(n.li,{children:"saddr\uff1a\u8bbe\u7f6e\u7684\u8d77\u59cb\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"eaddr\uff1a\u8bbe\u7f6e\u7684\u7ed3\u675f\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"key\uff1a\u52a0\u5bc6\u5bc6\u94a5"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-flashenc-\u52a0\u5bc6\u5bc6\u94a5",children:"\u8bbe\u7f6e flashenc \u52a0\u5bc6\u5bc6\u94a5"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_set_key(uint8_t id\uff0cuint32_t *key);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"id\uff1a\u901a\u9053 index"}),"\n",(0,s.jsx)(n.li,{children:"\u52a0\u5bc6\u5bc6\u94a5"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-flashenc-\u52a0\u5bc6\u5730\u5740\u8303\u56f4",children:"\u8bbe\u7f6e flashenc \u52a0\u5bc6\u5730\u5740\u8303\u56f4"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_set_region(uint8_t id, uint32_t saddr, uint32_t eaddr);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"id\uff1a\u901a\u9053 index"}),"\n",(0,s.jsx)(n.li,{children:"saddr\uff1a\u8bbe\u7f6e\u7684\u8d77\u59cb\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"eaddr\uff1a\u8bbe\u7f6e\u7684\u7ed3\u675f\u5730\u5740"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-efuse-\u4e2d\u7684-ssk-\u4f5c\u4e3a-flashenc-\u7684\u52a0\u5bc6\u5bc6\u94a5",children:"\u8bbe\u7f6e efuse \u4e2d\u7684 ssk \u4f5c\u4e3a flashenc \u7684\u52a0\u5bc6\u5bc6\u94a5"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_flashenc_set_ssk_key(uint8_t id);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"id\uff1a\u901a\u9053 index"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8df3\u8f6c\u5230-tfm-\u5b89\u5168\u7a7a\u95f4\u5229\u7528-ssk-\u4f5c\u4e3a\u5bc6\u94a5\u8fdb\u884c-aes-\u52a0\u5bc6",children:"\u8df3\u8f6c\u5230 tfm \u5b89\u5168\u7a7a\u95f4\u5229\u7528 ssk \u4f5c\u4e3a\u5bc6\u94a5\u8fdb\u884c aes \u52a0\u5bc6"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_aes_encrypt_with_hardware_ssk(uint8_t dst_addr, uint8_t src_addr, int len);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"dst_addr: \u52a0\u5bc6\u540e\u6570\u636e\u5b58\u653e\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"src_addr: \u52a0\u5bc6\u6570\u636e\u5b58\u653e\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"len\uff1a\u52a0\u5bc6\u6570\u636e\u957f\u5ea6"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"dump-\u51fa\u5bf9\u5e94\u5730\u5740\u7684\u503c",children:"dump \u51fa\u5bf9\u5e94\u5730\u5740\u7684\u503c"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_hexdump(const uint32_t *addr, uint32_t num);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"addr\uff1a\u8d77\u59cb\u5730\u5740"}),"\n",(0,s.jsx)(n.li,{children:"num\uff1adump \u7684 word \u4e2a\u6570"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u6253\u5370\u51fa\u5f53\u524d-sau-\u914d\u7f6e\u4fe1\u606f",children:"\u6253\u5370\u51fa\u5f53\u524d sau \u914d\u7f6e\u4fe1\u606f"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:" void tfm_sunxi_sau_info_printf(void);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bfb\u5bc4\u5b58\u5668\u503c",children:"\u8bfb\u5bc4\u5b58\u5668\u503c"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:" uint32_t tfm_sunxi_readl(uint32_t reg);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"reg\uff1a\u5bc4\u5b58\u5668\u5730\u5740"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5bc4\u5b58\u5668\u503c"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5199\u5bc4\u5b58\u5668\u503c",children:"\u5199\u5bc4\u5b58\u5668\u503c"}),"\n",(0,s.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void tfm_sunxi_writel(uint32_t reg, uint32_t value);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"reg\uff1a\u5f85\u5199\u7684\u5bc4\u5b58\u5668"}),"\n",(0,s.jsx)(n.li,{children:"value\uff1a\u5f85\u5199\u5165\u7684\u503c"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8bfb\u53d6-efuse-\u5185\u5bb9",children:"\u8bfb\u53d6 efuse \u5185\u5bb9"}),"\n",(0,s.jsx)(n.p,{children:"\u8bfb\u53d6 efuse \u5185\u5bb9\u51fd\u6570\u539f\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"int tfm_sunxi_efuse_read(char key_name, unsigned char key_data, size_t key_bit_len);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"key_name\uff1aefuse \u5bf9\u5e94\u7684\u533a\u57df\u540d"}),"\n",(0,s.jsx)(n.li,{children:"key_data\uff1a\u5b58\u653e\u8bfb\u53d6 efuse \u7684\u6570\u636e"}),"\n",(0,s.jsx)(n.li,{children:"key_bit_len\uff1a\u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8d1f\u6570\uff1a\u51fd\u6570\u8fd0\u884c\u9519\u8bef"}),"\n",(0,s.jsx)(n.li,{children:"\u6b63\u6570\uff1a\u5b9e\u9645\u8bfb\u53d6\u7684 bit \u6570"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"tfm-\u5f00\u542f\u914d\u7f6e",children:"TFM \u5f00\u542f\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u5728 RTOS \u73af\u5883\u4e0b\uff0cM33 \u6838\u6267\u884c mrtos menuconfig \u8fdb\u5165\u914d\u7f6e\u4e3b\u754c\u9762\uff0c\u8fdb\u884c\u5982\u4e0b\u914d\u7f6e\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        TFM Support \u2011\u2011\u2011>\n            [*] TFM support #TFM\u9a71\u52a8\n            [*] TFM test demo #TFM\u6d4b\u8bd5\u4ee3\u7801\n"})}),"\n",(0,s.jsx)(n.p,{children:"R128 \u4e2d\u63d0\u4f9b\u4e86\u56db\u4e2aTFM \u7684 \u6d4b \u8bd5 demo\uff0c \u5305 \u62ec tfm_demo\u3001tfm_crypto_demo\u3001tfm_efuse_write \u548c tfm_efuse_read\uff0c\u5206\u522b\u7528\u4e8e\u6d4b\u8bd5\u5b89\u5168\u975e\u5b89\u5168\u4ea4\u4e92\u3001\u975e\u5b89\u5168\u8c03\u7528\u5b89\u5168\u52a0\u5bc6\u63a5\u53e3\u548c\u5bf9 efuse \u5185\u5bb9\u8fdb\u884c\u8bfb\u5199\uff08\u5bf9 efuse \u8fdb\u884c\u8bfb\u5199\u9700\u8981\u5f00\u542f efuse \u9a71\u52a8 DRIVERS_EFUSE\uff09\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"c906>rpccli arm tfm_demo\nsecure call 1 time, non\u2011secure call 1 time.\nsecure call 2 time, non\u2011secure call 2 time.\nsecure call 3 time, non\u2011secure call 3 time.\nsecure call 4 time, non\u2011secure call 4 time.\nsecure call 5 time, non\u2011secure call 5 time.\nsecure call 6 time, non\u2011secure call 6 time.\nsecure call 7 time, non\u2011secure call 7 time.\nsecure call 8 time, non\u2011secure call 8 time.\nsecure call 9 time, non\u2011secure call 9 time.\nsecure call 10 time, non\u2011secure call 10 time.\n\nc906>rpccli arm tfm_crypto_demo\ntfm aes ecb test success!\n\nc906>rpccli arm tfm_efuse_write rotpk E2990EC8B001F2732EE5517739F52F6177E80AAEE220B5DBDA928BC5940FD025\n#efuse\u4e2d\u5199\u5165rotpk\nkey_hex_string: E2990EC8B001F2732EE5517739F52F6177E80AAEE220B5DBDA928BC5940FD025, buf_len: 64\n\nc906>rpccli arm tfm_efuse_read rotpk #efuse\u4e2d\u8bfb\u53d6rotpk\nefuse [rotpk] data:\n0x08133AA0: E2 99 0E C8 B0 01 F2 73 2E E5 51 77 39 F5 2F 61 |.......s..Qw9./a|\n0x08133AB0: 77 E8 0A AE E2 20 B5 DB DA 92 8B C5 94 0F D0 25 |w.... .........%|\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e2d\u63d0\u4f9b\u7684 TFM \u63a5\u53e3\u548c\u6d4b\u8bd5 demo \u4f4d\u4e8e ",(0,s.jsx)(n.code,{children:"lichee/rtos/components/aw/tfm"})," \u76ee\u5f55\u4e0b\u3002"]})]})}function a(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},1151:(e,n,l)=>{l.d(n,{Z:()=>d,a:()=>t});var s=l(7294);const i={},r=s.createContext(i);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);