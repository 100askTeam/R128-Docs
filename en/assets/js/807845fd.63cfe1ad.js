"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6649],{842:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>c,metadata:()=>a,toc:()=>s});var t=r(5893),i=r(1151);const c={},l="TRNG",a={id:"developer-guide/part2/chapter16",title:"TRNG",description:"TRNG\u662f\u771f\u968f\u673a\u6570\u53d1\u751f\u5668\uff0c\u968f\u673a\u6e90\u662f8 \u8def\u72ec\u7acb\u7684\u73af\u5f62\u632f\u8361\u5668\uff0c\u7531\u6a21\u62df\u5668\u4ef6\u7535\u6e90\u566a\u58f0\u4ea7\u751f\u9891\u7387\u6296\u52a8\uff0c\u7528\u4f4e\u9891\u59cb\u7ec8\u91cd\u91c7\u6837\uff0c\u7136\u540e\u8fdb\u884c\u5f39\u6027\u62bd\u53d6\u548c\u71b5\u63d0\u53d6\u5904\u7406\uff0c\u6700\u7ec8\u8f93\u51fa128bit\u771f\u968f\u673a\u6570\u3002",source:"@site/docs/developer-guide/part2/chapter16.md",sourceDirName:"developer-guide/part2",slug:"/developer-guide/part2/chapter16",permalink:"/en/developer-guide/part2/chapter16",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/developer-guide/part2/chapter16.md",tags:[],version:"current",frontMatter:{},sidebar:"classpartoneSidebar",previous:{title:"TWI",permalink:"/en/developer-guide/part2/chapter15"},next:{title:"Mbus",permalink:"/en/developer-guide/part2/chapter17"}},d={},s=[{value:"\u6a21\u5757\u914d\u7f6e",id:"\u6a21\u5757\u914d\u7f6e",level:2},{value:"\u6e90\u7801\u7ed3\u6784",id:"\u6e90\u7801\u7ed3\u6784",level:2},{value:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",level:2},{value:"\u8fd4\u56de\u503c\u679a\u4e3e",id:"\u8fd4\u56de\u503c\u679a\u4e3e",level:3},{value:"\u83b7\u53d6\u968f\u673a\u6570",id:"\u83b7\u53d6\u968f\u673a\u6570",level:3},{value:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",id:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"trng",children:"TRNG"}),"\n",(0,t.jsx)(n.p,{children:"TRNG\u662f\u771f\u968f\u673a\u6570\u53d1\u751f\u5668\uff0c\u968f\u673a\u6e90\u662f8 \u8def\u72ec\u7acb\u7684\u73af\u5f62\u632f\u8361\u5668\uff0c\u7531\u6a21\u62df\u5668\u4ef6\u7535\u6e90\u566a\u58f0\u4ea7\u751f\u9891\u7387\u6296\u52a8\uff0c\u7528\u4f4e\u9891\u59cb\u7ec8\u91cd\u91c7\u6837\uff0c\u7136\u540e\u8fdb\u884c\u5f39\u6027\u62bd\u53d6\u548c\u71b5\u63d0\u53d6\u5904\u7406\uff0c\u6700\u7ec8\u8f93\u51fa128bit\u771f\u968f\u673a\u6570\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u6a21\u5757\u914d\u7f6e",children:"\u6a21\u5757\u914d\u7f6e"}),"\n",(0,t.jsx)(n.p,{children:"\u5176 menuconfig \u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Kernel Setup ---\x3e\n    Drivers Setup ---\x3e\n        SoC HAL Drivers ---\x3e\n            TRNG devices ---\x3e\n                [*] enable trng driver\n                [*] enbale trng hal APIs Test command\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6e90\u7801\u7ed3\u6784",children:"\u6e90\u7801\u7ed3\u6784"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"drv_trng.c\ndrv_trng.h\nhal_trng.c\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e",children:"\u6a21\u5757\u63a5\u53e3\u8bf4\u660e"}),"\n",(0,t.jsx)(n.p,{children:"\u5934\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"#include <sunxi_hal_trng.h>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u8fd4\u56de\u503c\u679a\u4e3e",children:"\u8fd4\u56de\u503c\u679a\u4e3e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"typedef enum\n{\n    HAL_TRNG_STATUS_OK      = 0,    /* success */\n    HAL_TRNG_STATUS_ERROR   = -1,   /* general error */\n    HAL_TRNG_STATUS_BUSY    = -2,   /* device or resource busy */\n    HAL_TRNG_STATUS_TIMEOUT = -3,   /* wait timeout */\n    HAL_TRNG_STATUS_INVALID = -4    /* invalid argument */\n} HAL_TRNG_Status;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u83b7\u53d6\u968f\u673a\u6570",children:"\u83b7\u53d6\u968f\u673a\u6570"}),"\n",(0,t.jsx)(n.p,{children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"HAL_TRNG_Status HAL_TRNG_Extract(uint8_t type, uint32_t random[4]);\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"type\uff1a\u968f\u673a\u6570\u751f\u6210\u71b5\u63d0\u53d6\u6a21\u5f0f\uff080\uff1acrc\uff0c1\uff1axor\uff09"}),"\n",(0,t.jsx)(n.li,{children:"random\uff1a\u5b58\u653e\u751f\u6210\u7684\u968f\u673a\u6570"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"0\uff1a\u6210\u529f"}),"\n",(0,t.jsx)(n.li,{children:"\u8d1f\u6570\uff1a\u5931\u8d25"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b",children:"\u6a21\u5757\u4f7f\u7528\u8303\u4f8b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:'#include <stdio.h>\n#include <string.h>\n#include <hal_log.h>\n#include <hal_cmd.h>\n#include <sunxi_hal_trng.h>\n\nstatic int cmd_test_trng(int argc, const char **argv)\n{\n    int ret = 0;\n    uint32_t random[4] = {0};\n\n    if (argc != 2) {\n        printf("Parameter number Error!\\n");\n        printf("Usage: hal_trng <crc|xor>\\n");\n        return -1;\n    }\n\n    if (strcmp(argv[1], "crc") == 0)\n        ret = HAL_TRNG_Extract(0, random);\n    else if (strcmp(argv[1], "xor") == 0)\n        ret = HAL_TRNG_Extract(1, random);\n    else {\n        printf("Parameter Error!\\n");\n        printf("Usage: hal_trng <crc|xor>\\n");\n        ret = -1;\n        return ret;\n    }\n\n    if (ret) {\n        printf("trng extract failed: %d\\n", ret);\n        return ret;\n    }\n\n    printf("trng result: 0x%08x 0x%08x 0x%08x 0x%08x\\n", random[0], random[1], random[2], random[3]);\n\n    return ret;\n}\n\nFINSH_FUNCTION_EXPORT_CMD(cmd_test_trng, hal_trng, trng hal APIs tests)\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>l});var t=r(7294);const i={},c=t.createContext(i);function l(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);