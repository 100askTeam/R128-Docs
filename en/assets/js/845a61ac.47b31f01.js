"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1981],{9962:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>s});var x=a(5893),l=a(1151);const c={},d="RTOS \u8c03\u8bd5\u6307\u5357",i={id:"developer-guide/part4/chapter3",title:"RTOS \u8c03\u8bd5\u6307\u5357",description:"\u6b64\u6587\u6863\u4ecb\u7ecd FreeRTOS \u7cfb\u7edf\u65b9\u6848\u652f\u6301\u7684\u5e38\u7528\u8f6f\u4ef6\u8c03\u8bd5\u65b9\u6cd5\uff0c\u5e2e\u52a9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u5feb\u901f\u9ad8\u6548\u5730\u8fdb\u884c\u8f6f\u4ef6\u8c03\u8bd5\uff0c\u63d0\u9ad8\u89e3\u51b3\u8f6f\u4ef6\u95ee\u9898\u7684\u6548\u7387\u3002",source:"@site/docs/developer-guide/part4/chapter3.md",sourceDirName:"developer-guide/part4",slug:"/developer-guide/part4/chapter3",permalink:"/en/developer-guide/part4/chapter3",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/R128-Docs/tree/main/docs/developer-guide/part4/chapter3.md",tags:[],version:"current",frontMatter:{},sidebar:"classpartoneSidebar",previous:{title:"\u4f7f\u7528 VSCode \u8c03\u8bd5",permalink:"/en/developer-guide/part4/chapter2"}},r={},s=[{value:"\u6808\u56de\u6eaf",id:"\u6808\u56de\u6eaf",level:2},{value:"\u7528\u9014",id:"\u7528\u9014",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u63a5\u53e3\u4ecb\u7ecd",id:"\u63a5\u53e3\u4ecb\u7ecd",level:3},{value:"\u7ec8\u7aef\u547d\u4ee4",id:"\u7ec8\u7aef\u547d\u4ee4",level:3},{value:"\u56de\u6eaf\u4fe1\u606f\u89e3\u6790",id:"\u56de\u6eaf\u4fe1\u606f\u89e3\u6790",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:3},{value:"addr2line \u5206\u6790",id:"addr2line-\u5206\u6790",level:2},{value:"\u7528\u9014",id:"\u7528\u9014-1",level:3},{value:"\u7528\u6cd5",id:"\u7528\u6cd5",level:3},{value:"\u5206\u6790",id:"\u5206\u6790",level:3},{value:"\u5185\u5b58\u6cc4\u9732\u5206\u6790",id:"\u5185\u5b58\u6cc4\u9732\u5206\u6790",level:2},{value:"\u7528\u9014",id:"\u7528\u9014-2",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-1",level:3},{value:"\u7ec8\u7aef\u547d\u4ee4",id:"\u7ec8\u7aef\u547d\u4ee4-1",level:3},{value:"memleak",id:"memleak",level:4},{value:"memallocate",id:"memallocate",level:4},{value:"\u5185\u5b58\u6cc4\u9732 log \u5206\u6790",id:"\u5185\u5b58\u6cc4\u9732-log-\u5206\u6790",level:3},{value:"\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u67e5",id:"\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u67e5",level:2},{value:"\u7528\u9014",id:"\u7528\u9014-3",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-2",level:3},{value:"\u5185\u5b58\u91cd\u590d\u91ca\u653e log \u5206\u6790",id:"\u5185\u5b58\u91cd\u590d\u91ca\u653e-log-\u5206\u6790",level:3},{value:"\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790",id:"\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790",level:2},{value:"Arm M33 Star CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",id:"arm-m33-star-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",level:3},{value:"M33 CPU \u5f02\u5e38\u7c7b\u578b",id:"m33-cpu-\u5f02\u5e38\u7c7b\u578b",level:4},{value:"M33 CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790\u65b9\u6cd5",id:"m33-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790\u65b9\u6cd5",level:4},{value:"\u5d29\u6e83 log \u5206\u6790",id:"\u5d29\u6e83-log-\u5206\u6790",level:4},{value:"RISC\u2011V CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",id:"riscv-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",level:3},{value:"\u65ad\u70b9\u8c03\u8bd5",id:"\u65ad\u70b9\u8c03\u8bd5",level:2},{value:"\u7528\u9014",id:"\u7528\u9014-4",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-3",level:3},{value:"\u7ec8\u7aef\u547d\u4ee4",id:"\u7ec8\u7aef\u547d\u4ee4-2",level:3},{value:"\u63a5\u53e3\u4ecb\u7ecd",id:"\u63a5\u53e3\u4ecb\u7ecd-1",level:3},{value:"\u8bbe\u7f6e\u65ad\u70b9",id:"\u8bbe\u7f6e\u65ad\u70b9",level:4},{value:"\u79fb\u9664\u65ad\u70b9",id:"\u79fb\u9664\u65ad\u70b9",level:4},{value:"\u65ad\u70b9\u5f02\u5e38\u5206\u6790",id:"\u65ad\u70b9\u5f02\u5e38\u5206\u6790",level:3},{value:"\u89c2\u5bdf\u70b9\u8c03\u8bd5",id:"\u89c2\u5bdf\u70b9\u8c03\u8bd5",level:2},{value:"\u89c2\u5bdf\u70b9\u5c5e\u6027\u8868",id:"\u89c2\u5bdf\u70b9\u5c5e\u6027\u8868",level:3},{value:"\u7528\u9014",id:"\u7528\u9014-5",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-4",level:3},{value:"\u7ec8\u7aef\u547d\u4ee4",id:"\u7ec8\u7aef\u547d\u4ee4-3",level:3},{value:"\u63a5\u53e3\u4ecb\u7ecd",id:"\u63a5\u53e3\u4ecb\u7ecd-2",level:3},{value:"\u8bbe\u7f6e\u89c2\u5bdf\u70b9",id:"\u8bbe\u7f6e\u89c2\u5bdf\u70b9",level:4},{value:"\u79fb\u9664\u89c2\u5bdf\u70b9",id:"\u79fb\u9664\u89c2\u5bdf\u70b9",level:4},{value:"\u89c2\u5bdf\u70b9\u5f02\u5e38\u5206\u6790",id:"\u89c2\u5bdf\u70b9\u5f02\u5e38\u5206\u6790",level:3}];function t(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(n.h1,{id:"rtos-\u8c03\u8bd5\u6307\u5357",children:"RTOS \u8c03\u8bd5\u6307\u5357"}),"\n",(0,x.jsx)(n.p,{children:"\u6b64\u6587\u6863\u4ecb\u7ecd FreeRTOS \u7cfb\u7edf\u65b9\u6848\u652f\u6301\u7684\u5e38\u7528\u8f6f\u4ef6\u8c03\u8bd5\u65b9\u6cd5\uff0c\u5e2e\u52a9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u5feb\u901f\u9ad8\u6548\u5730\u8fdb\u884c\u8f6f\u4ef6\u8c03\u8bd5\uff0c\u63d0\u9ad8\u89e3\u51b3\u8f6f\u4ef6\u95ee\u9898\u7684\u6548\u7387\u3002"}),"\n",(0,x.jsx)(n.h2,{id:"\u6808\u56de\u6eaf",children:"\u6808\u56de\u6eaf"}),"\n",(0,x.jsx)(n.p,{children:"\u6808\u56de\u6eaf\u662f\u6307\u83b7\u53d6\u7a0b\u5e8f\u7684\u8c03\u7528\u94fe\u4fe1\u606f\uff0c\u901a\u8fc7\u6808\u56de\u6eaf\u4fe1\u606f\uff0c\u80fd\u5e2e\u52a9\u5f00\u53d1\u8005\u5feb\u901f\u7406\u6e05\u7a0b\u5e8f\u6267\u884c\u6d41\u7a0b\uff0c\u63d0\u9ad8\u5206\u6790\u95ee\u9898\u7684\u6548\u7387\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014",children:"\u7528\u9014"}),"\n",(0,x.jsxs)(n.ol,{children:["\n",(0,x.jsx)(n.li,{children:"\u83b7\u53d6\u7a0b\u5e8f\u8c03\u7528\u5173\u7cfb\uff0c\u7406\u6e05\u7a0b\u5e8f\u6267\u884c\u6d41\u7a0b\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u5728\u7cfb\u7edf\u89e6\u53d1\u5f02\u5e38\u65f6\uff0c\u5feb\u901f\u5206\u6790\u5f02\u5e38\u6240\u5728\u4f4d\u7f6e\u53ca\u5176\u8c03\u7528\u94fe\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u5728\u5206\u6790\u67d0\u4efb\u52a1\u5361\u6b7b\u539f\u56e0\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bf9\u8be5\u4efb\u52a1\u8fdb\u884c\u6808\u56de\u6eaf\uff0c\u5feb\u901f\u5206\u6790\u5361\u6b7b\u70b9\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u5206\u6790\u67d0\u4e9b\u8d44\u6e90\u5982 sem\u3001mutex \u7684\u83b7\u53d6\u3001\u91ca\u653e\u4fe1\u606f\u3002"}),"\n"]}),"\n",(0,x.jsx)(n.h3,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"Kernel Options \u2011\u2011\u2011>\n    Backtrace Select (debug backtrace by machine code) \u2011\u2011\u2011>\n        (X) debug backtrace by machine code  // \u901a\u8fc7\u89e3\u6790\u673a\u5668\u7801\u65b9\u5f0f\u8fdb\u884c\u56de\u6eaf\n        ( ) debug backtrace by frame pointer // \u901a\u8fc7\u89e3\u6790frame pointer\u65b9\u5f0f\u8fdb\u884c\u56de\u6eaf\n        ( ) no backtrace                     // \u5173\u95ed\u6808\u56de\u6eaf\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u63a5\u53e3\u4ecb\u7ecd",children:"\u63a5\u53e3\u4ecb\u7ecd"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"int backtrace(char *taskname, void *output[], int size, int offset, print_function print_func);\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"taskname : \u4efb\u52a1\u540d\u5b57\uff1b\u53ef\u4e3aNULL\uff0c\u8868\u793a\u56de\u6eaf\u5f53\u524d\u4efb\u52a1"}),"\n",(0,x.jsx)(n.li,{children:"output : \u6808\u56de\u6eaf\u7ed3\u679c\u4fdd\u5b58\u6570\u7ec4\uff0c\u53ef\u4ee5\u4e3aNULL"}),"\n",(0,x.jsx)(n.li,{children:"size : output\u6570\u7ec4\u5927\u5c0f\uff0c\u53ef\u4e3a0"}),"\n",(0,x.jsx)(n.li,{children:"offset : \u6808\u56de\u6eaf\u4fdd\u5b58\u7ed3\u679c\u7684\u504f\u79fb\uff0c\u53ef\u4e3a0"}),"\n",(0,x.jsx)(n.li,{children:"print_func : \u6253\u5370\u51fd\u6570\uff0c\u53ef\u7528printf"}),"\n"]}),"\n",(0,x.jsx)(n.p,{children:"\u8fd4\u56de\u503c\uff1a"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"level : \u56de\u6eaf\u5c42\u6b21"}),"\n"]}),"\n",(0,x.jsx)(n.h3,{id:"\u7ec8\u7aef\u547d\u4ee4",children:"\u7ec8\u7aef\u547d\u4ee4"}),"\n",(0,x.jsx)(n.p,{children:"\u5728\u8bbe\u5907\u7aef\u7684\u7ec8\u7aef\u754c\u9762\u4e0a\u652f\u6301\u4f7f\u7528 backtrace \u547d\u4ee4\u5bf9\u6307\u5b9a\u7684\u4efb\u52a1\u8fdb\u884c\u56de\u6eaf\u3002"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"\u4f5c\u7528\uff1a\u67e5\u770b\u6307\u5b9a\u4efb\u52a1\u5806\u6808\u56de\u6eaf\u4fe1\u606f\n\u7528\u6cd5\uff1abacktrace [taskname]\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u56de\u6eaf\u4fe1\u606f\u89e3\u6790",children:"\u56de\u6eaf\u4fe1\u606f\u89e3\u6790"}),"\n",(0,x.jsxs)(n.ol,{children:["\n",(0,x.jsx)(n.li,{children:"\u5728 PC \u7aef\u5f00\u53d1\u73af\u5883\u4e2d\uff0c\u5728 FreeRTOS SDK \u6839\u76ee\u5f55\u4e0b\uff0c\u6267\u884c source envsetup.sh"}),"\n",(0,x.jsx)(n.li,{children:"\u5728 PC \u7aef\u5f00\u53d1\u73af\u5883\u4e2d\uff0c\u5728 FreeRTOS SDK \u7684 lichee/rtos \u76ee\u5f55\u4e0b\u521b\u5efa backtrace.txt \u6587\u4ef6\uff0c\u7136\u540e\u5c06\u56de\u6eaf\u4fe1\u606f\u4ece\u7ec8\u7aef\u4e2d\u62f7\u8d1d\u51fa\u6765\uff0c\u5e76\u4fdd\u5b58\u5230 backtrace.txt \u6587\u4ef6\u4e2d\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u5728 PC \u7aef\u5f00\u53d1\u73af\u5883\u4e2d\uff0c\u6267\u884c callstack backtrace.txt \u547d\u4ee4\uff0c\u4f1a\u83b7\u53d6\u4ee5\u4e0b\u56de\u6eaf\u4fe1\u606f\u3002"}),"\n"]}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"mhd_start_scan at /xxx/mhd_apps_scan.c:334 #mhd_start_scan\u8868\u793a\u51fd\u6570\u540d\uff0c/xxx/mhd_apps_scan.c\u8868\u793a\u51fd\u6570\u6240\u5728\u7684\u6587\u4ef6\u8def\u5f84\uff0c334\u8868\u793a\u51fd\u6570\u8c03\u7528\u5904\u7684\u884c\u53f7\u3002\n\nmhd_softap_start at /xxx/mhd_apps_softap.c:263\nwifi_recv_cb at /xxx/mhd_api_test.c:624\nmhd_get_host_sleep at /xxx/mhd_apps_wifi.c:81\nbswap_16 at /xxx/aw\u2011alsa\u2011lib/bswap.h:39\n(inlined by) convert_from_s16 at ??:?\nlinear_init at /xxx/pcm_rate_linear.c:378\nresampler_basic_interpolate_single at /xxx/resample_speexdsp.c:395\n__fill_vb2_buffer at /xxx/videobuf2\u2011v4l2.c:392\ncci_read at /xxx/cci_helper.c:728\necdsa_signature_to_asn1 at /xxx/ecdsa.c:294\ncmd_wifi_fwlog at /xxx/mhd_api_test.c:449\n# \u51fd\u6570\u8c03\u7528\u987a\u5e8f\u4e3a\u4ece\u4e0b\u5230\u4e0a\uff0c\u5373cmd_wifi_fwlog \u2011> ecdsa_signature_to_asn1 \u2011> cci_read ... \u2011> mhd_start_scan\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,x.jsx)(n.p,{children:"\u8bf7\u786e\u4fdd\u6267\u884c\u89e3\u6790\u547d\u4ee4\u65f6\u6240\u6307\u5b9a\u7684 rt_system.elf \u4e3a\u7cfb\u7edf\u56fa\u4ef6\u6240\u5bf9\u5e94\u7684 rt_system.elf \u6587\u4ef6\uff0c\u5426\u5219\u89e3\u6790\u540e\u7684\u6808\u56de\u6eaf\u4fe1\u606f\u65e0\u6cd5\u786e\u4fdd\u6b63\u786e\u3002"}),"\n",(0,x.jsx)(n.h2,{id:"addr2line-\u5206\u6790",children:"addr2line \u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u5982\u679c\u6808\u56de\u6eaf\u5931\u8d25\uff0c\u53ef\u4ee5\u901a\u8fc7 addr2line \u5de5\u5177\uff0c\u5bf9\u6253\u5370\u51fa\u6765\u7684\u6808\u4e0a\u6570\u636e\u8fdb\u884c\u5206\u6790\uff0c\u4ece\u800c\u786e\u5b9a\u6808\u56de\u6eaf\u4fe1\u606f\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4f7f\u7528\u8be5\u65b9\u6cd5\u8c03\u8bd5\u7684\u5f00\u53d1\u4eba\u5458\uff0c\u9700\u8981\u63d0\u524d\u4e86\u89e3\u4e00\u4e9b ARM \u4f53\u7cfb\u67b6\u6784\u548c\u5165\u6808\u51fa\u6808\u7b49\u76f8\u5173\u77e5\u8bc6\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014-1",children:"\u7528\u9014"}),"\n",(0,x.jsx)(n.p,{children:"\u5728\u6808\u56de\u6eaf\u5931\u8d25\u65f6\uff0c\u4f7f\u7528 addr2line \u4ece\u6808\u4e0a\u6570\u636e\u4e2d\u5206\u6790\u6808\u56de\u6eaf\u4fe1\u606f\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u6cd5",children:"\u7528\u6cd5"}),"\n",(0,x.jsx)(n.p,{children:"\u53d1\u751f\u5f02\u5e38\u65f6\u5f53\u524d\u6808\u5185\u5bb9\u6253\u5370\u5982\u4e0b\uff1a"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"dump stack memory:\n0x40940f18: 0x40639028 0x4099ba68 0x00000000 0x00000000\n0x40940f28: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f38: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f48: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f58: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f68: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f78: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f88: 0x00000000 0x00000000 0x00000000 0x00000000\n0x40940f98: 0x00000000 0x404f3680 0x00000001 0x4099ba68\n0x40940fa8: 0x4099ba68 0x00000001 0x4099b628 0x00000542\n0x40940fb8: 0x4099bb68 0x40141388 0x4099ba68 0x404f3680\n0x40940fc8: 0x4099a628 0x4099ba68 0x4099bb6a 0x40142214\n0x40940fd8: 0x40141e2c 0x00000000 0x40141e2c 0xdeadbeef\n0x40940fe8: 0xdeadbeef 0xdeadbeef 0xdeadbeef 0xdeadbeef\n0x40940ff8: 0xdeadbeef 0x400d88b4 0x00000000 0x0001b63d\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u5bf9\u6240\u6709\u7684\u5185\u5b58\u6570\u636e\u4f7f\u7528\u4e0b\u5217\u547d\u4ee4\u8fdb\u884c\u5206\u6790\u3002"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"$(SDK_ROOT)/lichee/rtos/tools/gcc\u2011arm\u2011melis\u2011eabi\u20118\u20112019\u2011q3\u2011update/bin/arm\u2011melis\u2011eabi\u2011addr2line \u2011a address \u2011e rt_system.elf \u2011f\n\n# SDK_ROOT \u8868\u793aSDK\u6839\u76ee\u5f55\n# \u2011f\uff1a\u663e\u793a\u51fd\u6570\u540d\n# \u2011a\uff1aaddress\u4e3a\u6253\u5370\u51fa\u6765\u7684\u5730\u5740\n# \u2011e\uff1a\u7a0b\u5e8f\u6587\u4ef6\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u5206\u6790",children:"\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u5bf9\u4e8e\u65e0\u6cd5\u89e3\u6790\u7684\u5185\u5b58\u6570\u636e\u4e88\u4ee5\u4e22\u5f03\u540e\uff0c\u53ef\u5f97\u5230\u4ee5\u4e0b\u6709\u6548\u7684\u5206\u6790\u4fe1\u606f\u3002"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"0x40141388\nmsh_exec\n/xxx/finsh_cli/msh.c:415\n\n0x40142214\nfinsh_thread_entry\n/xxx/finsh_cli/shell_entry.c:746\n# \u51fd\u6570\u8c03\u7528\u5173\u7cfb\u3000finsh_thread_entry \u2011> msh_exec\n"})}),"\n",(0,x.jsx)(n.h2,{id:"\u5185\u5b58\u6cc4\u9732\u5206\u6790",children:"\u5185\u5b58\u6cc4\u9732\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"FreeRTOS \u7cfb\u7edf\u63d0\u4f9b\u8f7b\u91cf\u7ea7\u7684\u5185\u5b58\u6cc4\u9732\u5206\u6790\u529f\u80fd\uff0c\u542f\u52a8\u5185\u5b58\u6cc4\u9732\u5206\u6790\u540e\uff0c\u6bcf\u5f53\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u5c06\u8be5\u5185\u5b58\u5757\u6302\u5165\u94fe\u8868\u4e2d\uff0c\u91ca\u653e\u65f6\u5c06\u5176\u4ece\u94fe\u8868\u4e2d\u6458\u9664\u3002\u6700\u7ec8\u8fd8\u5b58\u5728\u4e8e\u94fe\u8868\u4e4b\u4e2d\u7684\uff0c\u4fbf\u662f\u53ef\u7591\u7684\u5185\u5b58\u6cc4\u9732\u70b9\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014-2",children:"\u7528\u9014"}),"\n",(0,x.jsx)(n.p,{children:"\u53ef\u7528\u4e8e\u5206\u6790\u3001\u5b9a\u4f4d FreeRTOS \u7cfb\u7edf\u7684\u5185\u5b58\u6cc4\u9732\u95ee\u9898\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u914d\u7f6e-1",children:"\u914d\u7f6e"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        Memleak Components Support \u2011\u2011\u2011>\n            [*] Tina RTOS Memleak #\u4f7f\u80fd\u5185\u5b58\u6cc4\u9732\u5206\u6790\u5de5\u5177\n            (16) Tina RTOS Memleak Backtrace Level @ \u5185\u5b58\u6cc4\u9732\u5206\u6790\u6808\u56de\u6eaf\u5c42\u6570\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u7ec8\u7aef\u547d\u4ee4-1",children:"\u7ec8\u7aef\u547d\u4ee4"}),"\n",(0,x.jsx)(n.h4,{id:"memleak",children:"memleak"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"\u4f5c\u7528\uff1a\u5185\u5b58\u6cc4\u9732\u5206\u6790\n\u7528\u6cd5\uff1a\n    memleak 1 \u4f7f\u80fd\u5185\u5b58\u6cc4\u9732\u5206\u6790\uff0c\u8bb0\u5f55\u6240\u6709\u5185\u5b58\u5757\u7533\u8bf7\u4fe1\u606f\n    memleak 0 \u5173\u95ed\u5185\u5b58\u6cc4\u9732\u5206\u6790\uff0c\u5220\u9664\u6240\u6709\u5185\u5b58\u5757\u7684\u7533\u8bf7\u4fe1\u606f\n    memleak 1 thread_name1 thread_name2 \u4f7f\u80fd\u5185\u5b58\u6cc4\u9732\u5206\u6790\uff0c\u8bb0\u5f55\u6307\u5b9a\u4efb\u52a1\u7684\u5185\u5b58\u5757\u7533\u8bf7\u4fe1\u606f\n    memleak show \u4e0d\u5173\u95ed\u5185\u5b58\u6cc4\u9732\u5206\u6790\uff0c\u6253\u5370\u51fa\u6240\u6709\u5185\u5b58\u5757\u7533\u8bf7\u4fe1\u606f\n"})}),"\n",(0,x.jsx)(n.h4,{id:"memallocate",children:"memallocate"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"\u4f5c\u7528\uff1a\u67e5\u770b\u6307\u5b9a\u4efb\u52a1\u7684\u5185\u5b58\u6cc4\u9732\u5206\u6790\u4fe1\u606f\n\u7528\u6cd5\uff1amemallocate thread_name\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u5185\u5b58\u6cc4\u9732-log-\u5206\u6790",children:"\u5185\u5b58\u6cc4\u9732 log \u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u5173\u95ed\u5185\u5b58\u6cc4\u9732\u68c0\u6d4b\u65f6\uff0c\u4f1a\u6253\u5370\u53ef\u7591\u7684\u5185\u5b58\u6cc4\u9732\u70b9\u53ca\u5176\u56de\u6eaf\u4fe1\u606f\uff0c\u5f00\u53d1\u8005\u53ef\u6839\u636e\u56de\u6eaf\u4fe1\u606f\uff0c\u53c2\u8003\u6808\u56de\u6eaf\u7ae0\u8282\u8fdb\u884c\u5206\u6790\u3002"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"001: ptr = 0x404c7800, size = 0x00000400.\n    backtrace : 0x401da778\n    backtrace : 0x4013cd78\n    backtrace : 0x4013b190\n    backtrace : 0x401b7c44\n    backtrace : 0x401e1854\n\n# ptr : \u5b58\u7559\u5728\u94fe\u8868\u4e2d\u7684\u5185\u5b58\u5757\u5730\u5740\n# size : \u5b58\u7559\u5728\u94fe\u8868\u4e2d\u7684\u5185\u5b58\u5757\u5927\u5c0f\n# backtrace : \u7533\u8bf7\u8be5\u5185\u5b58\u5757\u65f6\u7684\u6808\u56de\u6eaf\u4fe1\u606f\n"})}),"\n",(0,x.jsx)(n.h2,{id:"\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u67e5",children:"\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u67e5"}),"\n",(0,x.jsx)(n.p,{children:"FreeRTOS \u7cfb\u7edf\u63d0\u4f9b\u8f7b\u91cf\u7ea7\u7684\u5185\u5b58\u91cd\u590d\u91ca\u653e\u5206\u6790\u529f\u80fd\uff0c\u5728\u5185\u5b58\u5806\u7ba1\u7406\u5668\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\uff0c\u4f7f\u80fd\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u6d4b\u529f\u80fd\uff0c\u6bcf\u5f53\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u5c06\u8be5\u5185\u5b58\u5757\u6302\u5165\u94fe\u8868\u4e2d\uff0c\u91ca\u653e\u65f6\u5c06\u5176\u4ece\u94fe\u8868\u4e2d\u6458\u9664\u3002\u5982\u679c\u91ca\u653e\u4e00\u4e2a\u4e0d\u5b58\u5728\u4e8e\u8be5\u94fe\u8868\u4e2d\u7684\u5185\u5b58\u5757\u65f6\uff0c\u8bf4\u660e\u4e4b\u524d\u5df2\u7ecf\u91ca\u653e\u8fc7\u8be5\u5757\u5185\u5b58\uff0c\u5219\u672c\u6b21\u91ca\u653e\u5373\u4e3a\u5185\u5b58\u91cd\u590d\u91ca\u653e\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014-3",children:"\u7528\u9014"}),"\n",(0,x.jsx)(n.p,{children:"\u5206\u6790\u662f\u5426\u5b58\u5728\u5185\u5b58\u91cd\u590d\u91ca\u653e\uff0c\u4ee5\u53ca\u627e\u5230\u7b2c 2 \u6b21\u91ca\u653e\u540c\u4e00\u4e2a\u5185\u5b58\u5757\u7684\u8c03\u7528\u94fe\u4fe1\u606f"}),"\n",(0,x.jsx)(n.h3,{id:"\u914d\u7f6e-2",children:"\u914d\u7f6e"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        Memleak Components Support \u2011\u2011\u2011>\n            [*] Tina RTOS Memleak #\u4f7f\u80fd\u5185\u5b58\u6cc4\u9732\u5206\u6790\u5de5\u5177\n            [*] Tina RTOS Double Free Check #\u4f7f\u80fd\u5185\u5b58\u91cd\u590d\u91ca\u653e\u68c0\u67e5\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u5185\u5b58\u91cd\u590d\u91ca\u653e-log-\u5206\u6790",children:"\u5185\u5b58\u91cd\u590d\u91ca\u653e log \u5206\u6790"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"double free checked!!!\nbacktrace : 0x401da778\nbacktrace : 0x4013cd78\nbacktrace : 0x4013b190\nbacktrace : 0x401b7c44\nbacktrace : 0x401e1854\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u51fa\u73b0 double free checked!!! \u5373\u8868\u793a\u5b58\u5728\u5185\u5b58\u91cd\u590d\u91ca\u653e\u73b0\u8c61\uff0c\u6253\u5370\u51fa\u6765\u7684\u6808\u56de\u6eaf\u4fe1\u606f\u662f\u7b2c\u4e8c\u6b21\u91ca\u653e\u8be5\u5185\u5b58\u5757\u65f6\u7684\u8c03\u7528\u94fe\u4fe1\u606f\u3002"}),"\n",(0,x.jsx)(n.h2,{id:"\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790",children:"\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u4e3b\u8981\u662f\u6307 CPU \u56e0\u975e\u6cd5\u5730\u5740\u8bbf\u95ee\u3001\u6307\u4ee4\u8bd1\u7801\u9519\u8bef\u7b49\u539f\u56e0\uff0c\u8fdb\u5165\u4e86\u5f02\u5e38\u6a21\u5f0f\uff0c\u8868\u73b0\u5f62\u5f0f\u4e3a\u7cfb\u7edf\u6253\u5370\u5f02\u5e38\u6808\u4fe1\u606f\u548c\u5bc4\u5b58\u5668\u4fe1\u606f\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"arm-m33-star-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",children:"Arm M33 Star CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790"}),"\n",(0,x.jsx)(n.h4,{id:"m33-cpu-\u5f02\u5e38\u7c7b\u578b",children:"M33 CPU \u5f02\u5e38\u7c7b\u578b"}),"\n",(0,x.jsx)(n.p,{children:"M33 \u662f\u91c7\u7528 ARMv8m \u6307\u4ee4\u96c6\u67b6\u6784\u7684\u5904\u7406\u5668\uff0c\u5176\u8f6f\u4ef6\u5f02\u5e38\u5904\u7406\u7c7b\u578b\u7b26\u5408 ARMv8m \u8f6f\u4ef6\u5f02\u5e38\u7c7b\u578b\u3002\u5176\u5f02\u5e38\u7c7b\u578b\u5982\u4e0b\uff1a"}),"\n",(0,x.jsxs)(n.ol,{children:["\n",(0,x.jsx)(n.li,{children:"Bus Fault\u3002\u89e6\u53d1\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u6709\uff1a\u53d6\u6307\u5931\u8d25\uff08prefetch abort)\u3001\u6570\u636e\u8bfb/\u5199\u5931\u8d25\uff08data abort)\u3002BFSR \u5bc4\u5b58\u5668\u4f1a\u4fdd\u5b58\u4ea7\u751f bus fault \u7684\u539f\u56e0\u3002"}),"\n",(0,x.jsx)(n.li,{children:"MemManage Fault\u3002\u89e6\u53d1\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u6709\uff1a\u8bbf\u95ee MPU \u8bbe\u7f6e\u533a\u57df\u8986\u76d6\u8303\u56f4\u4e4b\u5916\u7684\u5730\u5740\u3001\u5f80\u53ea\u8bfbregion \u5199\u6570\u636e\u3001\u7528\u6237\u7ea7\u4e0b\u8bbf\u95ee\u4e86\u53ea\u5141\u8bb8\u5728\u7279\u6743\u7ea7\u4e0b\u8bbf\u95ee\u7684\u5730\u5740\u3001\u5728\u4e0d\u53ef\u6267\u884c\u7684\u5b58\u50a8\u5668\u533a\u57df\u8bd5\u56fe\u53d6\u6307\u3002MFSR \u5bc4\u5b58\u5668\u4fdd\u5b58\u4ea7\u751f\u8be5\u5f02\u5e38\u7684\u539f\u56e0\uff0cMMSR \u5bc4\u5b58\u5668\u4fdd\u5b58\u4e86\u5bfc\u81f4\u5f02\u5e38\u7684\u5730\u5740\u3002"}),"\n",(0,x.jsx)(n.li,{children:"User Fault\u3002\u89e6\u53d1\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u6709\uff1a\u6267\u884c\u4e86\u672a\u5b9a\u4e49\u7684\u6307\u4ee4\u3001\u5c1d\u8bd5\u8fdb\u5165 ARM \u72b6\u6001\u3001\u4f7f\u7528 LDRM/STRM \u591a\u91cd\u52a0\u8f7d/\u5b58\u50a8\u6307\u4ee4\u65f6\uff0c\u5730\u5740\u6ca1\u6709\u5bf9\u9f50\u3001\u9664\u6570\u4e3a\u96f6\u3001\u4efb\u4f55\u672a\u5bf9\u9f50\u7684\u8bbf\u95ee\u3002UFSR \u5bc4\u5b58\u5668\u4fdd\u5b58\u4e86\u4ea7\u751f\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u3002\u5176\u4e2d\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0cdevice memory \u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u4e0d\u5141\u8bb8\u975e\u5bf9\u9f50\u8bbf\u95ee\u3002"}),"\n",(0,x.jsx)(n.li,{children:"Hard Fault\u3002\u89e6\u53d1\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u6709\uff1aBus fault\u3001MemManage Fault \u4ee5\u53ca\u7528\u6cd5 fault \u4e0a\u8bbf\u7684\u7ed3\u679c\u3001\u5728\u5f02\u5e38\u5904\u7406\u4e2d\u8bfb\u53d6\u5f02\u5e38\u5411\u91cf\u8868\u65f6\u4ea7\u751f\u7684\u603b\u7ebf fault \u4e5f\u6309\u786c fault \u5904\u7406\u3002HFSR \u5bc4\u5b58\u5668\u4fdd\u5b58\u4e86\u4ea7\u751f\u8be5\u5f02\u5e38\u7684\u539f\u56e0\u3002"}),"\n"]}),"\n",(0,x.jsx)(n.h4,{id:"m33-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790\u65b9\u6cd5",children:"M33 CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790\u65b9\u6cd5"}),"\n",(0,x.jsxs)(n.ol,{children:["\n",(0,x.jsx)(n.li,{children:"\u786e\u8ba4\u5f02\u5e38\u7c7b\u578b\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u6808\u56de\u6eaf\u5206\u6790\u3002\u6808\u56de\u6eaf\u662f\u6307\u5728\u7cfb\u7edf\u5d29\u6e83\u4e4b\u540e\uff0c\u4f1a\u6253\u5370\u53d1\u751f\u5f02\u5e38\u65f6\u7684\u6808\u56de\u6eaf\u4fe1\u606f\uff0c\u4f9b\u5f00\u53d1\u8005\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u53c2\u8003\u6808\u56de\u6eaf\u7ae0\u8282\u8fdb\u884c\u5206\u6790"}),"\n"]}),"\n",(0,x.jsx)(n.h4,{id:"\u5d29\u6e83-log-\u5206\u6790",children:"\u5d29\u6e83 log \u5206\u6790"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"# appos pstack:0x8146480 msp:0x81fffd0 psp:0x81464a0\n# appos pstack \u8868\u793a\u5f02\u5e38\u53d1\u751f\u540e\u7ecf CPU \u786c\u4ef6\u5165\u6808\u540e SP \u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4e5f\u8868\u660e\u4e86\u5f02\u5e38\u53d1\u751f\u65f6\u6b63\u5728\u4f7f\u7528\u54ea\u4e2a\u6808\n# msp \u8868\u793a\u5f02\u5e38\u53d1\u751f\u540e msp \u5bc4\u5b58\u5668\u7684\u503c\n# psp \u8868\u793a\u5f02\u5e38\u53d1\u751f\u540e psp \u5bc4\u5b58\u5668\u7684\u503c\uff0c\u5f02\u5e38\u53d1\u751f\u65f6 SP = psp/msp \u2011 0x40 (64\u4e2a\u5b57\u8282\u7528\u6765\u4fdd\u5b58\u5f02\u5e38\u540e\u7684\u5bc4\u5b58\u5668\u73b0\u573a)\n# msplim/psplim \uff1a \u5f02\u5e38\u73b0\u573a\u7684 msplim \u548c psplim \u5bc4\u5b58\u5668\u7684\u503c\n# usage fault happen : \u8868\u793a\u6b64\u65f6\u89e6\u53d1 usage(user) fault\n# cause:undefine instruction \u8868\u793a\u662f\u89e6\u53d1\u4e86 user fault \u4e2d\u7684\u975e\u6cd5\u6307\u4ee4\u5f02\u5e38\n# CPU registers: \u8868\u793a\u5f02\u5e38\u73b0\u573a\u901a\u7528\u5bc4\u5b58\u5668\u7684\u503c\n# backtrace information : \u8868\u793a\u5f02\u5e38\u73b0\u573a\u7684\u6808\u56de\u6eaf\u4fe1\u606f\n# \u5269\u4e0b\u4fe1\u606f\u8868\u793a\u5bf9\u5e94\u5730\u5740\u7684\u503c\n\nexception:6 happen!!\nappos pstack:0x8146480 msp:0x81fffd0 psp:0x81464a0\nmsplim:0x0 psplim:0x8142550\nusage fault happen, UFSR:0x1, cause:undefine instruction\nCPU registers:\nR00:[081464A0]: 0x00000001\nR01:[081464A4]: 0x083adf48\nR02:[081464A8]: 0x00000001\nR03:[081464AC]: 0x080cf115\nR04:[08146480]: 0x083adec0\nR05:[08146484]: 0x083ae000\nR06:[08146488]: 0x0811b574\nR07:[0814648C]: 0x00000000\nR08:[08146490]: 0x08080808\nR09:[08146494]: 0x09090909\nR10:[08146498]: 0x10101010\nR11:[0814649C]: 0x11111111\nR12:[081464B0]: 0x00000000\nR13(SP):[081464C0]: 0x081464c0\nR14(LR):[081464B4]: 0x080c8d95\nR15(PC):[081464B8]: 0x080cf114\nxPSR:[081464BC]: 0x61000000\nSHCSR:0x00070008 step:0\n\u2011\u2011\u2011\u2011backtrace information\u2011\u2011\u2011\u2011\nbacktrace : 0X080CF115\nbacktrace fail!\nbacktrace : 0X080C8D92\nbacktrace : 0X080C6C66\nbacktrace : 0X080C7CE0\nbacktrace : 0X080DAD25\n\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\nstack info:\n[081464C0]: 0x003adec0 0x0844ae00 0x08130eb0 0x080c6c69\n[081464D0]: 0x0813e470 0x080d8bcf 0x10000000 0x00000000\n[081464E0]: 0x00000000 0x00000006 0x0813e220 0x0813e470\n[081464F0]: 0x05050505 0x0813e140 0x05050505 0x0813e180\n[08146500]: 0x07070707 0x08080808 0x09090909 0x10101010\n[08146510]: 0x11111111 0x080c7ce3 0x080c6afb 0x08130eb0\n[08146520]: 0x10101010 0x11111111 0x0813e180 0x01010101\n.......\n[LR]:0x80c8d95\n[080C8B90]: 0xf73bbaa5 0xf73bbaa1 0xf73bba9d 0xe92dba99\n[080C8BA0]: 0x28024ff0 0x4605b085 0xdc06468a 0x30e0f64a\n[080C8BB0]: 0x000ff6c0 0xf837f008 0x2810e008 0xf64add0c\n.......\n"})}),"\n",(0,x.jsx)(n.h3,{id:"riscv-cpu-\u8f6f\u4ef6\u5f02\u5e38\u5206\u6790",children:"RISC\u2011V CPU \u8f6f\u4ef6\u5f02\u5e38\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:(0,x.jsx)(n.img,{src:"http://photos.100ask.net/aw-r128-docs/rtos/developer-guide/part4/chapter3/image1.png",alt:""})}),"\n",(0,x.jsx)(n.p,{children:"\u5728 RISCV \u67b6\u6784\u4e2d\uff0c\u8be5\u7c7b\u95ee\u9898\u7684\u5206\u6790\u65b9\u6cd5\u5982\u4e0b\uff1a"}),"\n",(0,x.jsxs)(n.ol,{children:["\n",(0,x.jsx)(n.li,{children:"\u786e\u8ba4\u5f02\u5e38\u7c7b\u578b\u3002"}),"\n",(0,x.jsx)(n.li,{children:"\u6808\u56de\u6eaf\u5206\u6790\u3002\u6808\u56de\u6eaf\u662f\u6307\u5728\u7cfb\u7edf\u5d29\u6e83\u4e4b\u540e\uff0c\u4f1a\u6253\u5370\u53d1\u751f\u5f02\u5e38\u65f6\u7684\u6808\u56de\u6eaf\u4fe1\u606f\uff0c\u4f9b\u5f00\u53d1\u8005\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u53c2\u8003\u6808\u56de\u6eaf\u7ae0\u8282\u8fdb\u884c\u5206\u6790"}),"\n",(0,x.jsx)(n.li,{children:"\u67e5\u770b sepc \u5bc4\u5b58\u5668\u3002\u5f53\u7cfb\u7edf\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u4f1a\u5c06\u5f02\u5e38\u6307\u4ee4\u7684\u5730\u5740\u4fdd\u5b58\u5230 sepc \u5bc4\u5b58\u5668\u4e2d\u3002\u5982\u679c sepc\u660e\u663e\u662f\u4e00\u4e2a\u975e\u6cd5\u7684\u6307\u4ee4\u5730\u5740\uff0c\u53ef\u67e5\u770b ra \u5bc4\u5b58\u5668\u6765\u786e\u5b9a\u5f02\u5e38\u5730\u5740"}),"\n",(0,x.jsx)(n.li,{children:"\u53cd\u7f16\u8bd1\u67e5\u770b\u5f02\u5e38\u6307\u4ee4\uff0c\u786e\u5b9a\u5f02\u5e38\u7684\u76f4\u63a5\u539f\u56e0\u5e76\u8fdb\u884c\u5206\u6790\u3002\u5e38\u7528\u53cd\u7f16\u8bd1\u65b9\u6cd5 riscv64\u2011unknown\u2011elf\u2011objdump \u2011d xxx.elf\u3002xxx.elf \u9700\u8981\u6839\u636e sepc \u5bc4\u5b58\u5668\u7684\u503c\uff0c\u786e\u8ba4\u5176\u6240\u5c5e\u6a21\u5757\uff0c\u7136\u540e\u9009\u5b9a\u5bf9\u5e94\u7684elf \u6587\u4ef6\u3002"}),"\n"]}),"\n",(0,x.jsxs)(n.blockquote,{children:["\n",(0,x.jsx)(n.p,{children:"\u90e8\u5206\u91c7\u7528 RISC\u2011V \u6307\u4ee4\u96c6\u7684\u82af\u7247\u4e0d\u4e00\u5b9a\u4f1a\u8fd0\u884c S \u6a21\u5f0f\uff0c\u53ea\u4f1a\u8fd0\u884c M \u6a21\u5f0f\uff0c\u6240\u4ee5\u6b64\u5904\u6240\u6307\u7684 sepc \u548c mepc \u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u66ff\u6362\uff0c\u5176\u4ed6 RISC\u2011V \u5bc4\u5b58\u5668\u540c\u7406"}),"\n"]}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"# EXC_STORE_PAGE_FAULT: \u56de\u5199\u6570\u636e\u8bbf\u95ee\u9875\u9762\u5f02\u5e38\uff0c\u53ef\u53c2\u8003[RISCV\u5f02\u5e38\u5206\u6790]\u6765\u5206\u6790\n# gprs : \u901a\u7528\u5bc4\u5b58\u5668\u7684\u503c\n# sepc : \u5f02\u5e38\u53d1\u751f\u65f6pc\u5bc4\u5b58\u5668\u7684\u503c\n# sstatus : \u5f02\u5e38\u53d1\u751f\u65f6sstaus\u5bc4\u5b58\u5668\u7684\u503c\n# sscratch : \u5f02\u5e38\u53d1\u751f\u65f6sscratch\u5bc4\u5b58\u5668\u7684\u503c\n# backtrace : \u5f02\u5e38\u53d1\u751f\u65f6\u6808\u56de\u6eaf\u4fe1\u606f\n# dump stack memory : \u5f02\u5e38\u53d1\u751f\u65f6\u6808\u7684\u6570\u636e\u5185\u5bb9\n# dump sepc memory : \u5f02\u5e38\u53d1\u751f\u65f6sepc\u5730\u5740\u6307\u5411\u7684\u6570\u636e\u5185\u5bb9\n\n=====================================================================================================\nEXC_BREAKPOINT\n=====================================================================================================\ngprs:\nx0:0x0000000000000000 ra:0x0000000008252828 sp:0x000000000844aef0 gp:0x00000000083695b0\ntp:0x0000000000000000 t0:0x0000000000000009 t1:0x0000000000000002 t2:0x0000000000000000\ns0:0x000000000844af00 s1:0x0000000000000000 a0:0x0000000000000001 a1:0x000000000844af00\na2:0x0000000000000000 a3:0x0000000000000000 a4:0x0000000000000000 a5:0x0000000008252162\na6:0x0000000000000000 a7:0x0000000000000008 s2:0x0000000000000001 s3:0x000000000844b180\ns5:0x0000000000000800 s5:0x0000000008329c88 s6:0x00000000082fca88 s7:0xa5a5a5a5a5a5a5a5\ns8:0xa5a5a5a5a5a5a5a5 s9:0xa5a5a5a5a5a5a5a5 s10:0xa5a5a5a5a5a5a5a5 s11:0xa5a5a5a5a5a5a5a5\nt3:0x0000000000000022 t4:0x000000000844af08 t5:0x000000000000003b t6:0x0000000000000020\nother:\nmepc :0x0000000008252162\nmcause :0x0000000000000003\nmtval :0x0000000000000000\nmstatus :0x0000000a00003980\nmscratch:0x0000000000000000\n\u2011\u2011\u2011\u2011\u2011\u2011\u2011backtrace\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\nbacktrace : 0X08252162\nbacktrace : invalid lr(0000000000000000)\nbacktrace : 0X08252826\nbacktrace : 0X08251D52\nbacktrace : 0X082520B4\nbacktrace : 0X082F6694\n\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\u2011\n==> Round [1] <==\nTotal Heap Size : 4587992 Bytes ( 4480 KB)\nFree : 3893696 Bytes ( 3802 KB)\nMin Free : 3851104 Bytes ( 3760 KB)\ndump_memory:stack\n0x000000000844AE70: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AE80: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AE90: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AEA0: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AEB0: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AEC0: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AED0: 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5 0xa5a5a5a5\n0x000000000844AEE0: 0x00000800 0x00000000 0x0825281c 0x00000000\n0x000000000844AEF0: 0x00000000 0x00000001 0x0844b005 0x00000000\n0x000000000844AF00: 0x0844b000 0x00000000 0x00000000 0x00000000\n.......\ndump_memory:mepc\n0x00000000082520E6: 0xbfb90084 0xfe07871b 0x0ff77713 0x05e00693\n0x00000000082520F6: 0xf4e6e8e3 0x0ff00713 0xf4e404e3 0x0084d78b\n0x0000000008252106: 0x74132405 0xbf2d0ff4 0xf4067179 0xe42af022\n.......\ndump_memory:x1\n0x0000000008252818: 0xe61ff0ef 0x691cc519 0x85a2c789 0x9782854a\n0x0000000008252828: 0x30834485 0x34032281 0x85262201 0x21013903\n0x0000000008252838: 0x21813483 0x23010113 0x71198082 0xeccef4a6\n0x0000000008252848: 0x0010c497 0x45448493 0x0010c997 0x44898993\n0x0000000008252858: 0xf0caf8a2 0x0009a403 0x0004a903 0xe0dae8d2\n0x0000000008252868: 0xf862fc5e 0xf06af466 0xe4d6fc86 0x8b2aec6e\n0x0000000008252878: 0xe4028bae 0x0014d797 0x4607a223 0x000d8c17\n0x0000000008252888: 0x124c0c13 0x06800a13 0x03a00c93 0x03f00d13\n.......\ndump_memory:x3\n0x00000000083695A0: 0x082c9752 0x00000000 0x00000000 0x00000000\n0x00000000083695B0: 0x00000000 0x00000000 0x08348148 0x00000000\n0x00000000083695C0: 0x00000000 0x00000000 0x082c8b80 0x00000000\n0x00000000083695D0: 0x082cab12 0x00000000 0x00000000 0x00000000\n0x00000000083695E0: 0x08349070 0x00000000 0x00000000 0x00000000\n0x00000000083695F0: 0x082d19ce 0x00000000 0x082d174c 0x00000000\n0x0000000008369600: 0x00000000 0x00000000 0x0834caa8 0x00000000\n0x0000000008369610: 0x00000000 0x00000000 0x00000000 0x00000000\n.......\n"})}),"\n",(0,x.jsx)(n.h2,{id:"\u65ad\u70b9\u8c03\u8bd5",children:"\u65ad\u70b9\u8c03\u8bd5"}),"\n",(0,x.jsx)(n.p,{children:"\u65ad\u70b9\u8c03\u8bd5\u662f\u6307\u5229\u7528 CPU \u7684\u786c\u4ef6\u65ad\u70b9\u6216\u8005\u8f6f\u4ef6\u65ad\u70b9\u6765\u8fdb\u884c\u8c03\u8bd5\uff0c\u901a\u8fc7\u5bf9\u6307\u5b9a\u7684\u5730\u5740\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5f53\u7a0b\u5e8f\u6267\u884c\u5230\u8be5\u5730\u5740\u65f6\uff0c\u89e6\u53d1\u8f6f\u4ef6\u53d6\u6307\u5f02\u5e38\uff0c\u518d\u6839\u636e\u5f02\u5e38\u4fe1\u606f\u8fdb\u884c\u5206\u6790\u3002\u901a\u8fc7\u4f7f\u7528\u8be5\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8fc5\u901f\u5224\u65ad\u7a0b\u5e8f\u662f\u5426\u6267\u884c\u5230\u6307\u5b9a\u7684\u5730\u5740\u3002\u76ee\u524d\u8be5\u529f\u80fd\u4ec5\u5728\u4f7f\u7528 M33 Star CPU \u7684\u82af\u7247\u4e0a\u652f\u6301\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014-4",children:"\u7528\u9014"}),"\n",(0,x.jsx)(n.p,{children:"\u53ef\u7528\u4e8e\u5206\u6790\u8f6f\u4ef6\u6267\u884c\u6d41\u7a0b\uff0c\u4ee5\u53ca\u5feb\u901f\u5206\u6790\u51fd\u6570\u8c03\u7528\u53c2\u6570\u3001\u8fd4\u56de\u503c\u7b49\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u914d\u7f6e-3",children:"\u914d\u7f6e"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        Watchpoint Components Support \u2011\u2011\u2011>\n            [*] Tina RTOS Watchpoint # \u4f7f\u7528\u65ad\u70b9\u4e0e\u89c2\u5bdf\u70b9\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u7ec8\u7aef\u547d\u4ee4-2",children:"\u7ec8\u7aef\u547d\u4ee4"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"\u4f5c\u7528 : \u8bbe\u7f6e\u7a0b\u5e8f\u65ad\u70b9\uff0c\u5f53\u524d\u4ec5\u4f7f\u7528\u786c\u4ef6\u65ad\u70b9\n\u7528\u6cd5 : breakpoint [set | remove] addr\n    set : \u8bbe\u7f6e\u65ad\u70b9\n    remove : \u53d6\u6d88\u65ad\u70b9\n    addr : \u5728\u8be5\u5730\u5740\u8bbe\u7f6e\u65ad\u70b9\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u63a5\u53e3\u4ecb\u7ecd-1",children:"\u63a5\u53e3\u4ecb\u7ecd"}),"\n",(0,x.jsx)(n.h4,{id:"\u8bbe\u7f6e\u65ad\u70b9",children:"\u8bbe\u7f6e\u65ad\u70b9"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"int gdb_set_hw_break(unsigned long addr);\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"addr : \u5f85\u8bbe\u7f6e\u65ad\u70b9\u7684\u5730\u5740"}),"\n"]}),"\n",(0,x.jsx)(n.p,{children:"\u8fd4\u56de\u503c - 0 : \u8bbe\u7f6e\u65ad\u70b9\u6210\u529f - \u20111 : \u8bbe\u7f6e\u65ad\u70b9\u5931\u8d25"}),"\n",(0,x.jsx)(n.h4,{id:"\u79fb\u9664\u65ad\u70b9",children:"\u79fb\u9664\u65ad\u70b9"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"int gdb_remove_hw_break(unsigned long addr);\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"addr : \u5f85\u79fb\u9664\u65ad\u70b9\u7684\u5730\u5740"}),"\n"]}),"\n",(0,x.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"0 : \u79fb\u9664\u65ad\u70b9\u6210\u529f"}),"\n",(0,x.jsx)(n.li,{children:"-1 : \u79fb\u9664\u65ad\u70b9\u5931\u8d25"}),"\n"]}),"\n",(0,x.jsx)(n.h3,{id:"\u65ad\u70b9\u5f02\u5e38\u5206\u6790",children:"\u65ad\u70b9\u5f02\u5e38\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u65ad\u70b9\u5f02\u5e38\u5206\u6790\uff0c\u53ef\u53c2\u8003\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790\u7ae0\u8282\u8fdb\u884c\u5206\u6790\u3002"}),"\n",(0,x.jsx)(n.h2,{id:"\u89c2\u5bdf\u70b9\u8c03\u8bd5",children:"\u89c2\u5bdf\u70b9\u8c03\u8bd5"}),"\n",(0,x.jsx)(n.p,{children:"\u89c2\u5bdf\u70b9\u8c03\u8bd5\u662f\u6307\u5229\u7528 CPU \u7684\u786c\u4ef6\u89c2\u5bdf\u70b9\u6765\u8fdb\u884c\u8c03\u8bd5\uff0c\u901a\u8fc7\u5bf9\u6307\u5b9a\u7684\u5730\u5740\u8bbe\u7f6e\u6307\u5b9a\u5c5e\u6027\u7684\u89c2\u5bdf\u70b9\uff0c\u5f53 CPU \u5bf9\u8be5\u5730\u5740\u8fdb\u884c\u6307\u5b9a\u5c5e\u6027\u7684\u64cd\u4f5c\u65f6\uff0c\u4f1a\u89e6\u53d1\u6570\u636e\u8bbf\u95ee\u5f02\u5e38\uff0c\u7136\u540e\u518d\u6839\u636e\u5f02\u5e38\u4fe1\u606f\u8fdb\u884c\u5206\u6790\u3002\u901a\u8fc7\u4f7f\u7528\u8be5\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8fc5\u901f\u5224\u65ad\u67d0\u5757\u5185\u5b58\u662f\u5426\u88ab\u4fee\u6539\u3001\u8bfb\u53d6\u6216\u8005\u8bbf\u95ee\u3002\u76ee\u524d\u8be5\u529f\u80fd\u4ec5\u5728\u4f7f\u7528 M33 Star CPU \u7684\u82af\u7247\u4e0a\u652f\u6301\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u89c2\u5bdf\u70b9\u5c5e\u6027\u8868",children:"\u89c2\u5bdf\u70b9\u5c5e\u6027\u8868"}),"\n",(0,x.jsxs)(n.table,{children:[(0,x.jsx)(n.thead,{children:(0,x.jsxs)(n.tr,{children:[(0,x.jsx)(n.th,{style:{textAlign:"left"},children:"\u5c5e\u6027"}),(0,x.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f5c\u7528"})]})}),(0,x.jsxs)(n.tbody,{children:[(0,x.jsxs)(n.tr,{children:[(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"write"}),(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"\u76d1\u89c6\u5199\u64cd\u4f5c"})]}),(0,x.jsxs)(n.tr,{children:[(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"read"}),(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"\u76d1\u89c6\u8bfb\u64cd\u4f5c"})]}),(0,x.jsxs)(n.tr,{children:[(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"access"}),(0,x.jsx)(n.td,{style:{textAlign:"left"},children:"\u76d1\u89c6\u8bbf\u95ee\u64cd\u4f5c\uff0c\u5305\u62ec\u8bfb\u548c\u5199"})]})]})]}),"\n",(0,x.jsx)(n.h3,{id:"\u7528\u9014-5",children:"\u7528\u9014"}),"\n",(0,x.jsx)(n.p,{children:"\u53ef\u7528\u4e8e\u5206\u6790\u67d0\u5757\u5185\u5b58\u5904\u662f\u5426\u88ab\u7be1\u6539\u7b49\u95ee\u9898\u3002"}),"\n",(0,x.jsx)(n.h3,{id:"\u914d\u7f6e-4",children:"\u914d\u7f6e"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"System components \u2011\u2011\u2011>\n    aw components \u2011\u2011\u2011>\n        Watchpoint Components Support \u2011\u2011\u2011>\n            [*] Tina RTOS Watchpoint # \u4f7f\u7528\u65ad\u70b9\u4e0e\u89c2\u5bdf\u70b9\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u7ec8\u7aef\u547d\u4ee4-3",children:"\u7ec8\u7aef\u547d\u4ee4"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{children:"\u4f5c\u7528 : \u8bbe\u7f6e\u786c\u4ef6\u89c2\u5bdf\u70b9\uff0c\u5f53\u524d\u4ec5\u4f7f\u7528\u786c\u4ef6\u65ad\u70b9\n\u7528\u6cd5 : watchpoint [write | read | access | remove] addr\n    write : \u76d1\u89c6\u5199\u64cd\u4f5c\n    read : \u76d1\u89c6\u8bfb\u64cd\u4f5c\n    access : \u76d1\u89c6\u8bbf\u95ee\u64cd\u4f5c\n    remove : \u53d6\u6d88\u89c2\u5bdf\u70b9\n    addr : \u5728\u8be5\u5730\u5740\u8bbe\u7f6e/\u53d6\u6d88\u89c2\u5bdf\u70b9\n"})}),"\n",(0,x.jsx)(n.h3,{id:"\u63a5\u53e3\u4ecb\u7ecd-2",children:"\u63a5\u53e3\u4ecb\u7ecd"}),"\n",(0,x.jsx)(n.h4,{id:"\u8bbe\u7f6e\u89c2\u5bdf\u70b9",children:"\u8bbe\u7f6e\u89c2\u5bdf\u70b9"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"int gdb_set_hw_watch(unsigned long addr, enum gdb_bptype type);\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"addr : \u5f85\u8bbe\u7f6e\u65ad\u70b9\u7684\u5730\u5740"}),"\n",(0,x.jsx)(n.li,{children:"type : \u89c2\u5bdf\u70b9\u7c7b\u578b"}),"\n"]}),"\n",(0,x.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"0 : \u8bbe\u7f6e\u89c2\u5bdf\u70b9\u6210\u529f"}),"\n",(0,x.jsx)(n.li,{children:"\u20111 : \u8bbe\u7f6e\u89c2\u5bdf\u70b9\u5931\u8d25"}),"\n"]}),"\n",(0,x.jsx)(n.h4,{id:"\u79fb\u9664\u89c2\u5bdf\u70b9",children:"\u79fb\u9664\u89c2\u5bdf\u70b9"}),"\n",(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-c",children:"int gdb_remove_hw_watch(unsigned long addr);\n"})}),"\n",(0,x.jsx)(n.p,{children:"\u53c2\u6570"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"addr : \u5f85\u79fb\u9664\u89c2\u5bdf\u70b9\u7684\u5730\u5740"}),"\n"]}),"\n",(0,x.jsx)(n.p,{children:"\u8fd4\u56de\u503c"}),"\n",(0,x.jsxs)(n.ul,{children:["\n",(0,x.jsx)(n.li,{children:"0 : \u79fb\u9664\u89c2\u5bdf\u70b9\u6210\u529f"}),"\n",(0,x.jsx)(n.li,{children:"\u20111 : \u79fb\u9664\u89c2\u5bdf\u70b9\u5931\u8d25"}),"\n"]}),"\n",(0,x.jsx)(n.h3,{id:"\u89c2\u5bdf\u70b9\u5f02\u5e38\u5206\u6790",children:"\u89c2\u5bdf\u70b9\u5f02\u5e38\u5206\u6790"}),"\n",(0,x.jsx)(n.p,{children:"\u89c2\u5bdf\u70b9\u5f02\u5e38\u5206\u6790\uff0c\u53ef\u53c2\u8003\u7cfb\u7edf\u5d29\u6e83\u5f02\u5e38\u5206\u6790\u7ae0\u8282\u8fdb\u884c\u5206\u6790\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,x.jsx)(n,{...e,children:(0,x.jsx)(t,{...e})}):t(e)}},1151:(e,n,a)=>{a.d(n,{Z:()=>i,a:()=>d});var x=a(7294);const l={},c=x.createContext(l);function d(e){const n=x.useContext(c);return x.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),x.createElement(c.Provider,{value:n},e.children)}}}]);